webpackJsonp([11],{922:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},n=a(600),s=l(n),i=a(783),u=a(777),d=l(u),o=a(923),p=l(o),c=i.DatePicker.MonthPicker,m=i.Form.Item,f=i.Radio.Button,h=i.Radio.Group,g=s.default.createClass({displayName:"PushTime",getInitialState:function(){var e=this.props.router,t=this.props.defaultDay,a=864e5,l=new Date,r="userdata"===e?6:0;r=t?t:r;var n=new Date(+new Date-r*a),s=d.default.dateFormat("yyyy-MM-dd",n),i=d.default.dateParse(s+" 00:00:00");return{startTimeStatus:"success",endTimeStatus:"success",startTime:i,endTime:l,display:"none",errorTips:"",pushTimeType:t||0}},changeRadio:function(e){var t=e.target.value,a=+new Date,l=864e5,r={pushTimeType:t};if(1===t?r.endTime=new Date(a-Number(t)*l):r.endTime=new Date,"number"==typeof t){r.startTime=new Date(a-Number(t)*l);var n=d.default.dateFormat("yyyy-MM-dd",r.startTime);r.startTime=d.default.dateParse(n+" 00:00:00"),1===t&&(r.endTime=d.default.dateParse(n+" 23:59:59")),r.display="none",r.startTimeStatus="success",r.endTimeStatus="success",r.errorTips=""}else r.startTime=new Date;this.setState(r),this.props.form.setFieldsValue(r)},componentDidMount:function(){"userdata"===this.props.router&&this.setState({pushTimeType:6})},onOpen:function(){this.setState({pushTimeType:"other"})},changeStartTime:function(e){var t=this.props.router,a=this.props.required,l=this.props.dateType,r="month"===l?"endTimeMonth":"endTime",n={router:t,required:a},s=this.props.form.getFieldValue(r),i=p.default.changeStartTime(e,s,n);this.setState(i)},changeEndTime:function(e){var t=e.getFullYear(),a=e.getMonth()+1,l=this.props.required,r=this.props.dateType,n="startTime";"month"===r&&(n="startTimeMonth",e=d.default.dateParse(t+"-"+a+"-31 23:59:59"));var s={required:l},i=this.props.form.getFieldValue(n),u=p.default.changeEndTime(e,i,s);this.setState(u)},render:function(){var e="",t=this.props.dateType,a=this.props.type,l=this.props.router,n=this.props.hiddenTitle;"second"===a&&(e=" H:mm:ss");var u="yyyy-MM-dd"+e;u="month"===t?"yyyy-MM":u;var d=this.props.form.getFieldProps,o=n?"":s.default.createElement("span",null,"时间");return s.default.createElement(m,{className:"radio_btn",labelCol:{span:2},wrapperCol:{span:22},label:o},"personal"===l?null:s.default.createElement(h,{onChange:this.changeRadio,value:this.state.pushTimeType,size:"large",style:{marginRight:10}},"userdata"===l||"averagePush"===l?null:s.default.createElement(f,{value:0},"今天"),"userdata"===l?null:s.default.createElement(f,{value:1},"昨天"),"averagePush"===l?s.default.createElement(f,{value:2},"前天"):null,"analyze"===l||"averagePush"===l?null:s.default.createElement(f,{value:6},"最近7天"),"analyze"===l||"averagePush"===l?null:s.default.createElement(f,{value:30},"最近30天"),s.default.createElement(f,{value:"other"},"选择日期")),s.default.createElement(m,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},"month"===t?s.default.createElement(c,d("startTimeMonth",{initialValue:this.state.startTime,onChange:this.changeStartTime})):s.default.createElement(i.DatePicker,r({},d("startTime",{initialValue:this.state.startTime,onChange:this.changeStartTime}),{toggleOpen:this.onOpen,showTime:!0,format:u}))),"analyze"===l||"averagePush"===l?null:s.default.createElement("span",{className:"pl10 pr10"},"至"),"analyze"===l||"averagePush"===l?null:s.default.createElement(m,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},"month"===t?s.default.createElement(c,d("endTimeMonth",{initialValue:this.state.endTime,onChange:this.changeEndTime})):s.default.createElement(i.DatePicker,r({},d("endTime",{initialValue:this.state.endTime,onChange:this.changeEndTime}),{toggleOpen:this.onOpen,showTime:!0,format:u}))),s.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips))}});e.exports=g},1332:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=a(600),n=l(r),s=a(1333),i=l(s),u=a(776),d=l(u),o=a(777),p=l(o),c=a(785),m=l(c),f=n.default.createClass({displayName:"App",getInitialState:function(){return{current:1,appId:p.default.queryString("appId",window.location.href),tableData:{loading:!0,data:[],pagination:null}}},componentWillReceiveProps:function(){var e=p.default.queryString("appId",window.location.href);this.setState({appId:e})},tableData:function(e){var t=this;this.setState({tableData:{loading:!0,data:[]},current:e.index});var a=d.default.taskGroupList,l=p.default.queryString("appId",window.location.href);l&&"0"!==l?e.appId=l:delete e.appId,a=p.default.makeUrl(a,e),m.default.get(a,function(a){var l=a.value.result;l.map(function(e,t){l[t].key=t}),t.setState({tableData:{data:l,loading:!1,pagination:{total:a.value.amount,current:e.index,pageSize:10,showSizeChanger:!1,onChange:function(a){e.index=a,t.setState({current:a,searchData:e}),t.tableData(e)}}}})},function(){t.setState({tableData:{loading:!1}})})},render:function(){return n.default.createElement("div",null,n.default.createElement(i.default,{searchData:this.state.searchData,refresh:this.state.refresh,tableData:this.state.tableData,current:this.state.current,appId:this.state.appId,onSearch:this.tableData}))}});e.exports=f},1333:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},n=a(600),s=l(n),i=a(783),u=a(777),d=l(u),o=a(1334),p=l(o),c=a(922),m=l(c),f=i.Form.Item,h=i.Select.Option,g={labelCol:{span:8},wrapperCol:{span:16}},y=s.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{buttonGroupType:"ghost",initData:{},values:[],data:null,noticeBarType:"0",noticeExpandType:"0",pushTimeType:0,errors:{},defaultAppid:"应用"}},handleSubmit:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){if(e)return void console.log("Errors in form!!!");var l=a.startTime,r=a.endTime;if(!(+new Date(l)>+new Date(r))){a.index=1,a.startTime="string"==typeof a.startTime?a.startTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.startTime),a.endTime="string"==typeof a.endTime?a.endTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.endTime);var n={};for(var s in a){var i=a[s];"taskGroupId"!==s&&"groupName"!==s||(i=i.trim()),""!==i&&(n[s]=i)}t.setState({searchData:a}),t.props.onSearch(n)}})},componentDidMount:function(){var e=new Date,t=d.default.queryString("appId",window.location.href),a={appId:t,index:1,startTime:d.default.dateFormat("yyyy-MM-dd",e)+" 00:00:00",endTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",e)};this.setState({searchData:a}),this.props.onSearch(a)},cantNull:function(e,t){var a=this.props.form.getFieldProps;return a(e,{initialValue:t})},validateTaskId:function(e,t){var a=this.props.form.getFieldProps;return a(e,{initialValue:t,validate:[{rules:[{validator:function(e,t,a){var l=t.match(/[0-9]*/),r=l[0].length;(r!==t.length||r>19)&&a(new Error("分组ID为小于20位的数字")),a()}}],trigger:["onBlur","onChange"]}]})},render:function(){var e=this.state.searchData||this.props.searchData;return s.default.createElement("div",null,s.default.createElement(i.Form,{horizontal:!0},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"24"},s.default.createElement(m.default,{type:"second",form:this.props.form}))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,r({},g,{label:"推送类型"}),s.default.createElement(i.Select,r({},this.cantNull("pushType",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"通知"),s.default.createElement(h,{value:"1"},"透传消息")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,r({},g,{label:"目标类型"}),s.default.createElement(i.Select,r({},this.cantNull("groupType",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"相同用户群"),s.default.createElement(h,{value:"1"},"不同用户群")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,r({},g,{label:"状态"}),s.default.createElement(i.Select,r({},this.cantNull("pushStatus",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"待推送"),s.default.createElement(h,{value:"1"},"推送中"),s.default.createElement(h,{value:"2"},"已完成"),s.default.createElement(h,{value:"4"},"取消"))))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6",className:"toolbar_taskid"},s.default.createElement(f,r({},g,{label:"分组ID"}),s.default.createElement(i.Input,r({placeholder:"输入分组ID"},this.validateTaskId("taskGroupId",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,r({},g,{label:"标题名称"}),s.default.createElement(i.Input,r({placeholder:"输入分组标题关键字"},this.cantNull("groupName",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,r({},g,{label:""}),s.default.createElement(i.Button,{className:"ml10",type:"primary",onClick:this.handleSubmit,size:"large"},"查询"))))),s.default.createElement(p.default,{searchData:e,current:this.props.current,onSearch:this.props.onSearch,refresh:this.props.refresh,tableData:this.props.tableData}))}});y=i.Form.create()(y),e.exports=y},1334:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var n=a(600),s=l(n),i=a(783),u=a(776),d=l(u),o=a(777),p=l(o),c=a(785),m=l(c),f=s.default.createClass({displayName:"App",getInitialState:function(){var e=this;return{columns:[{title:"推送时间",key:"0",className:"ta_c",dataIndex:"startTime"},{title:"应用名称",key:"1",dataIndex:"appName",className:"td_appname",render:function(e,t){return s.default.createElement("div",null,s.default.createElement("img",{src:t.appIconUrl||p.default.cdn+"/resources/push/images/default_icon.png",width:"24",height:"24"}),e)}},{title:"分组ID",key:"2",className:"ta_c",dataIndex:"groupId"},{title:"类型",key:"3",className:"ta_c",dataIndex:"pushType"},{title:"分组标题",key:"4",className:"td_appname w_240",dataIndex:"groupName"},{title:"目标类型",key:"5",className:"ta_c",dataIndex:"groupType"},{title:"状态",key:"6",className:"ta_c",dataIndex:"pushStatus"},{title:"操作",className:"ta_l",key:"7",render:function(t,a,l){var r=a.appId,n="#/data/push/detail/group?appId="+r+"&groupId="+a.groupId;return"0"===r&&(r=window.ListApp[0].appId),s.default.createElement("div",{className:"btn_wrap"},s.default.createElement(i.Tooltip,{title:"推送详情"},s.default.createElement("a",{target:"_blank",href:window.location.pathname+n},s.default.createElement("i",{className:"i_detail"}))),s.default.createElement(i.Popover,{placement:"bottom",visible:e.state["visible"+l],content:e.getContent("visible"+l,a,l),title:"确定取消推送?",onVisibleChange:e.togglePopover.bind(e,"visible"+l),trigger:"click"},s.default.createElement("span",null,"待推送"===a.pushStatus||"推送中"===a.pushStatus?s.default.createElement(i.Tooltip,{title:"取消推送"},s.default.createElement("a",{href:"javascript:;"},s.default.createElement("i",{className:"i_cancel_push"}))):null)))},dataIndex:""}],refresh:!1}},getContent:function(e,t,a){return s.default.createElement("div",null,s.default.createElement(i.Button,{type:"primary",className:"color_bg mr10",onClick:this.togglePopover.bind(this,e)},"取消"),s.default.createElement(i.Button,{onClick:this.cancelPushTask.bind(this,e,t,a)},"确定"))},togglePopover:function(e){this.setState(r({},e,!this.state[e]))},cancelPushTask:function(e,t){var a=this,l=d.default.CancelTaskGroup;l=p.default.makeUrl(l,{groupId:t.groupId,appId:t.appId}),m.default.get(l,function(){i.message.success("推送任务已取消");var t=a.props.searchData;if(!t){var l=new Date;t={startTime:p.default.dateFormat("yyyy-MM-dd",l)+" 00:00:00",endTime:p.default.dateFormat("yyyy-MM-dd hh:mm:ss",l),index:a.props.current}}for(var n in t)""===t[n]&&delete t[n];a.props.onSearch(t),a.setState(r({},e,!a.state[e]))})},render:function(){var e=this.props.tableData.data;return s.default.createElement(i.Table,{columns:this.state.columns,loading:this.props.tableData.loading,dataSource:e,pagination:this.props.tableData.pagination})}});e.exports=f}});