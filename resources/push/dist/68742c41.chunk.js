webpackJsonp([19],{1365:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var l=a(600),i=n(l),r=a(1366),s=n(r),d=a(776),o=n(d),u=a(777),c=n(u),p=a(785),f=n(p),g=i.default.createClass({displayName:"App",getInitialState:function(){return{current:1,tableData:{loading:!0,data:[],pagination:null}}},tableData:function(e){var t=this,a=c.default.queryString("appId",window.location.href);this.setState({tableData:{loading:!0}}),a&&"0"!==a&&(e.appId=a),e.index&&this.setState({current:e.index});var n=o.default.listOpenTag;n=c.default.makeUrl(n,e),f.default.get(n,function(a){var n=a.value.result;n.map(function(e,t){n[t].key=t}),t.setState({tableData:{data:n,loading:!1,pagination:{total:a.value.amount,current:t.state.current,pageSize:10,showSizeChanger:!1,onChange:function(a){e.index=a,t.setState({current:a}),t.tableData(e)}}}})})},componentDidMount:function(){var e={index:1};this.tableData(e)},render:function(){return i.default.createElement("div",null,i.default.createElement(s.default,{current:this.state.current,onSearch:this.tableData,refresh:this.state.refresh,tableData:this.state.tableData}))}});e.exports=g},1366:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=a(600),s=n(r),d=a(783),o=a(1367),u=n(o),c=a(776),p=n(c),f=a(785),g=n(f),m=a(777),h=n(m),y=a(1369),v=n(y),T=d.Radio.Group,b=d.Form.Item,C=d.Select.Option,E={labelCol:{span:6},wrapperCol:{span:18}},S=s.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{subDisplay:"none",disabled:!0,checked:!1,initData:{},tags:[],values:[],data:null,noticeBarType:"0",noticeExpandType:"0",pushTimeType:"0",appName:"全部应用",appId:0,errors:{},defaultAppid:"应用",randomUser:1}},addOpenTag:function(){var e=this;this.props.form.validateFields(function(t,a){return t?void console.log("Errors in form!!!"):(a.categoryCode=e.state.categoryCode,a.categoryName=e.state.categoryName,a.tagCode=e.state.tagCode,a.tagName=e.state.tagName,void g.default.post(p.default.addOpenTag,a,function(){d.message.success("添加成功"),e.props.onSearch({index:e.props.current})}))})},componentWillMount:function(){var e=this,t=h.default.queryString("id",window.location.href);t&&e.props.form.setFieldsValue({appId:t})},getCategaryData:function(e){var t=this,a=p.default[e];"listTagByCategory"===e&&(a=h.default.makeUrl(a,{cid:this.props.form.getFieldValue("cid")})),g.default.get(a,function(a){var n=a.value,i=n.map(function(t,a){var n="listTagByCategory"===e?String(t.tid):String(t.cid);return s.default.createElement(C,{key:a,data:t,value:n},t.name,s.default.createElement("span",{className:"data_appid"},n))});t.setState(l({},e,i))})},selectMainList:function(e,t){this.props.form.setFieldsValue({cid:e,categoryCode:t.props.data.code,categoryName:t.props.data.name}),this.setState({subDisplay:"",disabled:!0,tagData:void 0,categoryCode:t.props.data.code,categoryName:t.props.data.name}),this.getCategaryData("listTagByCategory")},selectSubList:function(e,t){this.props.form.setFieldsValue({tid:e,tagCode:t.props.data.code,tagName:t.props.data.name}),this.setState({tid:e,disabled:!1,tagData:t.props.children,tagCode:t.props.data.code,tagName:t.props.data.name})},componentDidMount:function(){!h.default.usergroupConfig&&this.getCategaryData("listCategary")},toggleModal:function(){this.setState({visible:!this.state.visible})},searchTag:function(){var e={index:1,appOnly:this.state.checked};this.props.onSearch(e)},selectTags:function(e){this.setState({tags:e})},changeCheckbox:function(e){this.setState({checked:e.target.checked})},render:function(){var e=this.props.form.getFieldProps,t=this.state.tags;return s.default.createElement("div",null,h.default.usergroupConfig?s.default.createElement("div",null,s.default.createElement(d.Row,null,s.default.createElement(d.Col,{span:"18"},s.default.createElement(d.Button,{className:"mr10",onClick:this.searchTag,type:"primary",size:"large"},"查询"),s.default.createElement(d.Checkbox,{checked:this.state.checked,onChange:this.changeCheckbox},"仅查询应用标签"),s.default.createElement("span",{className:"fs12  color999"},"（例：如查询条件为资讯，则仅筛选资讯标签，如查询条件为全部应用，则仅筛选全局配置标签）")),s.default.createElement(d.Col,{span:"6",className:"ta_r"},s.default.createElement(d.Button,{onClick:this.toggleModal,type:"primary",size:"large"},"新建标签"))),this.state.visible&&s.default.createElement(v.default,{current:this.props.current,appOnly:this.state.checked,onSearch:this.props.onSearch,type:"platform",selectTags:this.selectTags,tags:t,showModal:this.toggleModal})):s.default.createElement(d.Form,{horizontal:!0,className:"pugc_title"},s.default.createElement(d.Row,null,s.default.createElement(d.Col,{span:"12"},s.default.createElement(b,i({},E,{label:"一级标签    "}),s.default.createElement(d.Select,i({},e("cid"),{optionFilterProp:"children",onSelect:this.selectMainList,style:{width:190},showSearch:!0,notFoundContent:"无数据",placeholder:"请选择标签"}),this.state.listCategary)))),s.default.createElement(d.Row,null,s.default.createElement(d.Col,{span:"12"},s.default.createElement(b,i({style:{display:this.state.subDisplay}},E,{label:"二级标签    "}),s.default.createElement(d.Select,i({},e("tid"),{optionFilterProp:"children",value:this.state.tagData,onSelect:this.selectSubList,style:{width:290},showSearch:!0,notFoundContent:"无数据",placeholder:"请选择标签"}),this.state.listTagByCategory)))),s.default.createElement(d.Row,null,s.default.createElement(d.Col,{span:"12"},s.default.createElement(b,i({},E,{label:"终端展示样式    "}),s.default.createElement(T,e("displayType",{initialValue:0}),s.default.createElement(d.Radio,{name:"noticeBarType",value:0},"排列展示"),s.default.createElement(d.Radio,{name:"noticeBarType",value:1},"下拉框展示"))))),s.default.createElement(d.Row,null,s.default.createElement(d.Col,{span:"12"},s.default.createElement(b,i({},E,{label:" "}),s.default.createElement(d.Button,{onClick:this.addOpenTag,type:"primary",disabled:this.state.disabled,size:"large"},"添加选中"))))),s.default.createElement(u.default,{current:this.props.current,onSearch:this.props.onSearch,refresh:this.props.refresh,appOnly:this.state.checked,tableData:this.props.tableData}))}});S=d.Form.create()(S),e.exports=S},1367:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i=a(600),r=n(i),s=a(783),d=a(776),o=n(d),u=a(777),c=n(u),p=a(785),f=n(p),g=a(1368),m=n(g),h=s.Radio.Group,y=r.default.createClass({displayName:"App",getInitialState:function(){var e=this,t=[{title:"应用名称",key:"0",dataIndex:"appName",className:"ta_l "},{title:"标签名",key:"1",className:"ta_l",dataIndex:"tagName"},{title:"路径",key:"2",className:"ta_l",dataIndex:"tagPath"},{title:"操作",className:"ta_c",key:"3",render:function(t,a){var n=a.id;return r.default.createElement("div",{className:"btn_wrap"},r.default.createElement("a",{onClick:function(){return e.showModal(a)},href:"javascript:;"},"查看"),r.default.createElement(s.Popover,{placement:"bottom",visible:e.state["delTag-"+n],content:e.getContent("delTag-"+n),title:"删除后不能恢复，继续删除?",onVisibleChange:e.toggle.bind(e,"delTag-"+n),trigger:"click"},r.default.createElement("a",{title:"删除",className:"ml10",to:"javascript:;"},"删除")))},dataIndex:""}],a=[{title:"一级标签",key:"0",dataIndex:"categoryName",className:"td_appname "},{title:"二级标签",key:"1",className:"td_appname",dataIndex:"tagName"},{title:"展示类型",key:"2",className:"ta_c",dataIndex:"displayType",render:function(t,a){var n=a.id;return r.default.createElement("div",null,r.default.createElement(h,{onChange:e.changeRadio,"data-id":n,value:void 0===e.state["value"+n]?t:e.state["value"+n]},r.default.createElement(s.Radio,{"data-id":n,name:"list",value:0},r.default.createElement(s.Popover,{placement:"bottom",visible:e.state["changeType-0-"+n],content:e.getContent("changeType-0-"+n),title:"确定更改展示类型属性?",onVisibleChange:e.toggle.bind(e,"changeType-0-"+n),trigger:"click"},r.default.createElement("span",null,"排列展示"))),r.default.createElement(s.Radio,{"data-id":n,name:"dropdown",value:1},r.default.createElement(s.Popover,{placement:"bottom",visible:e.state["changeType-1-"+n],content:e.getContent("changeType-1-"+n),title:"确定更改展示类型属性?",onVisibleChange:e.toggle.bind(e,"changeType-1-"+n),trigger:"click"},r.default.createElement("span",null,"下拉框展示")))))}},{title:"操作",className:"ta_c",key:"3",render:function(t,a){var n=a.id;return r.default.createElement("div",{className:"btn_wrap"},r.default.createElement(s.Popover,{placement:"bottom",visible:e.state["delTag-"+n],content:e.getContent("delTag-"+n),title:"删除后不能恢复，继续删除?",onVisibleChange:e.toggle.bind(e,"delTag-"+n),trigger:"click"},r.default.createElement("a",{title:"删除",className:"ml10",to:"javascript:;"},"删除")))},dataIndex:""}],n=c.default.usergroupConfig?t:a;return{columns:n,refresh:!1}},changeRadio:function(e){var t=e.target.value,a=e.target["data-id"],n="changeType-"+t+"-"+a;this.toggle(n)},showModal:function(e){var t={visible:!this.state.visible};e&&(e.fid=e.tagId,e.fname=e.tagName,t.currentTag=e),this.setState(t)},delTag:function(e){var t=this,a=e[1],n=this.props.tableData.pagination.total,l=this.props.current,i=o.default.delOpenTag;i=c.default.makeUrl(i,{id:a}),f.default.get(i,function(){s.message.success("删除成功"),n%10===1&&1!==n&&(l-=1),t.props.onSearch({index:l,appOnly:t.props.appOnly})})},changeType:function(e){var t=e[2],a=e[0]+"-"+e[1]+"-"+t,n=o.default.updateDisplayType;n=c.default.makeUrl(n,{id:t,displayType:e[1]}),f.default.get(n,function(){s.message.success("修改成功")}),this.setState(l({},"value"+t,"1"===e[1]?1:0)),this.toggle(a)},getContent:function(e){var t=e.split("-"),a=t[0];return r.default.createElement("div",null,r.default.createElement(s.Button,{type:"primary",className:"color_bg mr10",onClick:this.toggle.bind(this,e)},"取消"),r.default.createElement(s.Button,{onClick:this[a].bind(this,t)},"确定"))},toggle:function(e){this.setState(l({},e,!this.state[e]))},render:function(){return r.default.createElement("div",null,r.default.createElement(s.Table,{columns:this.state.columns,loading:this.props.tableData.loading,dataSource:this.props.tableData.data,pagination:this.props.tableData.pagination}),this.state.visible&&r.default.createElement(m.default,{type:"table",currentTag:this.state.currentTag,showModal:this.showModal}))}});e.exports=y},1368:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},r=a(600),s=n(r),d=a(783),o=a(776),u=n(o),c=a(777),p=n(c),f=a(785),g=n(f),m=d.Form.Item,h=d.Select.Option,y={labelCol:{span:1},wrapperCol:{span:23}},v=s.default.createClass({displayName:"PushAttr",getInitialState:function(){return{listCategory:[],listDimByTagId:[],listTagByCategoryId:[]}},handleCancel:function(){this.props.showModal()},handleOk:function(){var e=this;if("table"===this.props.type)return void this.handleCancel();var t=p.default.queryString("appId",window.location.href),a=u.default.addOpenTag,n={cid:this.props.cid,tid:this.props.currentTag.fid};t&&"0"!==t&&(n.appId=t),a=p.default.makeUrl(a,n),g.default.get(a,function(){d.message.success("添加标签成功"),e.props.showModal(),e.props.onSearch({index:e.props.current,appOnly:e.props.appOnly})})},componentDidMount:function(){this.tagListToggle(this.props.currentTag)},dtClick:function(e){1!==e.fparentId&&this.setState(l({},"display"+e.fid,this.state["display"+e.fid]?"":"none"))},getListTagByCategoryId:function(e){this.setState({listTagByCategoryId:e})},tagListToggle:function(e){var t=this,a=this,n={currentData:e,selectCards:null,reverseType:null,showButton:!1,checkedData:[]};if(e&&(e.fdimensionLazySize>0||4===e.fguiType?n.modalType="select":n.modalType="checkbox",1===e.fguiType&&(n.modalType="radio")),e&&e.fid){var l=p.default.queryString("appId",window.location.href);n["radio"+e.fid]=null;var i=u.default.getTagByTagId;return i=p.default.makeUrl(i,{appId:l,tid:e.fid}),void g.default.get(i,function(l){var i=l.value||{};if(i.fid){n.listDimByTagId=[i],n["defaultTreeList"+i.fid]=[],n.currentId=i.fid,n.currentName=e.fname;var r=i.fdimensions;if(!r.length)return void d.message.error("无数据");r.map(function(e){n["checkbox"+i.fid+"-"+e.fid]=!1}),a.setState(n)}else n.listDimByTagId=[],n.modalType="myTag",a.setState(n),t.changeCheckboxRadio({target:{myTag:!0,checked:!0,data:{fidType:e.fidType,fname:"我的人群标签",fid:e.fid,fdimensions:[e]},source:{fid:e.fid}}})})}this.setState(n)},getTreeData:function(e){var t=this,a=p.default.queryString("appId",window.location.href),n=u.default.listDimByTagIdAndName,i=this.props.currentTag.fid;n=p.default.makeUrl(n,{tid:i,name:e,appId:a}),g.default.get(n,function(e){t.setState(l({},"listDimByTagIdAndName"+i,e.value))})},render:function(){var e=this,t=this.state.listDimByTagId,a=t.map(function(t,a){var n=null,l="auto",r=[],o=null;if(t.fdimensionLazySize>0||4===t.fguiType){var u=e.state["listDimByTagIdAndName"+t.fid]||[];!u.length&&t.fdimensions.length>0&&(u=t.fdimensions,u.length>1e3&&(u=u.slice(0,1e3)));var c=u.map(function(e,t){return s.default.createElement(h,{"data-value":e,value:String(e.fvalue),key:t},e.fname)});o=s.default.createElement("div",{id:"treeSelect"+t.fid,key:a},s.default.createElement(d.Select,{labelInValue:!0,optionFilterProp:"children",style:{width:"100%"},multiple:!0,notFoundContent:"无数据,请输入关键字查找",placeholder:"请输入关键字查找",data:t,onSearch:e.getTreeData},c))}else o=t.fdimensions.map(function(e){var t=1===e.fidType?{width:"100%"}:{};return s.default.createElement("div",{className:"list_box",style:t},e.fname,e.fcrowdSize?"（"+e.fcrowdSize+"人）":"")}),1===t.fguiType&&(o=t.fdimensions.map(function(e){return s.default.createElement("div",{className:"list_box"},e.fname)}));return r.push(o),n=s.default.createElement("div",{className:"ug_form",key:a},s.default.createElement(m,i({style:{height:l}},y,{label:null}),r))});return s.default.createElement("div",null,s.default.createElement(d.Modal,{width:900,onCancel:this.handleCancel,onOk:this.handleOk,okText:"table"===this.props.type?"确定":"添加",cancelText:"返回",title:"标签详情-"+this.props.currentTag.fname,visible:!0},s.default.createElement("div",{className:"usergroup analyze_usergroup"},s.default.createElement("div",{className:"ug_content",style:{width:840}},s.default.createElement("div",{className:"ug_list"},a)))))}});e.exports=v},1369:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var l=a(600),i=n(l),r=a(783),s=a(776),d=n(s),o=a(777),u=n(o),c=a(785),p=n(c),f=a(1370),g=n(f),m=a(1368),h=n(m),y=i.default.createClass({displayName:"PushAttr",getInitialState:function(){return{listCategory:[],listTagByCategoryId:[]}},handleCancel:function(){this.props.showModal()},handleOk:function(){this.props.showModal()},componentDidMount:function(){function e(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.default.get(n,function(e){var t=e.value;i.next(t)});case 2:e=t.sent,a.setState({listCategory:e});case 4:case"end":return t.stop()}},t[0],this)}var t=[e].map(regeneratorRuntime.mark),a=this,n=d.default.listCategary,l=u.default.queryString("appId",window.location.href);n=u.default.makeUrl(n,{appId:l});var i=e();i.next()},getListTagByCategoryId:function(e,t){this.setState({listTagByCategoryId:e,cid:t})},showModal:function(e){var t={visible:!this.state.visible,currentTag:e};this.setState(t)},render:function(){var e=this,t=this,a=i.default.createElement(g.default,{listMyTag:t.listMyTag,type:"attr",route:"platform",listCategory:t.state.listCategory,getListTagByCategoryId:this.getListTagByCategoryId}),n=this.state.listTagByCategoryId,l=void 0,s=n.map(function(t,a){return i.default.createElement(r.Col,{key:a,span:"6"},i.default.createElement(r.Button,{title:t.fname,style:{maxWidth:220},className:"mr10 mb10 fs14 ellipsis",onClick:function(){return e.showModal(t)}},t.fname))});l=i.default.createElement(r.Row,null,s),n.length||(l="请选择标签"),l=i.default.createElement("div",{className:"ug_list"},l);var d="标签列表";return i.default.createElement("div",null,i.default.createElement(r.Modal,{width:1200,onCancel:this.handleCancel,onOk:this.handleOk,okText:"确定",cancelText:"返回",title:d,visible:!0},i.default.createElement("div",{className:"usergroup analyze_usergroup"},i.default.createElement("div",{className:"ug_sidebar"},i.default.createElement("dl",null,a)),i.default.createElement("div",{className:"ug_content",style:{width:940}},i.default.createElement("div",{className:"ug_list"},l)))),this.state.visible&&i.default.createElement(h.default,{current:this.props.current,appOnly:this.props.appOnly,onSearch:this.props.onSearch,cid:this.state.cid,currentTag:this.state.currentTag,showModal:this.showModal}))}});e.exports=y},1370:function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var i=a(600),r=n(i),s=a(783),d=a(776),o=n(d),u=a(777),c=n(u),p=a(785),f=n(p),g=r.default.createClass({displayName:"UsergroupSidebar",getInitialState:function(){return{}},dtClick:function(e){1!==e.fparentId&&this.setState(l({},"display"+e.fid,this.state["display"+e.fid]?"":"none")),this.listTagByCategoryId(e.fid)},getSidebar:function(e,t){var a=this,n=this,l=this.state["display"+t.fid]?"minus-circle-o":"plus-circle-o",i=this.state["display"+t.fid]?180:0;e.push(r.default.createElement("dt",{title:t.fname,className:n.state.fid===t.fid?"current":"",onClick:function(){return a.dtClick(t)},style:{cursor:1===t.fparentId?"default":"pointer"},key:t.fid},t.fname,1===t.fparentId?null:r.default.createElement("div",{className:"ug_icon",style:{transition:"0.5s",transformStyle:"preserve-3d",transform:"rotateY("+i+"deg)"}},r.default.createElement(s.Icon,{type:l}))));var d=t.fchildren.map(function(e){var a=void 0,l=[];return a=e.fchildren.length>0?r.default.createElement("dd",{style:{display:n.state["display"+t.fid]||1===t.fparentId?"":"none"},className:"sidebar_children",key:e.fid},r.default.createElement("dl",null,n.getSidebar(l,e))):r.default.createElement("dd",{title:e.fname,style:{display:n.state["display"+t.fid]||1===t.fparentId?"":"none"},key:e.fid,className:n.state.fid===e.fid?"current":"",onClick:function(){return n.listTagByCategoryId(e.fid)}},e.fname)});return e=e.concat(d)},listTagByCategoryId:function(e){var t=this,a=c.default.queryString("appId",window.location.href),n="platform"===this.props.route?o.default.openListTagByCategoryId:o.default.listTopTagByCategoryId;n=c.default.makeUrl(n,{cid:e,appId:a}),f.default.get(n,function(a){var n=a.value;t.setState({listTagByCategoryId:n,fid:e}),t.props.getListTagByCategoryId(n,e)})},render:function(){var e=this.props.type,t=this.state.fid,a=this,n=this.props.listCategory.map(function(n){var l=[];return n.alink?"usergroup"===e?l.push(r.default.createElement("dt",{title:n.fname,key:n.fid,className:"myTag"===t?"cursor_p current":"cursor_p",onClick:a.props.listMyTag},n.fname)):l.push(r.default.createElement("dt",{className:"myTag"===a.state.fid?"cursor_p current":"cursor_p"},"公共属性标签")):l=a.getSidebar(l,n),l});return n.length||(n=null),r.default.createElement("div",null,n)}});e.exports=g}});