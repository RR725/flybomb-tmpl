webpackJsonp([6],{896:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(897),n=i(l),o=a(914),p=i(o),u=a(915),d=i(u),c=a(917),m=i(c),f=a(777),h=i(f),g=r.default.createClass({displayName:"App",getInitialState:function(){return{refresh:!1}},render:function(){var e=this.props.location.search,t=h.default.queryString("pushType",e);return r.default.createElement("div",null,"message"===t?r.default.createElement(p.default,{pushType:t}):null,"notice"===t?r.default.createElement(n.default,{pushType:t}):null,"group"===t?r.default.createElement(d.default,{pushType:t}):null,"timing"===t?r.default.createElement(m.default,null):null,"desktop"===t?r.default.createElement(n.default,{pushType:"notice"}):null)}});e.exports=g},897:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(600),o=i(n),p=a(783),u=a(799),d=i(u),c=a(898),m=i(c),f=a(776),h=i(f),g=a(785),y=i(g),v=a(777),I=i(v),T=a(899),b=i(T),E=a(900),w=i(E),k=a(901),S=i(k),x=a(902),P=i(x),N=a(903),F=i(N),D=a(904),C=i(D),V=a(907),R=i(V),U=a(908),B=i(U),_=a(909),A=i(_),G=a(910),O=i(G),q=a(906),L=i(q),j=a(911),M=i(j),J=a(800),W=i(J),z=p.Radio.Group,K=p.Form.Item,H=null,$=null;window.vedioFilePathJson={},window.smallImageFilePathJson={},window.bigImageFilePathJson={},window.iconImageFilePathJson={};var X=W.default.createActions(["notice"]),Q=W.default.createStore({listenables:[X],jsonData:null}),Z={labelCol:{span:4},wrapperCol:{span:20}},Y=o.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{offLine:1,cronWeek:[1],onlyWifi:1,vibrate:1,lights:1,sound:1,distinctId:[],displayDistinct:"none",displayBlackList:"none",iconImageDisplay:"none",smallImageDisplay:"none",vedioDisplay:"none",bigImageDisplay:"none",noticeBarType:2,iconType:1,icon:"push_icon1",noticeExpandType:0,clickType:0,scope:0,userType:2,distinct:0,fixSpeed:0,msgCache:0,blackList:[],netType:0,fixDisplay:0,suspend:1,startTimeStatus:"success",endTimeStatus:"success",pushTimeStatus:"success",popoverVisible:!1,clearNoticeBar:1,smalllayerDisplay:"none",biglayerDisplay:"none",visible:!1,pushReviewNumber:"...",toggleStatus:!1,showAdvanceStatus:!1,pushTimeType:0,distinctTitle:[]}},delParams:function(e,t){for(var a in t)delete e[a]},clickTypeParams:function(e,t){this.setState(s({},"clickTypeParams"+t,e))},handleOk:function(){var e=this,t=window.location.href,a=t.split("#"),i=I.default.queryString("pushType",a[1]),s=I.default.queryString("appId",window.location.href),r={appId:s,json:JSON.stringify(this.state.requestData)},l=this.state.pushReviewNumber;if("0"===l)return void p.message.error("预计推送人数为0，不可以创建推送任务");if(!this.state.submiting){this.setState({submiting:!0});var n=h.default.addNotice,o="/data/push/record?appId="+s;"timing"===i&&(n=h.default.cronTaskAddNotice,o="/data/push/timing?appId="+s),"desktop"===i&&(n=h.default.addDeskTopNotice),y.default.post(n,r,function(){p.message.success("提交成功"),window.location.hash=o},function(){e.setState({submiting:!1})})}},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},selectCronWeek:function(e){this.setState({cronWeek:e})},onChangeIcon:function(e){this.setState({icon:e})},handleSubmit:function(e,a,i){var s=this,r=this;"deal"===a&&this.setState({jumpUserGroup:!0});var n=window.location.href,o=n.split("#"),u=I.default.queryString("pushType",o[1]);return this.state.permission===!1&&"deal"!==a&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId")?void p.message.error("用户群标签没权限"):void this.props.form.validateFields(function(e,n){var o=n.userType;if(!(+new Date(n.fixStartDisplayTime)>+new Date(n.fixEndDisplayTime))){if("deal"===a)return n.noticeBarImgUrl||(n.noticeBarImgUrl=r.state.noticeBarImgUrl),n.noticeExpandImgUrl||(n.noticeExpandImgUrl=r.state.noticeExpandImgUrl),n.showAdvanceStatus=r.state.showAdvanceStatus,n.distinctId=r.state.distinctId,n.distinctTitle=r.state.distinctTitle,Q.jsonData=n,void(t.jsonData=n);var p=r.state.distinctId;if(n.distinct&&0===p.length)return void r.setState({displayDistinct:""});for(var d in n)d.indexOf("distinctId")>-1&&delete n[d];p&&(n.distinctId=p.join(","));var c=[];for(var m in n)if(m.indexOf("blackId")>-1&&n[m]){var f=m.split("blackId")[1];c.push(f),delete n[m]}if(n.blackId=c.join(","),(5!==o||n.tagIds)&&(1!==o||n.userGroupId&&"null"!==n.userGroupId)){if(1!==n.noticeBarType||window.smallImageFilePathJson.noticeBarImgUrl||n.noticeBarImgUrl||r.state.noticeBarImgUrl||r.props.form.getFieldValue("noticeBarImgUrl")||(s.setState({smallImageDisplay:""}),e={}),2!==n.iconType||window.iconImageFilePathJson.iconUrl||n.iconUrl||r.state.iconUrl||r.props.form.getFieldValue("iconUrl")||(s.setState({iconImageDisplay:""}),e={}),2!==n.noticeExpandType||window.bigImageFilePathJson.noticeExpandImgUrl||n.noticeExpandImgUrl||r.state.noticeExpandImgUrl||r.props.form.getFieldValue("noticeExpandImgUrl")||(s.setState({bigImageDisplay:""}),e={}),3!==n.noticeExpandType||window.vedioFilePathJson.vedioUrl||r.props.form.getFieldValue("vedioUrl")||(s.setState({vedioDisplay:""}),e={}),n.target=n["target"+o],n.userFilePath=n["userFilePath"+o],delete n["userFilePath"+o],""===n.target&&delete n.target,n.userFilePath&&delete n.target,e)return console.log(e),void console.log("Errors in form!!!");if(n.noticeBarInfo={noticeBarType:n.noticeBarType,title:n.title.trim(),content:n.content.trim(),noticeBarImgUrl:1===n.noticeBarType?window.smallImageFilePathJson.noticeBarImgUrl||n.noticeBarImgUrl||r.state.noticeBarImgUrl||r.props.form.getFieldValue("noticeBarImgUrl"):void 0},r.delParams(n,n.noticeBarInfo),n.noticeExpandInfo={noticeExpandType:n.noticeExpandType,noticeExpandContent:1===n.noticeExpandType?n.noticeExpandContent:void 0,noticeExpandImgUrl:2===n.noticeExpandType?window.bigImageFilePathJson.noticeExpandImgUrl||n.noticeExpandImgUrl||r.state.noticeExpandImgUrl||r.props.form.getFieldValue("noticeExpandImgUrl"):void 0,actSetting:{noticeExpandVedioUrl:window.vedioFilePathJson.vedioUrl||r.props.form.getFieldValue("vedioUrl"),onlyWifi:r.props.form.getFieldValue("onlyWifi")},vedioUrl:void 0,onlyWifi:void 0},r.delParams(n,n.noticeExpandInfo),"timing"===u){var g=n.cronTime;"object"===("undefined"==typeof g?"undefined":l(g))&&(g=I.default.dateFormat("hh:mm:ss",g));var v=s.state.cronWeek;n.cronTimeInfo={time:g,week:v.join(",")},delete n.cronTime,r.delParams(n,n.cronTimeInfo)}var T="App";1===n.clickType&&(T="AppPage");var b=[];for(var E in n)if(E.indexOf("key"+T)>-1){var w=E.split("key"+T)[1];b.push(w)}for(var k=b.length>0?b:r.state["clickTypeParams"+T],S={},x=0;x<k.length;x++){var P="key"+T+k[x],N="value"+T+k[x];n[P]&&(S[n[P].trim()]=n[N].trim(),delete n[P],delete n[N])}n.clickTypeInfo={clickType:n.clickType,url:n.url,parameters:S,clickPackage:n.clickPackage,activity:n.activity,customAttribute:n.customAttribute},r.delParams(n,n.clickTypeInfo),n.pushTimeInfo={pushTimeType:n.pushTimeType,startTime:n.startTime&&I.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.startTime),offLine:n.offLine,validTime:n.validTime},r.delParams(n,n.pushTimeInfo),n.groupPushScope=n.scope,n.userGroupName=r.state.userGroupName,n.userTypeInfo={userType:o,userGroupId:n.userGroupId,target:n.target,tagIds:n.tagIds,scope:n.scope,userFilePath:n.userFilePath},r.delParams(n,n.userTypeInfo);var F={vibrate:n.vibrate||0!==n.vibrate&&!n.vibrate?1:0,lights:n.lights||0!==n.lights&&!n.lights?1:0,sound:n.sound||0!==n.sound&&!n.sound?1:0};if(n.advanceInfo={distinct:n.distinct,msgCache:n.msgCache,distinctId:n.distinctId,fixSpeed:n.fixSpeed,blackId:n.blackId,black:n.black,fixSpeedRate:n.fixSpeedRate,notifyKey:n.notifyKey,fixDisplay:n.fixDisplay,fixDisplayTime:n.fixDisplayTime&&I.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixDisplayTime),netType:n.netType,suspend:n.suspend,clearNoticeBar:n.clearNoticeBar||0!==n.clearNoticeBar&&!n.clearNoticeBar?1:0,fixStartDisplayTime:n.fixStartDisplayTime&&I.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixStartDisplayTime),fixEndDisplayTime:n.fixEndDisplayTime&&I.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixEndDisplayTime),notificationType:F,noticeImgUrl:void 0},"desktop"===u){n.advanceInfo={distinct:n.distinct,distinctId:n.distinctId,fixSpeed:n.fixSpeed,blackId:n.blackId,black:n.black,fixSpeedRate:n.fixSpeedRate},n.launcherInfo={iconType:n.iconType,icon:n.icon,iconUrl:window.iconImageFilePathJson.iconUrl||n.iconUrl||r.state.iconUrl||r.props.form.getFieldValue("iconUrl")},r.delParams(n,n.launcherInfo),n.title=n.noticeBarInfo.title,n.content=n.noticeBarInfo.content,delete n.noticeBarInfo,delete n.noticeExpandInfo,delete n.groupPushScope,delete n.userGroupName;for(var D in n)(D.indexOf("target")>-1||D.indexOf("keyApp")>-1||D.indexOf("valueApp")>-1)&&delete n[D]}r.delParams(n,n.advanceInfo.notificationType),r.delParams(n,n.advanceInfo);var C="notice"===r.props.pushType?0:1,V=I.default.queryString("appId",window.location.href);if(n.appId=V,n.advanceInfo.black&&""===n.advanceInfo.blackId)return void r.setState({showAdvanceStatus:!0});r.setState({requestData:n,visible:"group"!==a});var R={appId:V,userTypeInfo:n.userTypeInfo},U=h.default.getPushCount;U=I.default.makeUrl(U,{appId:V,pushType:C,json:JSON.stringify(R)}),r.setState({pushReviewNumber:"..."}),"group"!==a&&y.default.get(U,function(e){r.setState({pushReviewNumber:e.value})},null,{timeout:3e5}),i&&"function"==typeof i&&i(n)}}})},validateRemark:function(e){var t=this.props.form.getFieldProps,a=100;return t(e,{validate:[{rules:[{required:!1},{max:a,message:"任务备注不能超过"+a+"个字"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},validateTitle:function(e){var t=this.props.form.getFieldProps,a=I.default.queryString("pushType",window.location.href),i="desktop"===a?5:32;return t(e,{validate:[{rules:[{required:!0,whitespace:!0,message:"请输入标题"},{max:i,message:"标题不能超过"+i+"个字"}],trigger:["onBlur","onChange"]}]})},validateContent:function(e){var t=this.props.form.getFieldProps,a=I.default.queryString("pushType",window.location.href),i="desktop"===a?"备注":"内容";return t(e,{validate:[{rules:[{required:!0,message:"请输入"+i},{max:100,message:i+"不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},queryMobileValidImei:function(){var e=this.props.form.getFieldValue("checkImeiPath"),t=this.props.form.getFieldValue("versionNum"),a="?checkImeiPath="+e+"&versionNum="+t;y.default.get(h.default.queryMobileValidImei+a,function(e){var t=e.value;p.message.success("有效IMEI数"+t)})},componentWillMount:function(){var e=this,t=I.default.queryString("appId",window.location.href);t&&e.props.form.setFieldsValue({appId:t})},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},restoreStatus:function(e,t){if("noticeBarType"===e&&1===t&&(1===this.props.form.getFieldValue("noticeExpandType")||3===this.props.form.getFieldValue("noticeExpandType"))){var a={noticeExpandType:0,smalllayerDisplay:"none"};this.setState(a),this.props.form.setFieldsValue(a)}},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeBlack:function(e){var t={blackList:e},a=e.filter(function(e){return e.choose});a.length?t.displayBlackList="none":t.displayBlackList="",this.setState(t)},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,$=null,H=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},changeRadio:function(e,t){var a={};"userGroupAuth"===t&&(a.permission=e.target.permission),"black"===t&&(a.displayBlackList="");var i=e.target.name,s=e.target.value;if(a[i]=s,!("noticeBarType"===i&&this.props.form.getFieldValue("noticeBarType")===s||"noticeExpandType"===i&&this.props.form.getFieldValue("noticeExpandType")===s)){if("userGroupId"===i&&(a.userGroupName=e.target.label,a.userGroupDesc=e.target.expression,$=e.target.label,H=e.target.expression),"distinct"==i&&0==s&&(a.distinctTitle=[],a.distinctId=[]),"vibrate"===s||"sound"===s||"lights"===s){var r=e.target.checked;a[s]=r?1:0}this.setState(a),this.props.form.setFieldsValue(a),this.restoreStatus(i,s),this.showButton(i,s)}},showButton:function(e,t){"noticeExpandType"===e&&1!==t&&this.setState({noticeExpandContent:!1}),"noticeExpandType"===e&&2===t&&this.setState({toggleStatus:!0,showBigImg:!0,biglayerDisplay:"none"}),"noticeExpandType"===e&&1===t&&this.setState({toggleStatus:!1,biglayerDisplay:"none"})},handleCancel:function(){this.setState({visible:!1,submiting:!1})},getAppName:function(e){var t="全部应用",a=d.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=I.default.queryString("appId",window.location.href);this.state.appId&&e!==this.state.appId&&(this.getAppName(e),this.setState({pushReviewNumber:"...",appId:e}),this.getAppInfo(),this.getBlackList())},getAppInfo:function(e){var t=this,a=I.default.queryString("appId",window.location.href);y.default.get(h.default.getAppInfo+"?appId="+a,function(a){var i=a.value.appIconUrl;e&&e(i),e||(t.setState({noticeImgUrl:""===i?null:i}),t.props.form.setFieldsValue({noticeImgUrl:""===i?null:i})),t.setState({loadAppInfo:!0,flymeAuth:a.value.flymeAuth,appName:a.value.appName,limitRate:a.value.limitRate,msgCacheStatus:a.value.msgCache,pushOtherPackage:a.value.pushOtherPackage})})},setUserTypeGroup:function(e){e=e.items;for(var t=e.length,a=I.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&(this.setState({userGroupName:e[i].name}),$=e[i].name,H=e[i].userGroupDesc)},fillFormData:function(e){var t,a=this,i=I.default.queryString("copyTaskId",window.location.href),r=I.default.queryString("pushType",window.location.href),l=e.value,n=l.clickTypeInfo.clickType,o=n<2?l.clickTypeInfo.parameters:void 0,p="App";1===n&&(p="AppPage");var u=[],d=(t={noticeBarType:l.noticeBarInfo&&l.noticeBarInfo.noticeBarType,noticeBarImgUrl:l.noticeBarInfo&&l.noticeBarInfo.noticeBarImgUrl,remark:l.remark,title:l.noticeBarInfo&&l.noticeBarInfo.title||l.title,content:l.noticeBarInfo&&l.noticeBarInfo.content||l.content,noticeExpandContent:l.noticeExpandInfo&&l.noticeExpandInfo.noticeExpandContent,noticeExpandImgUrl:l.noticeExpandInfo&&l.noticeExpandInfo.noticeExpandImgUrl,noticeExpandType:l.noticeExpandInfo&&l.noticeExpandInfo.noticeExpandType,vedioUrl:l.noticeExpandInfo&&l.noticeExpandInfo.actSetting&&l.noticeExpandInfo.actSetting.noticeExpandVedioUrl,onlyWifi:l.noticeExpandInfo&&l.noticeExpandInfo.actSetting&&(l.noticeExpandInfo.actSetting.onlyWifi?1:0),activity:l.clickTypeInfo.activity},s(t,"parameters"+p,o),s(t,"clickType",l.clickTypeInfo.clickType),s(t,"url",l.clickTypeInfo.url),s(t,"clickPackage",l.clickTypeInfo.clickPackage),s(t,"customAttribute",l.clickTypeInfo.customAttribute),s(t,"msgCache",l.advanceInfo.msgCache?1:0),s(t,"suspend",l.advanceInfo.suspend?1:0),s(t,"clearNoticeBar",l.advanceInfo.clearNoticeBar?1:0),s(t,"fixSpeed",l.advanceInfo.fixSpeed?1:0),s(t,"fixSpeedRate",l.advanceInfo.fixSpeedRate),s(t,"notifyKey",l.advanceInfo.notifyKey),s(t,"distinct",i?1:l.advanceInfo.distinct?1:0),s(t,"noticeImgUrl",l.advanceInfo.noticeImgUrl),s(t,"vibrate",l.advanceInfo.notificationType.vibrate?1:0),s(t,"lights",l.advanceInfo.notificationType.lights?1:0),s(t,"sound",l.advanceInfo.notificationType.sound?1:0),s(t,"black",l.advanceInfo.black?1:0),s(t,"offLine",l.pushTimeInfo&&l.pushTimeInfo.offLine?1:0),s(t,"validTime",l.pushTimeInfo&&l.pushTimeInfo.validTime),s(t,"iconType",l.launcherInfo&&l.launcherInfo.iconType),s(t,"icon",l.launcherInfo&&l.launcherInfo.icon),s(t,"iconUrl",l.launcherInfo&&l.launcherInfo.iconUrl),t),c=this.props.tableDataIndex;if(c){if(l.userTypeInfo){var m=l.userTypeInfo.userType;d.userType=m,d.userGroupId=l.userTypeInfo.userGroupId,d["target"+m]=l.userTypeInfo.target||l.userFileName,d.tagIds=l.userTypeInfo.tagIds,d.scope=l.userTypeInfo.scope,d["userFilePath"+m]=l.userTypeInfo.userFilePath}d.fixDisplay=l.advanceInfo.fixDisplay}"desktop"!==r&&(window.vedioFilePathJson.vedioUrl=l.noticeExpandInfo.actSetting&&l.noticeExpandInfo.actSetting.noticeExpandVedioUrl);for(var f in o)u.push({key:f,value:o[f]});for(var h=0;h<u.length;h++)d["key"+p+(h+1)]=u[h].key,d["value"+p+(h+1)]=u[h].value,window.parametersJson["key"+p+(h+1)]=u[h].key,window.parametersJson["value"+p+(h+1)]=u[h].value;a.props.form.setFieldsValue(d),a.setState({fixDisplay:l.advanceInfo.fixDisplay,noticeBarType:l.noticeBarInfo.noticeBarType,msgCacheStatus:l.advanceInfo.msgCacheStatus,offLine:l.pushTimeInfo&&l.pushTimeInfo.offLine?1:0}),a.showAdvance()},getBlackList:function(){var e=this,t=I.default.queryString("appId",window.location.href),a=I.default.queryString("taskId",window.location.href),i=h.default.pushTaskListBlack,s={appId:t};a&&(s.copyTaskId=a),y.default.post(i,s,function(t){var a=t.value,i={blackList:a};a.length?i.black=1:i.black=0,e.setState(i)})},componentDidMount:function(){var e=this,t=I.default.queryString("appId",window.location.href);this.setState({appId:t});var a=I.default.queryString("deal",window.location.href),i=I.default.queryString("groupId",window.location.href),s=I.default.queryString("id",window.location.href);if(this.getBlackList(),a&&Q.jsonData&&!this.props.addPush?(this.setState({userType:1,userGroupId:s}),Q.jsonData.userType=1,Q.jsonData.userGroupId=s,e.setState(Q.jsonData),e.props.form.setFieldsValue(Q.jsonData)):(H=null,$=null,window.vedioFilePathJson={},window.smallImageFilePathJson={},window.bigImageFilePathJson={},window.iconImageFilePathJson={},window._smallIconValue=null,e.props.form.setFieldsValue(this.state)),i){var r={userType:1,userGroupId:i};this.setState(r),e.props.form.setFieldsValue(r)}this.getAppInfo(function(a){e.props.form.setFieldsValue({noticeImgUrl:a});var i=I.default.queryString("taskId",window.location.href);if(i){var s=h.default.pushTaskCopy;s=I.default.makeUrl(s,{taskId:i,appId:t}),y.default.get(s,function(t){e.fillFormData(t)})}});var l=this.props.tableDataIndex;l&&this.fillFormData({value:l})},clickHide:function(e){1===e&&this.setState({noticeExpandContent:!1,toggleStatus:!1}),2===e&&this.setState({noticeExpandImgUrl:!1,showBigImg:!1,toggleStatus:!1})},clickShow:function(e){if(1===e){var t=this.props.form.getFieldValue("noticeExpandContent");if(!t)return void p.message.error("请输入展开文本");this.setState({noticeExpandContent:!0,toggleStatus:!0})}if(2===e){var a=this.props.form.getFieldValue("noticeExpandImgUrl");this.setState({noticeExpandImgUrl:a,showBigImg:!0,toggleStatus:!0})}},changeIcon:function(e){this.setState({noticeImgUrl:null}),this.props.form.setFieldsValue({noticeImgUrl:e})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({startTime:e,fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},render:function(){var e=this.props.form.getFieldProps,t=I.default.queryString("pushType",window.location.href),a=I.default.queryString("copyTaskId",window.location.href),i="desktop"===t?"请输入桌面通知标题，最长不超过5个中文长度":"请输入标题",s="desktop"===t?"备注仅作为推送任务的说明文字，最长不超过100个中文长度":"请输入内容",l="desktop"===t?"备注":"内容",n=o.default.createElement("span",null,l,"    "),u="desktop"===t?o.default.createElement(m.default,{text:"标题　"}):o.default.createElement("span",null,"标题    ");return o.default.createElement(p.Form,{horizontal:!0,id:"detailTable"},o.default.createElement(p.Row,null,o.default.createElement(p.Col,{span:"15",className:"col_left"},"desktop"!==t&&o.default.createElement(K,r({},Z,{label:o.default.createElement(m.default,{text:"任务备注　"})}),o.default.createElement(p.Input,r({rows:"3",type:"textarea",placeholder:"请输入任务备注",style:{width:400}},this.validateRemark("remark")))),"desktop"!==t&&o.default.createElement(K,r({},Z,{label:"通知栏样式    "}),o.default.createElement(z,e("noticeBarType",{initialValue:this.props.form.getFieldValue("noticeBarType"),onChange:this.changeRadio}),o.default.createElement(p.Radio,{name:"noticeBarType",value:2},"安卓原生"),o.default.createElement(p.Radio,{name:"noticeBarType",value:1},"图片")),o.default.createElement(A.default,{type:"noticeBarType",form:this.props.form,smallImageDisplay:this.state.smallImageDisplay,url:"noticeBarImgUrl",value:1})),o.default.createElement("div",null,o.default.createElement(K,r({},Z,{label:u}),o.default.createElement(p.Input,r({placeholder:i,style:{width:400}},this.validateTitle("title")))),o.default.createElement(K,r({},Z,{label:n}),o.default.createElement(p.Input,r({rows:"9",placeholder:s,style:{width:400},type:"textarea"},this.validateContent("content"))))),"desktop"!==t&&o.default.createElement(B.default,{changeRadio:this.changeRadio,noticeBarType:this.state.noticeBarType,flymeAuth:this.state.flymeAuth,bigImageDisplay:this.state.bigImageDisplay,vedioDisplay:this.state.vedioDisplay,form:this.props.form,addPush:this.props.addPush,formItemLayout:Z}),"desktop"===t&&o.default.createElement(K,r({},Z,{label:o.default.createElement(m.default,{text:"小图标　"})}),o.default.createElement(z,e("iconType",{initialValue:this.props.form.getFieldValue("iconType"),onChange:this.changeRadio}),o.default.createElement(p.Radio,{name:"iconType",value:1},"默认图标"),o.default.createElement(p.Radio,{name:"iconType",value:2},"自定义图标")),o.default.createElement(O.default,{type:"iconType",icon:this.state.icon,onChangeIcon:this.onChangeIcon,form:this.props.form,iconImageDisplay:this.state.iconImageDisplay,url:"iconUrl",value:this.props.form.getFieldValue("iconType")})),o.default.createElement(S.default.render,{form:this.props.form,formItemLayout:Z,pushOtherPackage:this.state.pushOtherPackage,getFieldProps:e,addPush:this.props.addPush,clickTypeParams:this.clickTypeParams,clickType:this.props.form.getFieldValue("clickType"),changeRadio:this.changeRadio}),this.props.groupPush?null:o.default.createElement("div",null,o.default.createElement(w.default,{formItemLayout:Z,getFieldProps:e,jumpUserGroup:this.state.jumpUserGroup,selectCronWeek:this.selectCronWeek,form:this.props.form,onChangePushTime:this.onChangePushTime,pushTimeStatus:this.state.endTimeStatus,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),o.default.createElement(b.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:Z,getFieldProps:e})),(this.props.groupType||!this.props.groupPush)&&this.state.loadAppInfo?o.default.createElement(P.default,{form:this.props.form,formItemLayout:Z,getFieldProps:e,clearUserGroup:this.clearUserGroup,scope:this.state.scope,tableDataIndex:this.props.tableDataIndex,groupPush:!!this.props.groupType,userType:this.props.form.getFieldValue("userType"),handleSubmit:this.handleSubmit,userGroupId:this.state.userGroupId,type:this.props.pushType,setUserTypeGroup:this.setUserTypeGroup,flymeAuth:this.state.flymeAuth,appId:I.default.queryString("appId",window.location.href),changeRadio:this.changeRadio}):null,this.props.groupPush||"timing"===t?null:o.default.createElement(R.default,{form:this.props.form,formItemLayout:Z,copyTaskId:a,jsonData:Q.jsonData,appId:I.default.queryString("appId",window.location.href),getFieldProps:e,displayDistinct:this.state.displayDistinct,changeCheckbox:this.changeCheckbox,distinct:this.props.form.getFieldValue("distinct"),pushType:this.props.pushType,changeRadio:this.changeRadio}),o.default.createElement(F.default,{form:this.props.form,formItemLayout:Z,getFieldProps:e,appId:I.default.queryString("appId",window.location.href),fixSpeed:this.state.fixSpeed,blackList:this.state.blackList,black:this.state.black,msgCache:this.state.msgCache,changeBlack:this.changeBlack,displayBlackList:this.state.displayBlackList,msgCacheStatus:this.state.msgCacheStatus,startTimeStatus:this.state.startTimeStatus,tableDataIndex:this.props.tableDataIndex,endTimeStatus:this.state.endTimeStatus,limitRate:this.state.limitRate,fixDisplay:this.state.fixDisplay,netType:this.state.netType,suspend:this.state.suspend,showAdvanceStatus:this.state.showAdvanceStatus,showAdvance:this.showAdvance,clearNoticeBar:this.state.clearNoticeBar,vibrate:this.props.form.getFieldValue("vibrate"),lights:this.props.form.getFieldValue("lights"),changeIcon:this.changeIcon,sound:this.props.form.getFieldValue("sound"),noticeImgUrl:this.state.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl"),changeRadio:this.changeRadio,type:this.props.pushType})),o.default.createElement(p.Col,{span:"9",style:{position:"relative"}},o.default.createElement(M.default,{noticeBarType:this.state.noticeBarType,noticeImgUrl:this.state.noticeImgUrl,noticeExpandContent:this.state.noticeExpandContent,noticeExpandType:this.state.noticeExpandType,showBigImg:this.state.showBigImg,noticeExpandImgUrl:this.state.noticeExpandImgUrl,toggleStatus:this.state.toggleStatus,form:this.props.form}),1!==this.state.noticeExpandType&&2!==this.state.noticeExpandType||this.state.toggleStatus?null:o.default.createElement("div",{onClick:this.clickShow.bind(this,this.state.noticeExpandType),className:"click_show"},"点击展开"),1!==this.state.noticeExpandType&&2!==this.state.noticeExpandType||!this.state.toggleStatus?null:o.default.createElement("div",{onClick:this.clickHide.bind(this,this.state.noticeExpandType),className:"click_show"},"点击收起"))),o.default.createElement(p.Row,{className:"push_btn"},o.default.createElement(p.Col,{span:"14"},this.props.groupPush?null:o.default.createElement(K,{label:""},o.default.createElement(p.Button,{type:"primary",onClick:this.handleSubmit,size:"large"},"推送")))),this.props.groupPush?o.default.createElement(p.Row,null,o.default.createElement(p.Col,null,o.default.createElement(L.default,{submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.pushType,groupPush:this.props.groupPush,groupType:this.props.groupType,form:this.props.form,setTableData:this.props.setTableData,handleSubmit:this.handleSubmit,addPushData:this.props.addPushData,requestData:this.state.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.state.pushReviewNumber,popoverVisible:this.state.popoverVisible}))):null,o.default.createElement(C.default,{form:this.props.form,requestData:this.state.requestData,noticeImgUrl:this.state.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl"),visible:this.state.visible,userGroupName:$||this.state.userGroupName,userGroupDesc:H||this.state.userGroupDesc,handleOk:this.handleOk,cronWeek:this.state.cronWeek,blackList:this.state.blackList,noticeExpandContent:window._noticeExpandContent,appName:this.state.appName,submiting:this.state.submiting,msgCache:this.state.msgCache,msgCacheStatus:this.state.msgCacheStatus,type:this.props.pushType,handleCancel:this.handleCancel,distinctTitle:this.state.distinctTitle,pushReviewNumber:this.state.pushReviewNumber}))}});Y=p.Form.create()(Y),e.exports=Y},898:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(783),n=r.default.createClass({displayName:"Info",getContainer:function(){return document.getElementById("detailTable")},render:function(){var e=this,t=[{text:"短信内容",title:"单条短信长度为70字，超过70字后，按67字/条分隔成多条计费"},{text:"短信推送手机号白名单",title:"开启白名单后，短信推送的手机号推送功能目标用户将不过滤应用订阅关系"},{text:"目标数",title:"计划推送的目标数"},{text:"sms有效数",title:"从目标数中筛选订阅状态等其他信息后剩下的有效目标数"},{text:"发送数",title:"发送的短信量"},{text:"成功数",title:"运营商回馈成功发送完成的数量"},{text:"计费条数",title:"按短信字数，统计全部短信的具体计费条数"},{text:"日增用户数",title:"当天首次订阅应用的设备数"},{text:"在线峰值用户数",title:"订阅该应用的设备中，当天同时在线的数量峰值"},{text:"日联网用户数",title:"订阅该应用的设备中，当天有联网行为的设备数总和"},{text:"累计注册用户数",title:"历史累积订阅该应用的设备数，已卸载应用不计入累计用户数中"},{text:"联网数",title:"联网并且与通道形成长链接的设备数"},{text:"到达应用数",title:"PushSDK将消息发送给应用的数量（Flyme6中，通知栏消息由pushSDK弹出，此埋点仍保留有上报数据）"},{text:"划掉数",title:"在通知栏中划掉消息的数量。透传消息不统计该项"},{text:"已卸载数",title:"本次推送任务中应用已被卸载的数量，数据上将出现接收数大于展示数。（Flyme6固件此应用会被反订阅，在重新订阅前下次推送任务将不朝它推送；Flyme6以下固件应用没有被反订阅）"},{text:"有效数",title:"从目标数中去除错误或无效的ID，实际有效的ID数量。筛选包括开关状态，订阅状态，pushId有效性以及其他可以推送状态"},{text:"推送数",title:"Push平台实际下发推送的数量"},{text:"接收数",title:"Push服务接收数，任务有效期内，联网并正常接收到推送消息的数量"},{text:"展示数",title:"客户端从Push服务收到消息，并在通知栏中展示的数量（3.0以下版本SDK，数据统计T+1，3.0以上实时统计。透传消息没有展示数统计）"},{text:"点击数",title:"用户点击消息的数量（3.0以下版本SDK，数据统计T+1，3.0以上实时统计。透传消息没有点击数统计）"},{text:"收纳数",title:"通知栏消息被收进收纳盒的数量。（覆盖2017年5月份后发布的Flyme6固件用户）"},{text:"不展示数",title:"用户设置“不允许通知”的数量，消息不会展示在通知栏上。（覆盖2017年5月份后发布的Flyme6固件用户）"},{text:"App ID",title:"应用的唯一标识，客户端订阅推送时使用"},{text:"App Key",title:"客户端身份标识，客户端订阅推送时使用"},{text:"App Secret",title:"服务端身份标识，服务端 SDK 初始化使用"},{text:"点击动作",title:"调起包名不是必填项，如不填，则参数传给本应用"},{text:"推送黑名单",title:"选择黑名单后，本次推送将不会朝这批用户推送"},{text:"通知聚合",title:"通知分类用来控制多条通知在通知栏内的替换关系。同类通知之间新的替换旧的，不同类通知之间并存而不替换。最多可以有10000类通知并存。默认不填则多条通知可以并存。（此功能需要pushSDK版本更新至V3.5.0以上）"},{text:"定速推送",title:"开启定速推送后，此任务的推送速率将按设置的速率推送。速率不会超过应用最大推送速率"},{text:"定时展示",title:"开启定时展示后，目标用户的展示量将平摊到时间段内"},{text:"任务定制",title:"设置好循环推送的周期后，会在规定的时间点进行推送"},{text:"回执地址",title:"回执地址设置第三方接收消息回执的Http接口, 最大长度128字节，用于获取推送明细，Token用于回执接口鉴权"},{text:"标题",title:"标题的内容会展示在应用图标下方，具体展示效果请预推测试"},{text:"小图标",title:"小图标会出现在标题前面，占用部分的展示面积。可选择默认的图标类型，也可自定义上传，自定义图标的大小为24*24"},{text:"推送量",title:"周期内的推送总量，包括通知栏推送与透传推送"},{text:"消息收纳率",title:"计算公式：收纳数/（展示数-不展示数）"},{text:"消息划掉率",title:"计算公式：划掉数/（展示数-不展示数）"},{text:"推送有效率",title:"计算公式：有效数/目标数"},{text:"消息接收率",title:"计算公式：接收数/推送数"},{text:"功能转化率",title:"统计个性化推送、图片推送的转化率。衡量高级推送功能与普通常规推送的对比。计算公式：点击数/（展示数-不展示数）"},{text:"点击转化率",title:"周期内的点击率，仅统计通知栏推送方式的点击数据，计算公式：点击数/（展示数-不展示数），仅统计推送数大于1万的数据"},{text:"消息去重",title:"分组推送内的消息去重可能会出现子任务的推送用户量少于目标用户量的情况"},{text:"每天推送限制",title:"本应用一天可创建的taskId总量，仅包含平台创建，不包含API"},{text:"透传总量限制",title:"本应用一天可推送的透传消息总量，包含平台与API"},{text:"允许推送其他包名",title:"开启后，允许本应用带上第三方应用包名，点击通知栏后调起第三方应用"},{text:"总Task创建数量限制（次/天）",title:"本应用API可以创建的非调度taskId总量"},{text:"应用推送消息总量（条/天）",title:"本应用可推送的消息总量，包含通知栏、透传、平台任务，API接口调用等所有方式"},{text:"绿色通道",title:"开启绿色通道后，本应用的推送将不会被收进收纳盒内"},{text:"任务备注",title:"任务备注用于标记推送任务的业务类型与备注信息，方便后续推送数据的整理归类"}],a=t.map(function(t){var a=e.props.type,i=e.props.text;return i=a?a+i:i,0===i.indexOf(t.text)?t.title:""});return r.default.createElement("span",{className:"info_wrap"},r.default.createElement(l.Tooltip,{getTooltipContainer:this.getContainer,title:a},r.default.createElement("i",{className:"fs14 color999 fw_n cursor_p anticon anticon-info-circle-o"})),this.props.text)}});e.exports=n},899:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=o.Radio.Group,u=o.Form.Item,d=n.default.createClass({displayName:"ValidateTime",getInitialState:function(){return{show:!0}},validateTime:function(e){var t=this;return this.props.getFieldProps(e,{initialValue:t.props.form.getFieldValue("validTime")||"24",rules:[{validator:function(a,i,r){return(i=String(i))?i&&i.match(/^\s/)?void r(new Error("行首不能输入空格")):(i&&(!i.match(/^\d+$/)||i>72)&&t.props.form.setFieldsValue(s({},e,72)),void(i&&(!i.match(/^\d+$/)||i<1)?t.props.form.setFieldsValue(s({},e,1)):r())):void r(new Error("请输入有效时长"))}}]})},render:function(){return n.default.createElement("div",null,n.default.createElement(u,r({},this.props.formItemLayout,{label:"是否离线    "}),n.default.createElement(p,this.props.getFieldProps("offLine",{initialValue:this.props.form.getFieldValue("offLine")}),n.default.createElement(o.Radio,{name:"offLine",value:1},"是"),n.default.createElement(o.Radio,{name:"offLine",value:0},"否"))),this.props.form.getFieldValue("offLine")?n.default.createElement(u,r({
className:"valid_time",extra:"  小时"},this.props.formItemLayout,{label:"有效时长    "}),n.default.createElement(o.Input,r({type:"number",min:1,max:72,style:{width:200}},this.validateTime("validTime")))):null)}});e.exports=d},900:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(777),u=i(p),d=o.Button.Group,c=o.Radio.Group,m=o.Form.Item,f=new Date,h={labelCol:{span:4},wrapperCol:{span:17}};window._cronWeeks=[1];var g=n.default.createClass({displayName:"ValidateTime",getInitialState:function(){return{cronWeek:[1],cronWeek1:!1}},onChange:function(e){this.props.onChangePushTime(e)},selectCronWeek:function(e){var t=this.state.cronWeek;if(1===t.length&&t[0]===e)return void o.message.error("推送周期不能为空");var a=t.filter(function(t){return t!==e});a.length===t.length?t.push(e):t=a,t.sort(),window._cronWeeks=t,this.setState(s({cronWeek:t},"cronWeek"+e,!this.state["cronWeek"+e])),this.props.selectCronWeek(t)},componentWillUnmount:function(){this.props.jumpUserGroup||(window._cronWeeks=[1])},selectCronTime:function(){},componentDidMount:function(){var e=u.default.queryString("pushType",window.location.href);if("timing"===e){var t=window._cronWeeks;this.props.selectCronWeek&&this.props.selectCronWeek(t);var a=new Date,i={dateNow:a,cronWeek:t};t.map(function(e){i["cronWeek"+e]=!0}),this.setState(i)}},onSelect:function(){},render:function(){var e=this,t=window.location.href,a=t.split("#"),i=u.default.queryString("pushType",a[1]),s=function(e){return e&&e.getTime()+864e5<=Date.now()},l=["一","二","三","四","五","六","日"],p=l.map(function(t,a){var i=a+1;return n.default.createElement(o.Button,{key:a,onClick:function(){return e.selectCronWeek(i)},type:e.state["cronWeek"+i]?"primary":""},t)}),g=this.state.dateNow,y="timing"===i?n.default.createElement(m,r({},h,{label:"任务定制    "}),n.default.createElement(m,r({className:"timing_push radio_btn time_push_checkbox"},this.props.formItemLayout,{label:"推送周期    "}),n.default.createElement(d,null,p)),n.default.createElement(m,r({style:{paddingTop:10},className:"timing_push"},this.props.formItemLayout,{label:"推送时间    "}),n.default.createElement(o.TimePicker,r({},this.props.getFieldProps("cronTime",{initialValue:g,onChange:this.selectCronTime,validate:[{rules:[{required:!0,type:"date",message:"请选择时间"}],trigger:["onBlur","onChange"]}]}),{placeholder:"选择时间",size:"large"})))):n.default.createElement(m,r({},this.props.formItemLayout,{label:"推送时间    "}),n.default.createElement(c,r({onChange:this.onChange},this.props.getFieldProps("pushTimeType",{initialValue:this.props.pushTimeType,onChange:this.props.changeRadio})),n.default.createElement(o.Radio,{name:"pushTimeType",value:0},"即时"),n.default.createElement(o.Radio,{name:"pushTimeType",value:1},"定时")),1===this.props.pushTimeType?n.default.createElement(m,{className:"display_ib mg0"},n.default.createElement(o.DatePicker,r({disabledDate:s},this.props.getFieldProps("startTime",{initialValue:f,onChange:this.onChange,validate:[{rules:[{required:!0,type:"date",message:"请输入推送时间"},{validator:function(e,t,a){var i=+new Date,s=+new Date(t);t&&i-s>0?a("推送时间不能早于当前时间"):a()}}],trigger:["onBlur","onChange"]}]}),{showTime:!0,format:"yyyy-MM-dd HH:mm:ss"}))):null);return y}});g=o.Form.create()(g),e.exports=g},901:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(777),u=i(p),d=a(776),c=i(d),m=a(785),f=i(m),h=a(898),g=i(h),y=a(800),v=i(y),I=o.Radio.Group,T=o.Form.Item,b=v.default.createActions(["clickType"]),E={labelCol:{span:4},wrapperCol:{span:20}},w=v.default.createStore({listenables:[b],clickTypeParamsApp:[1],clickTypeParamsAppPage:[1]});window.parametersJson={};var k="",S="",x="",P=n.default.createClass({displayName:"ClickType",getInitialState:function(){return{keyTplValue:[],paramsApp:!1,paramsAppPage:!1}},mixins:[v.default.listenTo(w,"showAppPage")],addParams:function(e,t){var a;if(this.addremove=!0,this.state["clickTypeParams"+t]&&10===this.state["clickTypeParams"+t].length)return void o.message.error("最多允许设置10个参数和值");var i=this.state["clickTypeParams"+t]||[1],r=i[i.length-1]+1;i.push(r),this.setState((a={},s(a,"clickTypeParams"+t,i),s(a,"params"+t,!0),a)),this.props.clickTypeParams(i,t)},removeParam:function(e,t){var a;if(this.addremove=!0,!this.state["clickTypeParams"+t]||this.state["clickTypeParams"+t]&&1===this.state["clickTypeParams"+t].length)return void o.message.error("最后一条不能删除");this.state["clickTypeParams"+t]&&2===this.state["clickTypeParams"+t].length&&this.setState(s({},"params"+t,!1));var i=this.state["clickTypeParams"+t]||[1];delete window.parametersJson["key"+t+i[e-1]],delete window.parametersJson["value"+t+i[e-1]],this.props.form.setFieldsValue((a={},s(a,"key"+t+i[e-1],""),s(a,"value"+t+i[e-1],""),a)),i.splice(e-1,1),this.setState(s({},"clickTypeParams"+t,i)),this.props.clickTypeParams(i,t)},validateTemplateName:function(e){var t=this,a=this.props.form.getFieldProps;return a(e,{validate:[{rules:[{required:!0,message:"请输入模板名称"},{max:20,message:"模板名称不能超过20个字符"},{validator:function(e,t,a){t&&t.length<=20&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){t.setState({templateName:e.target.value})}})},validateActivity:function(e){var t=this.props.form.getFieldProps;return t(e,{initialValue:k,validate:[{rules:[{required:!0,message:"请输入地址"},{max:1e3,message:"应用页面不能超过1000个字符"},{validator:function(e,t,a){t&&t.length<=1e3&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){k=e.target.value}})},showAppPage:function(){var e=this,t=this,a=this.props.clickType,i=this.props.form.getFieldProps,l="App";1===a&&(l="AppPage");var p=[],u=1,d=s({},l,[]);if(!this.addremove)for(var c in window.parametersJson)c.indexOf("AppPage")>-1?c.indexOf("key")>-1&&"AppPage"===l&&d.AppPage.push(u++):c.indexOf("key")>-1&&"App"===l&&d.App.push(u++);for(var m=d[l].length?d[l]:this.state["clickTypeParams"+l]||[1],f=m.length,h=this.state["params"+l],g=h?"":"disable",y=function(a){var u;p.push(n.default.createElement(o.Row,(u={className:"mt25"},s(u,"className","click_type_keyvalue"),s(u,"key",m[a]),u),n.default.createElement(o.Col,{span:"5"},n.default.createElement(T,null,n.default.createElement(o.Input,r({placeholder:"输入参数"},i("key"+l+m[a],{initialValue:window.parametersJson["key"+l+m[a]]||e.props.form.getFieldValue("key"+l+m[a]),validate:[{rules:[{validator:function(e,i,s){var r=t.props.form.validateFields;if(!i&&t.props.form.getFieldValue("value"+l+m[a])&&s("请输入参数"),i&&!t.props.form.getFieldValue("value"+l+m[a]))return void r(["value"+l+m[a]],{force:!0});if(i)for(var n=0;n<f;n++)if(i===t.props.form.getFieldValue("key"+l+m[n])&&a!==n)return void s("参数不能同名");s()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){var i=t.props.form.validateFields,r=e.target.value;window.parametersJson["key"+l+m[a]]=r.trim(),i(["value"+l+m[a]],{force:!0}),t.props.form.setFieldsValue(s({},"key"+l+m[a],r.trim()))}}))))),n.default.createElement(o.Col,{className:"ml20 col",span:"5"},n.default.createElement(T,null,n.default.createElement(o.Input,r({placeholder:"输入值"},i("value"+l+m[a],{initialValue:window.parametersJson["value"+l+m[a]]||e.props.form.getFieldValue("value"+l+m[a]),validate:[{rules:[{validator:function(e,i,s){var r=t.props.form.validateFields;if(0!==i&&!i&&t.props.form.getFieldValue("key"+l+m[a])&&s("请输入值"),i)for(var n=0;n<f;n++)t.props.form.getFieldValue("key"+l+m[a])===t.props.form.getFieldValue("key"+l+m[n])&&a!==n?r(["key"+l+m[a]],{force:!0}):s();i&&!t.props.form.getFieldValue("key"+l+m[a])&&r(["key"+l+m[a]],{force:!0}),s()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){var i=t.props.form.validateFields,r=e.target.value;window.parametersJson["value"+l+m[a]]=r.trim(),i(["key"+l+m[a]],{force:!0}),t.props.form.setFieldsValue(s({},"value"+l+m[a],r.trim()))}}))))),n.default.createElement(o.Col,{className:"ml20",span:"5"},n.default.createElement(o.Button,{id:"minus"+(a+1)+l,onClick:e.removeParam.bind(e,a+1,l),className:"minus_btn "+g},"—"))))},v=0;v<f;v++)y(v);var I=this.state["keyTplId"+a],b=I||0===I,w=b?"编辑参数模板":"存为参数模板";return 1===a||0===a?n.default.createElement("div",{className:"mt10"},1===a?n.default.createElement(T,null,n.default.createElement(o.Input,r({type:"textarea",style:{width:400},placeholder:"输入完整的应用页面地址，如com.meizu.pushdemo.TestActivity"},this.validateActivity("activity")))):null,p,n.default.createElement(o.Row,null,n.default.createElement(o.Col,{span:"5"},n.default.createElement(o.Button,{size:"large",className:"color_bdc",style:{width:"100%"},type:"ghost",onClick:this.addParams.bind(this,f,l)},"添加参数")),n.default.createElement(o.Col,{className:"ml20",span:"5"},n.default.createElement(o.Button,{size:"large",className:"color_bdc",style:{width:"100%"},type:"ghost",onClick:this.saveTpl.bind(this,b)},w),this.state.visible?n.default.createElement(o.Modal,{width:700,onCancel:this.handleCancel,onOk:this.handleOk,title:"保存模板",visible:this.state.visible},n.default.createElement(T,r({className:"key_template_modal"},E,{label:"模板名称"}),n.default.createElement(o.Input,r({style:{width:400},placeholder:"输入模板名称"},this.validateTemplateName("templateName"))),this.getTemplateInfo())):null)),n.default.createElement(o.Row,{className:"pt10 "},n.default.createElement(o.Col,{span:"6"},n.default.createElement("a",{onClick:this.getKeyTpl,href:"javascript:;"},"使用参数模板")),n.default.createElement(o.Col,{span:"18"},this.state["currentTemplateName"+a]&&n.default.createElement("span",null,this.state["currentTemplateName"+a],n.default.createElement("a",{className:"pl10",href:"javascript:;",onClick:this.clearTemplate},"清空 ")))),this.state.keyTplStatus?n.default.createElement(o.Row,null,n.default.createElement(o.Col,null,this.createTpl(this.state.keyTplValue))):null):null},clearTemplate:function(){var e,t=this.props.clickType,a="App";1===t&&(a="AppPage");var i=(e={},s(e,"keyTplId"+t,null),s(e,"currentTemplateName"+t,null),s(e,"clickTypeParams"+a,[1]),s(e,"parameters"+a,{}),s(e,"key"+a+1,""),s(e,"value"+a+1,""),s(e,"currentChecked"+t,null),e),r=/App\d/,l=/AppPage\d/;for(var n in window.parametersJson)("App"===a&&n.match(r)||"AppPage"===a&&n.match(l))&&delete window.parametersJson[n];this.setState(i),this.props.form.setFieldsValue(i)},getTemplateInfo:function(){var e=this.props.clickType,t=this.getParameters(),a=[];if(1==e){var i=this.props.form.getFieldValue("activity");a.push(n.default.createElement("div",{className:"break_word",key:"app_page_url_"+i},"应用页面地址：",i))}for(var s in t)"undefined"!=s&&""!=s&&a.push(n.default.createElement("div",{key:s},n.default.createElement("p",null,"参数：",s.trim()),n.default.createElement("p",{className:"break_word"},"值：",String(t[s]).trim())));return n.default.createElement(T,r({},E,{label:"模板参数    "}),n.default.createElement("div",{style:{marginTop:7}},a))},getParameters:function(){var e=this.props.clickType,t={};for(var a in window.parametersJson)if(a.indexOf("key")>-1&&(e&&a.length>10||!e&&a.length<10)){var i=a.replace("key","value");t[window.parametersJson[a]]=window.parametersJson[i]}return t},handleOk:function(){var e=u.default.queryString("appId",window.location.href),t=c.default.cptSaveOrUpdate,a=this.props.clickType,i=this.getParameters(),s=this,r={clickType:a,parameters:i};1===a&&(r.activity=this.props.form.getFieldValue("activity"));var l="模板新增成功",n=this.state["keyTplId"+a],p=this.state.templateName,d={appId:e,templateName:p,clickTypeInfoParam:JSON.stringify(r)};(n||0===n)&&(d.id=n,l="模板修改成功"),f.default.post(t,d,function(e){o.message.success(l),s.getKeyTpl("refresh");var t={visible:!1},i=e.value.id;t["currentChecked"+a]=i,t["currentTemplateName"+a]=p,t["keyTplId"+a]=i,s.setState(t),s.props.from.setFieldsValue(t),s.addremove=!1})},handleCancel:function(){this.setState({visible:!1})},saveTpl:function(e){var t=this,a=this.props.clickType;this.props.form.validateFields(function(i){for(var s in i)if("activity"===s||s.indexOf("keyApp")>-1)return;t.props.form.setFieldsValue({templateName:t.state["currentTemplateName"+a]}),t.setState({tplStatus:e,visible:!0})})},createTpl:function(e){var t=this,a=this.props.clickType,i=[{title:"推送时间",key:"0",className:"ta_l",dataIndex:"templateName",render:function(e,i){return n.default.createElement(o.Radio,{checked:i.id===t.state["currentChecked"+a]?!t.state.templateChecked:t.state.templateChecked,onChange:function(){t.setState(s({templateChecked:t.state.templateChecked},"currentChecked"+a,i.id));var e={target:{value:i.id,query:i.clickTypeInfoParam,templateName:i.templateName}};t.setKeyTpl(e)},name:"template"},i.templateName)}},{title:"推送时间",key:"1",className:"ta_c",dataIndex:"",render:function(e,a){return n.default.createElement(o.Tooltip,{title:"删除参数模板"},n.default.createElement("i",{onClick:function(){return t.delKeyTpl(a)},className:"i_del"}))}}],r=[];e.map(function(e){a===e.clickTypeInfoParam.clickType&&r.push(e)});var l=n.default.createElement("div",{className:"user_type"},r.length>0?n.default.createElement(T,null,n.default.createElement("div",{className:"key_tpl_table"},n.default.createElement(o.Table,{pagination:!1,columns:i,dataSource:r}))):this.state.loadTpl?n.default.createElement("div",null,"数据拉取中..."):n.default.createElement("div",{className:"color_error"},"无参数模板"));return l},setKeyTpl:function(e){var t,a=e.status;if(!a){var i=e.target.query,r="App",l=i.parameters,n=i.clickType,o=e.target.value,p=(t={},s(t,"keyTplId"+n,o),s(t,"currentChecked"+n,o),s(t,"clickType",n),s(t,"templateName",e.target.templateName),s(t,"currentTemplateName"+n,e.target.templateName),t);n&&(r="AppPage",p.activity=i.activity,k=i.activity);var u=/App\d/,d=/AppPage\d/;for(var c in window.parametersJson)("App"===r&&c.match(u)||"AppPage"===r&&c.match(d))&&delete window.parametersJson[c];var m=[],f=0;for(var h in l)f++,p["key"+r+f]=h,p["value"+r+f]=l[h],window.parametersJson["key"+r+f]=h,window.parametersJson["value"+r+f]=l[h],m.push(f);p["parameters"+r]=l,p["clickTypeParams"+r]=m,p["params"+r]=!0,f<2&&(p["params"+r]=!1),0===Object.keys(l).length&&(p["clickTypeParams"+r]=[1],p["key"+r+1]="",p["value"+r+1]=""),this.props.form.setFieldsValue(p),this.setState(p)}},delOk:function(){var e=this,t=this.state.delData,a=c.default.cptDel;a=u.default.makeUrl(a,{appId:t.appId,id:t.id});var i=this.props.clickType;f.default.get(a,function(){o.message.success("删除成功");var a={delVisible:!1};t.id===e.state["keyTplId"+i]&&(e.props.form.setFieldsValue(s({},"keyTplId"+i,null)),a["currentTemplateName"+i]="",a["keyTplId"+i]=null),e.setState(a),e.getKeyTpl("refresh")})},delCancel:function(){this.setState({delVisible:!1})},delKeyTpl:function(e){this.setState({delData:e,delVisible:!0})},componentWillUnmount:function(){},componentWillReceiveProps:function(){if(!this.addremove){var e="App";1===this.props.clickType&&(e="AppPage");var t=this.props.form.getFieldValue("parameters"+e),a=[],i=[],r=0;for(var l in t)a.push(r++ +1),i.push(l);this.setState(s({},"clickTypeParams"+e,0===a.length?[1]:a))}},componentWillMount:function(){var e=u.default.queryString("deal",window.location.href);e&&!this.props.addPush||(window.parametersJson={},k="",S="",x="")},componentDidMount:function(){},vidatePackageName:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{max:100,message:"包名不能超过100个字"},{validator:function(e,t,a){t=t&&t.trim(),t&&""===t||t&&!t.match(/^[a-zA-Z][\w_]*(\.[a-zA-Z][\w_]*)+$/)?a(new Error("请输入包名的正确格式，比如：com.flyme.sms")):a()}}],trigger:["onBlur","onChange"]}]})},changeRadio:function(e){this.props.changeRadio(e)},getKeyTpl:function(e){var t=this,a=u.default.queryString("appId",window.location.href);return"refresh"!==e&&this.state.keyTplStatus?void this.setState({keyTplStatus:!1}):(this.setState({loadTpl:!0}),void f.default.get(c.default.cptListByAppId+"?appId="+a,function(a){t.setState({loadTpl:!1,keyTplStatus:"refresh"===e||!t.state.keyTplStatus,keyTplValue:a.value})}))},render:function(){var e=u.default.queryString("pushType",window.location.href),t="点击动作　",a=this.props.pushOtherPackage&&"desktop"!==e?n.default.createElement(g.default,{text:t}):t;return n.default.createElement("div",null,n.default.createElement(T,r({},this.props.formItemLayout,{label:a}),this.props.pushOtherPackage&&"desktop"!==e?n.default.createElement(T,null,n.default.createElement(o.Input,r({placeholder:"请输入调起的应用包名",style:{width:200}},this.vidatePackageName("clickPackage")))):null,n.default.createElement(I,this.props.getFieldProps("clickType",{initialValue:this.props.clickType,onChange:this.changeRadio}),n.default.createElement(o.Radio,{name:"clickType",value:0},"打开应用"),n.default.createElement(o.Radio,{name:"clickType",value:1},"打开应用页面"),n.default.createElement(o.Radio,{name:"clickType",value:2},"打开URI页面"),"desktop"!==e&&n.default.createElement(o.Radio,{name:"clickType",value:3},"应用客户端自定义")),this.showAppPage(),2===this.props.clickType?n.default.createElement("div",{className:"mt10"},n.default.createElement(T,null,n.default.createElement(o.Input,r({type:"textarea",style:{width:400},placeholder:"输入URI"},this.props.getFieldProps("url",{initialValue:S,validate:[{rules:[{required:!0,message:"请输入URI"},{max:1e3,message:"URI不能超过1000个字符"}],trigger:["onBlur","onChange"]}],onBlur:function(e){S=e.target.value}}))))):null,3===this.props.clickType?n.default.createElement("div",{className:"mt10"},n.default.createElement(T,null,n.default.createElement(o.Input,r({type:"textarea",style:{width:400},placeholder:"自定义内容"},this.props.getFieldProps("customAttribute",{initialValue:x,validate:[{rules:[{required:!0,message:"请输入自定义内容"},{max:1e3,message:"内容不能超过1000个字符"},{validator:function(e,t,a){t&&t.length<=1e3&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){x=e.target.value}}))))):null),n.default.createElement(o.Modal,{title:"系统提示",visible:this.state.delVisible,onOk:this.delOk,onCancel:this.delCancel},n.default.createElement("p",null,"删除参数模板：",this.state.delData&&this.state.delData.templateName,"?")))}});t.render=P,t.clickTypeParamsApp=w.clickTypeParamsApp,t.clickTypeParamsAppPage=w.clickTypeParamsAppPage},902:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(776),u=i(p),d=a(777),c=i(d),m=a(785),f=i(m),h=o.Radio.Group,g=o.Form.Item,y={},v={},I=n.default.createClass({displayName:"UserType",getInitialState:function(){return{userTypeGroup:[],userTypeTags:[],tags:{},tagIds:{},visible:!1}},componentWillMount:function(){var e=location.href;e.indexOf("pushType=group")>-1&&(y={})},componentWillReceiveProps:function(){var e=this,t=c.default.queryString("appId",window.location.href),a=this.props.flymeAuth;if(this.props.appId&&t!==this.props.appId){this.getTags(t),this.getUserGroup(t);var i=this.props.userType;1!==i&&3!==i&&6!==i||!a||e.changeRadio({target:{name:"userType",value:2}})}},getTags:function(e){var t=this,a=u.default.appTag,i=this.props.tableDataIndex;a=c.default.makeUrl(a,{appId:e}),f.default.get(a,function(e){var a=e.value,s=a.length,r={},l={},n={};if(i){for(var o=i.userTypeInfo.tagIds||"",p=o.split(","),u=[],d=0;d<s;d++)for(var c=0;c<p.length;c++)a[d].tagId==p[c]&&(u.push(a[d].tagName),l[a[d].tagId]=!l[a[d].tagId],n[a[d].tagName]=!n[a[d].tagName]);u=u.join(","),r.tagIdsName=u,r.tagIdsValue=o}t.setState({userTypeTags:e.value,tags:n,tagIds:l,tagIdsName:r.tagIdsName||null,tagIdsValue:r.tagIdsValue||null}),t.props.form.setFieldsValue({tagIdsName:r.tagIdsName||null,tagIds:r.tagIdsValue||null})})},componentDidMount:function(){var e=c.default.queryString("appId",window.location.href),t=c.default.queryString("deal",window.location.href),a=c.default.queryString("groupId",window.location.href);if(this.setState({appId:e,pushType:c.default.queryString("pushType",window.location.href)}),(t||a||this.props.personalPush)&&this.getUserGroup(e),this.getTags(e),y={},v={},this.props.tableDataIndex)return void this.getUserGroup(e);var i=this.props.flymeAuth,s=void 0;i&&(s=6),(t||a)&&(s=1),s&&this.changeRadio({target:{name:"userType",value:s}})},getUserGroup:function(e){var t=this,a=u.default.listUserGroup;a=c.default.makeUrl(a,{appId:e}),f.default.get(a,function(e){t.setState({userTypeGroup:e.value.items,isDmp:e.value.isDmp,loadGroup:!0}),t.props.setUserTypeGroup(e.value)})},selectTags:function(e){var t=this.state.tags,a=this.state.tagIds,i=e.target.getAttribute("value"),s=e.target.getAttribute("title");t[s]=!t[s],a[i]=!a[i];var r=[],l=[];for(var n in t)t[n]&&r.push(n);for(var o in a)a[o]&&l.push(o);e.target.className=""===e.target.className?"current":"",this.setState({tags:t,tagIds:a,tagIdsName:r.join(","),tagIdsValue:l.join(",")}),this.props.form.setFieldsValue({tagIdsName:r.join(","),tagIds:l.join(",")}),this.props.changeRadio({target:{name:"tags"}})},delUserGroup:function(e,t){var a=this;this.setState({visible:!0,userGroupName:e,delIcon:!0,userGroupId:t});var i=a.props.form.getFieldValue("userGroupId");i!=t&&setTimeout(function(){a.props.form.setFieldsValue({userGroupId:i})},0)},delOk:function(){var e=this,t=c.default.queryString("appId",window.location.href),a=this,i=u.default.delUserGroup,s=this.state.userGroupId,r=this.props.form.getFieldValue("userGroupId");f.default.post(i,{id:this.state.userGroupId},function(){a.getUserGroup(t),o.message.success("用户群"+e.state.userGroupName+"删除成功"),a.props.clearUserGroup(r,s),a.setState({visible:!1,delIcon:!1})})},changeRadio:function(e){var t=c.default.queryString("appId",window.location.href),a=e.target.name,i=e.target.value;"userType"===a&&(this.setState(s({},"target"+i,this.props.form.getFieldValue("target"+i))),1===i&&this.getUserGroup(t)),this.props.changeRadio(e)},delCancel:function(){this.setState({visible:!1,delIcon:!1})},validate:function(e){var t=this,a=this.props.userType,i=this.props.tableDataIndex,s=null;return this.state["removed"+a]||this.props.userType!==(i&&i.userTypeInfo.userType)||(s=i.userFileName),this.props.getFieldProps(e,{onChange:function(){t.props.changeRadio({target:{name:"changeTarget"}})},initialValue:y["target"+a]||s,validate:[{rules:[{required:(a>1&&a<5||6===a||7===a)&&!this.state["targetRequired"+a],message:"不能为空"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){y["target"+a]=e.target.value}})},getUserType:function(){var e=this,t=this.props.userType,a=u.default.uploadUserFile,i=c.default.queryString("appId",window.location.href);a=c.default.makeUrl(a,{pushType:"notice"===this.props.type?0:1,userType:t,appId:i});var l=10;e.props.flymeAuth&&(l=50);var p=[],d=this.props.tableDataIndex,m=y["target"+t];!m&&d&&t==d.userTypeInfo.userType&&(m=d.userFileName);var f=!1;!this.state["removed"+t]&&(!this.props.clearUserFile||this.state.clearUserFile)&&m&&m.indexOf(".txt")>-1&&m.indexOf(".txt")===m.length-4&&(p=[{uid:-1,name:m,status:"done",url:""}],f=!0);var h={name:"userFile",data:{},accept:".txt",action:a,defaultFileList:p,beforeUpload:function(t){e.setState({loading:!0});var a=t.type;if(t.size>1048576*l)return o.message.error("文件大小不能超过"+l+"M"),e.setState({loading:!1}),!1;var i="text/plain"===a;return i||(o.message.error("请上传txt格式的文件"),e.setState({loading:!1})),i},headers:{authorization:"authorization-text"},onChange:function(t){var a=e.props.userType;if("removed"===t.file.status){if(e.setState({loading:!1}),t.fileList.length<1){var i,r;e.setState((i={},s(i,"targetDisabled"+a,!1),s(i,"removed"+a,!0),s(i,"targetRequired"+a,!1),i)),e.props.form.setFieldsValue((r={},s(r,"userFilePath"+a,void 0),s(r,"target"+a,void 0),r)),y["target"+a]=null}return void e.props.changeRadio({target:{name:"remove"}})}if("error"===t.file.status&&e.setState({loading:!1}),"done"===t.file.status)if(e.setState({loading:!1}),200==t.file.response.code){var l,n;t.fileList.length>1&&t.fileList.shift(),o.message.success(t.file.name+" 上传成功。"),e.props.form.setFieldsValue((l={},s(l,"userFilePath"+a,t.file.response.value.userFilePath),s(l,"target"+a,t.file.name),l)),v["userFilePath"+a]=t.file.response.value.userFilePath,y["target"+a]=t.file.name,e.setState((n={},s(n,"targetDisabled"+a,!0),s(n,"clearUserFile",!0),s(n,"targetRequired"+a,!0),n)),"group"===e.state.pushType&&e.props.changeRadio({target:{name:"upload"}})}else t.fileList.pop(),o.message.error(t.file.response.message),e.props.form.setFieldsValue({})}};return n.default.createElement("div",{className:"user_type"},n.default.createElement(g,null,n.default.createElement(o.Input,r({disabled:f||this.state["targetDisabled"+t],style:{width:300},placeholder:"多个以;分隔",className:"mb10"},this.validate("target"+t)))),n.default.createElement(o.Upload,r({},this.props.getFieldProps("userFilePath"+t,{initialValue:v["userFilePath"+t]}),{style:{width:200}},h),n.default.createElement(o.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"TXT文档批量导入",this.state.loading?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("span",{className:"upload_tips"},"最多不超过",l,"M，UTF-8无BOM格式编码文件，内容以回车键进行分割"))},handleSubmit:function(e,t){this.props.handleSubmit(e,"deal"),window.location.hash=t},changeUserGroupRadio:function(e){this.state.delIcon||this.props.changeRadio(e,"userGroupAuth")},getContainer:function(){return document.getElementById("userGropuList")},render:function(){var e=this,t={display:"block",height:30,position:"relative",lineHeight:1.5},a=c.default.queryString("appId",window.location.href),i=c.default.queryString("timingPushType",window.location.href),s="/user/group/new",l=this.state.userTypeGroup.map(function(r,l){var p=r.permission,u=r.id,d=r.name,m={appId:a,id:u,pushType:e.state.pushType};i&&(m.timingPushType=i);var f=c.default.makeUrl(s,m),h={display:"inline-block"};return h.color=p?"#666":"#f00",n.default.createElement(o.Radio,{permission:p,expression:r.userGroupDesc,label:d,key:l,style:t,name:"userGroupId",value:String(u)},n.default.createElement("div",{style:h},!p&&n.default.createElement(o.Tooltip,{getTooltipContainer:e.getContainer,title:"该用户群有标签无权限"},n.default.createElement("i",{className:"fs14  fw_n cursor_p anticon anticon-info-circle-o permission_info"})),n.default.createElement("span",{className:"ellipsis",style:{width:450,display:"inline-block",verticalAlign:"top"},title:d},d)),n.default.createElement("div",{style:{textAlign:"right",position:"absolute",right:"-10px",display:"inline-block"}},n.default.createElement(o.Tooltip,{title:"编辑用户群"},n.default.createElement("i",{onClick:e.handleSubmit.bind(e,window.event,f),className:"i_edit"})),n.default.createElement(o.Tooltip,{title:"删除用户群"},n.default.createElement("i",{onClick:e.delUserGroup.bind(e,d,u),className:"i_del"}))))}),p=this.state.userTypeTags.map(function(t,a){return n.default.createElement("li",{title:t.tagName,className:e.state.tagIds[t.tagId]?"current":"",value:t.tagId,onClick:e.selectTags,key:a},c.default.getTextOverFlow(t.tagName,10,!0))}),u=e.state.pushType,d={appId:a,currentId:this.props.form.getFieldValue("userGroupId"),pushType:u},m=this.props.groupPush;m&&(d.groupPush=m),i&&(d.timingPushType=i);var f=c.default.makeUrl(s,d),y=this.state.tagIdsName,v=this.state.tagIdsValue,I=this.props.userType,T=c.default.queryString("id",window.location.href)||c.default.queryString("groupId",window.location.href),b=this.props.smsPush;return n.default.createElement(g,r({},this.props.formItemLayout,{label:"指定用户    "}),n.default.createElement(h,this.props.getFieldProps("userType",{initialValue:I,onChange:this.changeRadio}),"group"===u?null:n.default.createElement(o.Radio,{name:"userType",value:0},"全部用户"),n.default.createElement(o.Radio,{name:"userType",value:1},"用户群"),this.props.personalPush||b?null:n.default.createElement(o.Radio,{name:"userType",value:2},n.default.createElement("span",null,"PushId")),b&&n.default.createElement(o.Radio,{name:"userType",value:7},n.default.createElement("span",null,"手机号")),this.props.personalPush||b?null:this.props.flymeAuth?n.default.createElement(o.Radio,{name:"userType",value:6},"IMEI"):null,this.props.personalPush||b||"group"===u?null:this.props.flymeAuth?n.default.createElement(o.Radio,{name:"userType",value:3},"Flyme账户"):null,this.props.personalPush||b?null:n.default.createElement(o.Radio,{name:"userType",value:4},"别名"),this.props.personalPush||b?null:n.default.createElement(o.Radio,{name:"userType",value:5},"标签")),1===I?n.default.createElement("div",{className:"user_type",id:"userGropuList"},l.length>0?n.default.createElement(g,null,n.default.createElement(h,r({value:this.props.form.getFieldValue("userGroupId"),className:"mb10",style:{width:"100%"}},this.props.getFieldProps("userGroupId",{initialValue:T,onChange:this.changeUserGroupRadio,validate:[{rules:[{required:!0,message:"请选择用户群"},{validator:function(e,t,a){"null"!==t&&"undefined"!==t||a(new Error("请选择用户群")),a()}}]}]})),l)):this.state.loadGroup?n.default.createElement("div",{className:"color_error"},"无用户群"):n.default.createElement("div",null,"数据拉取中..."),n.default.createElement(o.Button,{onClick:this.handleSubmit.bind(this,window.event,f),className:"color_bdc  ",type:"ghost",size:"large"},"添加群组")):null,2===I?this.getUserType():null,3===I?this.getUserType():null,4===I?this.getUserType():null,6===I?this.getUserType():null,7===I?this.getUserType():null,5===I?n.default.createElement("div",{className:"user_type",style:{width:600}},p.length>0?n.default.createElement("div",null,n.default.createElement(h,r({style:{width:"100%"}},this.props.getFieldProps("scope",{initialValue:this.props.scope,onChange:this.props.changeRadio})),n.default.createElement(o.Radio,{name:"scope",value:0},"并集"),n.default.createElement(o.Radio,{name:"scope",value:1},"交集")),n.default.createElement(g,null,n.default.createElement(o.Input,r({style:{width:300},disabled:!0,title:this.props.form.getFieldValue("tagIdsName"),placeholder:"选择标签"},this.props.getFieldProps("tagIdsName",{initialValue:y,rules:[{required:!0,message:"请选择标签"}]})))),n.default.createElement("div",{style:{display:"none "}},n.default.createElement(g,null,n.default.createElement(o.Input,r({hidden:!0,style:{width:300},placeholder:"选择标签"},this.props.getFieldProps("tagIds",{initialValue:v}))))),n.default.createElement("ul",{className:"tag_list"},p)):n.default.createElement("div",{className:"color_error"},"无标签")):null,n.default.createElement(o.Modal,{title:"系统提示",visible:e.state.visible,onOk:e.delOk,onCancel:e.delCancel},n.default.createElement("p",null,"删除用户群：",e.state.userGroupName,"?")))}});e.exports=I},903:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(898),u=i(p),d=a(777),c=i(d),m=o.Radio.Group,f=o.Form.Item,h=n.default.createClass({displayName:"AdvanceSetting",getInitialState:function(){return{display:"none",selectBlack:[],errorTips:"",startTimeStatus:"success",endTimeStatus:"success",noticeImgUrl:this.props.noticeImgUrl}},showAdvance:function(){this.props.showAdvance()},checkBoxChange:function(e){var t=e.target.checked,a=e.target.value;this.props.form.setFieldsValue(s({},a,t?1:0)),this.props.changeRadio(e);
},changeStart:function(e){this.props.form.setFieldsValue({fixStartDisplayTime:e})},changeEnd:function(e){this.props.form.setFieldsValue({fixEndDisplayTime:e})},validateStartTime:function(e){var t=this,a=this.props.tableDataIndex;return this.props.getFieldProps(e,{initialValue:a&&a.advanceInfo.fixStartDisplayTime?new Date(a.advanceInfo.fixStartDisplayTime):this.props.form.getFieldValue("startTime")||new Date,onChange:function(e){var a=+new Date(e),i=t.props.form.getFieldValue("fixEndDisplayTime"),s="none",r="",l="success",n="success";a&&i&&a>i&&(r="结束时间不能早于开始时间",l="error",n="error",s=""),a||(r="请选择开始时间",s="",l="error"),i||(r="请选择结束时间",s="",n="error"),t.setState({startTimeStatus:l,endTimeStatus:n,display:s,errorTips:r})}})},validateEndTime:function(e){var t=this,a=this.props.tableDataIndex;return this.props.getFieldProps(e,{initialValue:a&&a.advanceInfo.fixEndDisplayTime?new Date(a.advanceInfo.fixEndDisplayTime):this.props.form.getFieldValue("startTime")||new Date,onChange:function(e){var a=+new Date(e),i=t.props.form.getFieldValue("fixStartDisplayTime"),s="none",r="",l="success",n="success";i&&a&&a<i&&(r="结束时间不能早于开始时间",l="error",n="error",s=""),i||(r="请选择开始时间",s="",l="error"),a||(r="请选择结束时间",s="",n="error"),t.setState({startTimeStatus:l,endTimeStatus:n,display:s,errorTips:r})}})},validateNotifyKey:function(e){return this.props.getFieldProps(e,{validate:[{rules:[{validator:function(e,t,a){t&&!String(t).match(/^[1-9]+[0-9]*$/)||Number(t)>1e4?a(new Error("请输入1-10000之间的整数")):a()}}],trigger:["onBlur","onChange"]}]})},validateFixSpeedRate:function(e){var t=this,a=t.props.limitRate;return this.props.getFieldProps(e,{validate:[{rules:[{validator:function(e,t,i){t?t&&!String(t).match(/^[1-9]+[0-9]*$/)?i(new Error("请输入正整数")):t&&t>a?i(new Error("推送速率被设置为不能大于"+a)):i():i(new Error("请输入推送速率"))}}],trigger:["onBlur","onChange"]}]})},componentDidMount:function(){var e=this.props.tableDataIndex,t=[];e&&(t=e.advanceInfo.blackId,t=t.split(","),this.setState({selectBlack:t}))},changeBlack:function(e,t){var a=this,i=e.target.checked,s=this.state.selectBlack;i?s.push(e.target.name):s=s.filter(function(t){return t!==e.target.name});var r=this.props.blackList;r.map(function(l,n){if(a.props.form.getFieldValue("blackId"+l.blackId)&&i){var o=s.filter(function(e){return e===l.blackId});o.length||s.push(""+l.blackId)}n===t&&(r[n].choose=e.target.checked)}),this.props.changeBlack(r,t),this.setState({selectBlack:s})},changeRadioBlack:function(e){var t=this.state.selectBlack,a=void 0;1!==t.length||t[0]||(a="black"),this.props.changeRadio(e,a)},render:function(){var e=this,t=this.props.blackList,a=this.state.selectBlack,i=c.default.queryString("pushType",window.location.href),s=t.map(function(t,i){var s=t.choose;if(a.length){s=!1;for(var l=0;l<a.length;l++){var p=a[l];p===String(t.blackId)&&(s=!0)}}return n.default.createElement(f,{className:"mg0",key:i},n.default.createElement("label",null,n.default.createElement(o.Checkbox,r({data:t,name:String(t.blackId),title:t.blackName,checked:s},e.props.getFieldProps("blackId"+t.blackId,{initialValue:s,onChange:function(t){e.changeBlack(t,i)}}))),t.blackName,n.default.createElement("span",{title:t.title,className:"pl10"},"数量：",t.blackNum)))});t.length||(s=n.default.createElement("span",{className:"color_error "},"无黑名单"));var l=this.props.vibrate,p=this.props.sound,d=this.props.lights,h=function(t){var a=e.props.form.getFieldValue("startTime"),i=Date.now();return a&&(i=a),t&&t.getTime()+864e5<=i};return n.default.createElement("div",null,!this.props.personalPush&&n.default.createElement(f,r({className:"border_top advance_toggle"},this.props.formItemLayout,{label:"高级设置   "}),n.default.createElement(o.Icon,{onClick:this.showAdvance,style:{fontSize:12,paddingTop:13},type:this.props.showAdvanceStatus?"cross":"down"})),n.default.createElement("div",{style:{display:this.props.showAdvanceStatus?"":"none"}},!this.props.personalPush&&n.default.createElement(f,r({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(u.default,{text:"定速推送　"})}),n.default.createElement(m,this.props.getFieldProps("fixSpeed",{initialValue:this.props.fixSpeed,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"fixSpeed",value:0},"关闭"),n.default.createElement(o.Radio,{name:"fixSpeed",value:1},"开启")),1===this.props.fixSpeed||this.props.form.getFieldValue("fixSpeed")?n.default.createElement(f,{className:"fix_speed_rate"},n.default.createElement(o.Input,r({style:{width:100}},this.validateFixSpeedRate("fixSpeedRate"))),n.default.createElement("span",{className:"pl10"},"条/秒")):null),this.props.personalPush||"desktop"===i||"notice"!==this.props.type?null:n.default.createElement("div",null,"timing"!==i&&n.default.createElement(f,r({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(u.default,{text:"通知聚合　"})}),n.default.createElement(o.Input,r({style:{width:100}},this.validateNotifyKey("notifyKey")))),"timing"!==i&&n.default.createElement(f,r({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(u.default,{text:"定时展示　"})}),n.default.createElement(m,this.props.getFieldProps("fixDisplay",{initialValue:this.props.fixDisplay,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"fixDisplay",value:0},"关闭"),n.default.createElement(o.Radio,{name:"fixDisplay",value:1},"开启")),1===this.props.fixDisplay?n.default.createElement("div",null,n.default.createElement(f,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},n.default.createElement(o.DatePicker,r({disabledDate:h,onOk:this.changeStart,showTime:!0},this.validateStartTime("fixStartDisplayTime"),{placeholder:"开始时间",format:"yyyy-MM-dd HH:mm:ss"}))),n.default.createElement("span",{className:"pl10 pr10"},"至"),n.default.createElement(f,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},n.default.createElement(o.DatePicker,r({disabledDate:h},this.validateEndTime("fixEndDisplayTime"),{placeholder:"结束时间",onOk:this.changeEnd,showTime:!0,format:"yyyy-MM-dd HH:mm:ss"}))),n.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips)):null),this.props.msgCacheStatus?n.default.createElement(f,r({},this.props.formItemLayout,{label:"消息缓存    "}),n.default.createElement(m,this.props.getFieldProps("msgCache",{initialValue:this.props.msgCache,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"msgCache",value:0},"关闭"),n.default.createElement(o.Radio,{name:"msgCache",value:1},"开启"))):null,n.default.createElement(f,r({},this.props.formItemLayout,{label:"通知栏悬浮窗    "}),n.default.createElement(m,this.props.getFieldProps("suspend",{initialValue:this.props.suspend,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"suspend",value:1},"显示"),n.default.createElement(o.Radio,{name:"suspend",value:0},"不显示"))),n.default.createElement(f,r({},this.props.formItemLayout,{label:"清除通知栏    "}),n.default.createElement(m,this.props.getFieldProps("clearNoticeBar",{initialValue:this.props.clearNoticeBar,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"clearNoticeBar",value:1},"可清除"),n.default.createElement(o.Radio,{name:"clearNoticeBar",value:0},"不可清除"))),n.default.createElement(f,r({},this.props.formItemLayout,{label:"通知提醒类型    "}),n.default.createElement("label",{className:"mr10"},n.default.createElement(o.Checkbox,r({className:"mr10"},this.props.getFieldProps("vibrate",{value:l}),{value:"vibrate",onChange:this.checkBoxChange,checked:!!l})),"震动"),n.default.createElement("label",{className:"mr10"},n.default.createElement(o.Checkbox,r({className:"mr10"},this.props.getFieldProps("lights",{value:d}),{value:"lights",onChange:this.checkBoxChange,checked:!!d})),"闪灯"),n.default.createElement("label",null,n.default.createElement(o.Checkbox,r({className:"mr10"},this.props.getFieldProps("sound",{value:p}),{value:"sound",onChange:this.checkBoxChange,checked:!!p})),"声音"))),"sms"!==i&&n.default.createElement(f,r({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(u.default,{text:"推送黑名单　　"})}),n.default.createElement(m,this.props.getFieldProps("black",{initialValue:this.props.black,onChange:this.changeRadioBlack}),n.default.createElement(o.Radio,{name:"black",value:1},"使用"),n.default.createElement(o.Radio,{name:"black",value:0},"禁用"))),1===this.props.form.getFieldValue("black")&&n.default.createElement("div",{className:"user_type user_type_black"},s,n.default.createElement("span",{className:"color_error",style:{display:this.props.displayBlackList}},"请选择黑名单"))))}});e.exports=h},904:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=a(600),l=i(r),n=a(783),o=a(777),p=i(o),u=a(905),d=i(u),c=a(906),m=i(c),f={labelCol:{span:6},wrapperCol:{span:18}},h=l.default.createClass({displayName:"PushModal",getInitialState:function(){return{popoverVisible:!1}},componentDidMount:function(){document.querySelector("#prepush")&&(document.querySelector("#prepush").classList="prepush_position")},render:function(){var e=this.props.form.getFieldValue("startTime"),t=window.location.href,a=p.default.queryString("pushType",t),i=this.props.form.getFieldValue("noticeExpandType"),r="　";0===i&&(r="标准"),1===i&&(r=l.default.createElement("div",null,"文本",l.default.createElement("div",{className:"break_word lh15 mt5 mb5 pr40"},this.props.noticeExpandContent))),2===i&&(r=l.default.createElement("div",null,"大图",l.default.createElement("div",{className:"break_word lh15 mt5 mb5 pr40"},l.default.createElement("img",{width:"225",height:"144",src:window.bigImageFilePathJson&&window.bigImageFilePathJson.noticeExpandImgUrl||this.props.form.getFieldValue("noticeExpandImgUrl")})))),3===i&&(r="ACT文件");var o=this.props.form.getFieldValue("clickType"),u="　";0===o&&(u="打开应用"),1===o&&(u="打开应用页面"),2===o&&(u="打开URI页面"),3===o&&(u="应用客户端自定义");var c=this.props.form.getFieldValue("clickPackage"),h=this.props.form.getFieldValue("userType");2===h&&this.props.personalPush&&(h=6);var g="　";if(0===h&&(g="全部用户"),1===h){g="用户群";var y=this.props.userGroupName;y&&(g+="("+y+")")}2===h&&(g="PushId"),3===h&&(g="Flyme账户"),4===h&&(g="别名"),5===h&&(g="标签"),6===h&&(g="IMEI"),7===h&&(g="手机号");var v="　",I=[],T="";if(this.props.requestData){var b=this.props.requestData.advanceInfo.notificationType,E=this.props.requestData.clickTypeInfo,w={},k=[];for(var S in b)b[S]&&("vibrate"===S&&k.push("震动"),"lights"===S&&k.push("闪灯"),"sound"===S&&k.push("声音"));if(v=k.join("+"),0===k.length&&(v="无"),E){if(w=E.parameters,1==o||2==o||3==o){var x=E.activity||E.url||E.customAttribute||"";1===o&&(x="页面地址："+x),I.push(l.default.createElement("div",{className:"break_word",key:x},x))}if(2!=o&&3!=o)for(var P in w)"undefined"!=P&&""!=P&&I.push(l.default.createElement("div",{key:P},l.default.createElement("p",null,"参数：",P.trim()),l.default.createElement("p",{className:"break_word"},"值：",String(w[P]).trim())))}T=document.getElementById("userName").innerHTML}var N=[];this.props.distinctTitle&&(N=this.props.distinctTitle.map(function(e,t){return l.default.createElement("div",{key:t},e)}));var F=this.props.form.getFieldValue("fixStartDisplayTime"),D=this.props.form.getFieldValue("fixEndDisplayTime");F=F?p.default.dateFormat("yyyy-MM-dd hh:mm:ss",F):null,D=D?p.default.dateFormat("yyyy-MM-dd hh:mm:ss",D):null;var C=D&&F?F+" 至 "+D:"",V="notice"===this.props.type?"推送通知":"透传消息";"desktop"===a&&(V="桌面通知"),"sms"===a&&(V="短信通知");var R=this.props.listSceneTag,U=this.props.cronWeek,B=this.props.form.getFieldValue("cronTime");B&&"object"===("undefined"==typeof B?"undefined":s(B))&&(B=p.default.dateFormat("hh:mm:ss",B));var _={formItemLayout:f,appName:this.props.appName,noticeBarType:this.props.form.getFieldValue("noticeBarType"),noticeBarImgUrl:window.smallImageFilePathJson&&window.smallImageFilePathJson.noticeBarImgUrl||this.props.form.getFieldValue("noticeBarImgUrl"),title:this.props.form.getFieldValue("title"),content:this.props.form.getFieldValue("content")+(this.props.checkedTD?"回复【TD】退订":""),smsType:"1"===this.props.form.getFieldValue("smsType")?"营销短信":"普通短信",remark:this.props.form.getFieldValue("remark"),noticeExpandTypeText:r,clickTypeText:u,clickPackage:c,startTime:e,offLine:this.props.form.getFieldValue("offLine"),validTime:this.props.form.getFieldValue("validTime"),userTypeText:g,listSceneTag:R,algoTypeName:this.props.algoTypeName,distinct:this.props.form.getFieldValue("distinct"),fixSpeed:this.props.form.getFieldValue("fixSpeed"),fixSpeedRate:this.props.form.getFieldValue("fixSpeedRate"),notifyKey:this.props.form.getFieldValue("notifyKey"),fixDisplay:this.props.form.getFieldValue("fixDisplay"),fixDisplayTime:C,msgCache:this.props.form.getFieldValue("msgCache"),msgCacheStatus:this.props.msgCacheStatus,suspend:this.props.form.getFieldValue("suspend"),clearNoticeBar:this.props.form.getFieldValue("clearNoticeBar"),notificationTypeText:v,noticeImgUrl:this.props.noticeImgUrl,pushType:"notice"===this.props.type?0:1,clickTypeInfoText:I,userName:T,articleLength:this.props.form.getFieldValue("articleLength"),freshnessNew:this.props.form.getFieldValue("freshnessNew"),distinctTitle:N,tagIdsName:this.props.form.getFieldValue("tagIdsName"),userGroupDesc:1===h?this.props.userGroupDesc:null,scopeDesc:0==this.props.form.getFieldValue("scope")?"并集":"交集",black:this.props.form.getFieldValue("black"),blackList:this.props.blackList,cronTime:B,cronWeek:U,listMaterial:this.props.listMaterial,pushPercent:this.props.pushPercent,iconType:this.props.form.getFieldValue("iconType"),icon:this.props.form.getFieldValue("icon"),iconUrl:this.props.form.getFieldValue("iconUrl")},A=l.default.createElement(m.default,{smsPush:this.props.smsPush,submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.type,personalPush:this.props.personalPush,requestData:this.props.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.props.pushReviewNumber,popoverVisible:this.state.popoverVisible});return l.default.createElement(n.Modal,{footer:A,width:700,onCancel:this.props.handleCancel,title:V,visible:this.props.visible},l.default.createElement(d.default,{pushDetailData:_,personalPush:this.props.personalPush}))}});e.exports=h},906:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=a(600),l=i(r),n=a(783),o=a(776),p=i(o),u=a(777),d=i(u),c=a(785),m=i(c),f=l.default.createClass({displayName:"Distinct",getInitialState:function(){var e=window.location.href,t=e.split("#"),a=d.default.queryString("pushType",t[1]);return{pushType:a,values:null,popoverVisible:!1}},handleSave:function(){var e=this.state.pushType,t=this;if(this.props.visible)return"timing"===e?void this.props.handleOk():void this.props.handleSubmit(null,"group",function(e){t.props.setTableData(e)})},handleVisibleChange:function(e){if(this.props.batch&&!this.props.groups.length)return n.message.error("请选择推送内容进行预推");var t=this;this.props.groupPush?this.props.handleSubmit(null,"group",function(a){var i=t.props.addPushData;a.pushTimeInfo=i.pushTimeInfo,a.userTypeInfo=i.userTypeInfo,t.setState({values:a,popoverVisible:e})}):t.setState({popoverVisible:e})},pushReview:function(){var e=this,t=d.default.queryString("appId",window.location.href),a=this.state.pushType,i=this.props.batch,s=document.querySelector("#pushId"+this.props.type).value,r=this.props.requestData,l=this.props.smsPush,o="notice"===this.props.type?0:1;s=s.replace(/^\s+/,"").replace(/\s+$/,"");var u=p.default.pushReview;if(i){var c=this.props.groups,f=c.length;r.map(function(e){e.pushId=s});var h=[];if(r.map(function(e){for(var t=0;t<f;t++)e.id==c[t]&&h.push(e)}),r=h,u=p.default.batchPushReview,!r.length)return n.message.error("请选择推送内容进行预推")}else l?(r.pushReviewPhone=s,u=p.default.pushReviewSms):r.pushId=s;if(!s)return n.message.error("请输入PushId");var g={};1!==o||l||(g={appId:t,pushId:r.pushId,title:r.title,content:r.content,pushTimeInfo:{offLine:r.pushTimeInfo.offLine,validTime:r.pushTimeInfo.validTime}},r=g),"desktop"===a&&(o=3);var y={pushType:o,appId:t,json:JSON.stringify(r)};m.default.post(u,y,function(t){i?e.props.batchError(t):n.message.success("预推成功")})},render:function(){var e,t,a,i=this.state.pushType,r=this.props.smsPush,o=r?"输入手机号（预推计入费用清单）":"输入PushId",p=l.default.createElement("div",null,l.default.createElement(n.Row,{style:{height:36,lineHeight:"33px"}},l.default.createElement(n.Col,{className:" fs16",span:"5"},"预推测试"),l.default.createElement(n.Col,{span:"14"},l.default.createElement(n.Input,{style:{width:235},id:"pushId"+this.props.type,placeholder:o})),l.default.createElement(n.Col,{span:"5"},l.default.createElement(n.Button,{className:"w_80",type:"primary",onClick:this.pushReview,size:"large"},"预推")))),u=this.props.batch;return l.default.createElement("div",{style:{textAlign:"center"},className:u?"fr":""},this.props.groupPush||this.props.personalPush||u?null:l.default.createElement("p",{key:"p",className:"push_review_num"},"预计推送人数",l.default.createElement("span",{className:"num"},this.props.pushReviewNumber)),this.props.personalPush?null:l.default.createElement(n.Popover,(e={overlayClassName:u?"":"prepush_position",key:"popover",placement:u?"bottomRight":"topRight"},s(e,"key","test"),s(e,"content",p),s(e,"trigger","click"),s(e,"visible",this.state.popoverVisible),s(e,"onVisibleChange",this.handleVisibleChange),e),l.default.createElement(n.Button,{type:"ghost",className:"color_bdc",size:"large"},"预推测试")),u?null:this.props.groupPush||"timing"===i?l.default.createElement(n.Button,(t={key:"button"},s(t,"key","submit"),s(t,"type","primary"),s(t,"size","large"),s(t,"style",{marginLeft:8}),s(t,"onClick",this.handleSave),t),"保存",this.props.submiting?l.default.createElement(n.Icon,{type:"loading"}):l.default.createElement("span",null)):l.default.createElement(n.Button,(a={key:"button"},s(a,"key","submit"),s(a,"type","primary"),s(a,"size","large"),s(a,"style",{marginLeft:8}),s(a,"onClick",this.props.handleOk),a),"推送",this.props.submiting?l.default.createElement(n.Icon,{type:"loading"}):l.default.createElement("span",null)))}});e.exports=f},907:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),l=i(r),n=a(783),o=a(898),p=i(o),u=a(776),d=i(u),c=a(777),m=i(c),f=a(785),h=i(f),g=n.Radio.Group,y=n.Form.Item,v=l.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},changeRadio:function(e){var t=e.target.value;1===t?(this.listEffectivePushTask(),this.setState({displayDistinct:""})):this.setState({distinctId:{},listData:[]}),this.props.changeRadio(e)},changeCheckbox:function(e){var t=this.state.distinctId,a=this.props.form.getFieldsValue();for(var i in a)if(i.indexOf("distinctId")>-1){var s=i.split("distinctId")[1],r=a[i];t[s]=!!r}var l=e.target.checked,n=e.target.name;t[n]=!!l;var o=this.getNewDistinct(t);this.setState({distinctId:t,displayDistinct:o.newDistinctId.length>0?"none":""}),this.props.changeCheckbox(o.newDistinctId,o.newDistinctTitle)},componentWillReceiveProps:function(){var e=m.default.queryString("deal",window.location.href),t=m.default.queryString("appId",window.location.href);(this.props.appId&&t!==this.props.appId||e&&1===this.props.distinct&&t===this.props.appId)&&this.listEffectivePushTask()},componentDidMount:function(){var e=this,t=this.props.copyTaskId,a="";t&&this.listEffectivePushTask(t,function(t){for(var i={},s=[],r=0;r<t.length;r++)if(t[r].choose){var l=t[r].id;i["distinctId"+l]=l,i.displayDistinct="none",s.push(l)}e.props.form.setFieldsValue(i),e.props.changeCheckbox(s,a)})},listEffectivePushTask:function(e,t){var a=m.default.queryString("appId",window.location.href),i=this,s=d.default.listEffectivePushTask,r={appId:a,pushType:"notice"===this.props.pushType?0:1};e&&(r.copyTaskId=e),s=m.default.makeUrl(s,r),h.default.get(s,function(e){var a=e.value,s=[],r=[];a.map(function(e){e.choose?s.push(e):r.push(e)});var l=s.concat(r);i.setState({listData:l,loaded:!0}),t&&t(a)})},getNewDistinct:function(e){var t=this.state.listData,a=[],i=[];for(var s in e)if(e[s]){a.push(s);for(var r in t)s==t[r].id&&i.push(s+"  "+t[r].title)}return{newDistinctId:a,newDistinctTitle:i}},Select:function(e,t){var a={},i=!0,s=this.props.form.getFieldsValue(),r={};for(var l in s)if(l.indexOf("distinctId")>-1){var n=l.split("distinctId")[1];"invert"===t&&(i=!s[l]),r[l]=i,a[n]=!!i}var o=this.getNewDistinct(a);this.setState({distinctId:a,displayDistinct:o.newDistinctId.length>0?"none":""}),this.props.changeCheckbox(o.newDistinctId,o.newDistinctTitle),this.props.form.setFieldsValue(r)},render:function(){var e=this,t=this,a=this.state.listData,i=0===a.length&&this.state.loaded,r=a.map(function(e,a){var i=t.props.form.getFieldValue("distinctId"+e.id);return l.default.createElement(y,{className:"mg0",key:a},l.default.createElement("label",null,l.default.createElement(n.Checkbox,s({name:String(e.id),title:e.title,checked:!!i},t.props.getFieldProps("distinctId"+e.id,{onChange:t.changeCheckbox}))),e.id,l.default.createElement("span",{title:e.title,className:"distinct_title pl10"},e.title),l.default.createElement("span",{className:"cursor_p"},e.time)))});i&&(r=l.default.createElement("span",{className:"color_error"},"无去重列表 "));var o=this.props.pushType,u="消息去重",d="group"===o?l.default.createElement(p.default,{text:u}):l.default.createElement("span",{className:"info_wrap"},u);return l.default.createElement(y,s({className:"label_form_item"},this.props.formItemLayout,{label:d}),l.default.createElement(y,null,l.default.createElement(g,this.props.getFieldProps("distinct",{initialValue:this.props.distinct,onChange:this.changeRadio}),l.default.createElement(n.Radio,{name:"distinct",value:0},"无"),l.default.createElement(n.Radio,{name:"distinct",value:1},"去重"))),1===this.props.distinct?l.default.createElement("div",null,!i&&l.default.createElement("div",{className:"mb10"},l.default.createElement(n.Button,{onClick:function(t){return e.Select(t,"all")},className:" cursor_p fs14"},"全选"),l.default.createElement(n.Button,{onClick:function(t){return e.Select(t,"invert")},className:"ml10 cursor_p fs14"},"反选"),l.default.createElement("span",{className:"pl10 color_error",style:{display:this.state.displayDistinct||this.props.displayDistinct}},"请选择去重任务")),l.default.createElement("div",{className:"user_type user_type_distinct "},r)):null)}});e.exports=v},908:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),l=i(r),n=a(783),o=a(777),p=i(o),u=a(909),d=i(u),c=n.Radio.Group,m=n.Form.Item;window._noticeExpandContent="";var f=l.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},componentWillMount:function(){var e=p.default.queryString("deal",window.location.href);e&&!this.props.addPush||(window._noticeExpandContent="")},validateNoticeExpandContent:function(e){var t=this.props.form.getFieldProps;return t(e,{initialValue:window._noticeExpandContent,validate:[{rules:[{required:!0,message:"请输入展开文本"},{max:100,message:"展开文本不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){window._noticeExpandContent=e.target.value}})},render:function(){var e=this.props.formItemLayout,t=this.props.form.getFieldProps;return l.default.createElement("div",null,l.default.createElement(m,s({},e,{label:"展开方式    "}),l.default.createElement(c,t("noticeExpandType",{initialValue:this.props.form.getFieldValue("noticeExpandType"),onChange:this.props.changeRadio}),l.default.createElement(n.Radio,{name:"noticeExpandType",value:0},"标准"),0===this.props.noticeBarType||2===this.props.noticeBarType?l.default.createElement(n.Radio,{name:"noticeExpandType",value:1},"文本"):null,l.default.createElement(n.Radio,{name:"noticeExpandType",value:2},"大图"),!this.props.flymeAuth||0!==this.props.noticeBarType&&2!==this.props.noticeBarType?null:l.default.createElement(n.Radio,{name:"noticeExpandType",value:3},"ACT文件")),l.default.createElement(d.default,{type:"noticeExpandType",form:this.props.form,bigImageDisplay:this.props.bigImageDisplay,url:"noticeExpandImgUrl",value:2}),l.default.createElement(d.default,{type:"noticeExpandType",form:this.props.form,vedioDisplay:this.props.vedioDisplay,url:"vedioUrl",value:3})),1!==this.props.form.getFieldValue("noticeExpandType")||0!==this.props.form.getFieldValue("noticeBarType")&&2!==this.props.form.getFieldValue("noticeBarType")?null:l.default.createElement(m,s({},e,{label:" "}),l.default.createElement(n.Input,s({placeholder:"请输入展开文本",style:{width:400}},this.validateNoticeExpandContent("noticeExpandContent"),{type:"textarea"}))))}});e.exports=f},909:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(776),u=i(p),d=a(777),c=i(d),m=o.Radio.Group,f=o.Form.Item,h={labelCol:{span:4},wrapperCol:{span:20}},g=n.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},uploadParam:function(e){var t=this,a="imgFile",i="noticeBarImgUrl"===e?0:1,r="noticeBarImgUrl"===e?"smallImage":"bigImage",l="noticeBarImgUrl"===e?100:200,n="图片",p=r+"Display",d=u.default.uploadImg,m=!1,f=".jpg,.jpeg,.png,.bmp";"vedioUrl"===e&&(r="vedio",a=r+"File",p=r+"Display",d=u.default.uploadVedio,l=1024,n="视频",m=!0,f=".act");var h={appId:c.default.queryString("appId",window.location.href)};"vedioUrl"!==e&&(h.imgType=i),d=c.default.makeUrl(d,h);var g={name:a,data:{},accept:f,action:d,showUploadList:m,beforeUpload:function(a){var i={};i[e+"loading"]=!0;var s=a.name,r=s.split(".");if(r=r[r.length-1],a.size>1024*l)return l="vedioUrl"===e?"1M":l+"K",o.message.error(n+"大小不能超过"+l),t.setState({loading:!1}),!1;var p="vedioUrl"===e?r.indexOf("act")>=0:r.indexOf("jpg")>=0||r.indexOf("jpeg")>=0||r.indexOf("png")>=0||r.indexOf("bmp")>=0;return p||(o.message.error("请上传"+f+"后缀格式的文件"),i[e+"loading"]=!1),t.setState(i),p},onChange:function(a){if("removed"===a.file.status)return void(a.fileList.length<1&&(t.props.form.setFieldsValue({vedioUrl:void 0}),window[r+"FilePathJson"]={}));if(a.file.response){var i={};"200"===a.file.response.code?(a.fileList.length>1&&a.fileList.shift(),i[e]="vedioUrl"===e?a.file.response.value:a.file.response.value.imgUrl,o.message.success(a.file.name+" 上传成功。"),t.props.form.setFieldsValue(i),t.setState(s({vedioDisplay:"none",layerDisplay:"none"},p,"none"))):(a.fileList.pop(),o.message.error(a.file.response.message)),i[e+"loading"]=!1,window[r+"FilePathJson"]=i,t.setState(i)}}},y=window[r+"FilePathJson"][e]||this.props.form.getFieldValue(e);if("vedioUrl"===e&&y){var v=y.split("/");v=v[v.length-1],g.defaultFileList=[{name:v,url:"javascript:;",uid:-1,status:"done"}]}return g},closeImg:function(e,t){var a={};a[e]=null,a[t+"layerDisplay"]="none",this.props.form.setFieldsValue(a);var i="noticeBarImgUrl"===e?"smallImage":"bigImage";"vedioUrl"===e&&(i="vedio"),window[i+"FilePathJson"][e]=null,this.setState(a)},imgOver:function(e){var t={};t[e+"layerDisplay"]="",this.setState(t)},componentDidMount:function(){window.vedioFilePathJson={}},eventPre:function(e){e.stopPropagation()},imgOut:function(e){var t={};t[e+"layerDisplay"]="none",this.setState(t)},uploadVedio:function(){var e="vedioUrl",t=this.props.form.getFieldProps;return 3===this.props.form.getFieldValue("noticeExpandType")?n.default.createElement("div",{className:"user_type notice_expand"},n.default.createElement(o.Upload,r({},t("vedioUrl",{initialValue:window.vedioFilePathJson[e]}),{style:{width:200}},this.uploadParam(e)),n.default.createElement(o.Button,{size:"large",className:"btn_normal_show ",type:"ghost"},"ACT文件上传",this.state.loading?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("span",{className:"upload_tips vedio_upload_tips"},"请上传1M以内的ACT文件",n.default.createElement("span",{style:{display:this.state.vedioDisplay||this.props.vedioDisplay},className:"pl10 color_error"},"请上传ACT文件")),n.default.createElement(f,r({},h,{label:"下载条件    "}),n.default.createElement(m,t("onlyWifi",{initialValue:this.props.form.getFieldValue("onlyWifi")?1:0}),n.default.createElement(o.Radio,{name:"noticeBarType",value:1},"仅WIFI"),n.default.createElement(o.Radio,{name:"noticeBarType",value:0},"不限")))):null},render:function(){var e=this.props.url,t=this.props.type,a=this.props.value,i="noticeBarImgUrl"===e?"smallImage":"bigImage";"vedioUrl"===e&&(i="vedio");var s={size:"small",height:70,uploadDom:n.default.createElement("div",{className:"upload_area"},n.default.createElement(o.Upload,this.uploadParam(e),n.default.createElement(o.Button,{type:"primary",size:"large"},"添加图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("p",{className:"tips"},"推荐尺寸525*100，100KB以内",n.default.createElement("span",{style:{display:this.props.smallImageDisplay},className:"pl10 color_error"},"请上传图片")))};2===a&&(s.size="big",s.height=182,s.uploadDom=n.default.createElement("div",{className:"upload_area upload_area_big"},n.default.createElement(o.Upload,this.uploadParam(e),n.default.createElement(o.Button,{type:"primary",size:"large"},"添加图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null)),n.default.createElement("p",{style:{display:this.props.bigImageDisplay},className:"pl10 color_error"},"请上传图片")),n.default.createElement("p",null,"Flyme5推荐尺寸700*400，200KB以内"),n.default.createElement("p",null,"Flyme6推荐尺寸262*95，200KB以内")));var l=this.props.form.getFieldValue(t)===a?n.default.createElement("div",null,n.default.createElement(f,null,n.default.createElement("div",{className:"upload_img"},n.default.createElement("div",{className:""},window[i+"FilePathJson"][e]||this.props.form.getFieldValue(e)?n.default.createElement("div",{className:s.size+"_img"},n.default.createElement("img",{onMouseOver:this.imgOver.bind(this,s.size),width:"300",height:s.height,src:window[i+"FilePathJson"][e]||this.props.form.getFieldValue(e)}),n.default.createElement("div",{onMouseOver:this.eventPre,onMouseOut:this.imgOut.bind(this,s.size),style:{display:this.state[s.size+"layerDisplay"]},className:"close_img"},n.default.createElement(o.Upload,r({className:s.size+"_img_btn"},this.uploadParam(e)),n.default.createElement(o.Button,{onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,s.size),type:"primary",size:"large"},"更换图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("div",{className:"close_icon",onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,s.size)},n.default.createElement(o.Icon,{onClick:this.closeImg.bind(this,e,s.size),type:"cross-circle"})))):s.uploadDom)))):null;return"noticeExpandType"===t&&3===a&&(l=this.uploadVedio()),l}});g=o.Form.create()(g),e.exports=g},910:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){
var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),n=i(l),o=a(783),p=a(776),u=i(p),d=a(777),c=i(d),m=o.Radio.Group,f=o.Form.Item,h=n.default.createClass({displayName:"SmallIcon",getInitialState:function(){return{}},uploadParam:function(e){var t=this,a="imgFile",i="iconImage",r=10,l="图片",n=i+"Display",p=u.default.uploadImg,d=!1,m=".jpg,.jpeg,.png,.bmp",f={appId:c.default.queryString("appId",window.location.href),imgType:3};p=c.default.makeUrl(p,f);var h={name:a,data:{},accept:m,action:p,showUploadList:d,beforeUpload:function(a){var i={};i[e+"loading"]=!0;var s=a.name,n=s.split(".");if(n=n[n.length-1],a.size>1024*r)return r+="K",o.message.error(l+"大小不能超过"+r),t.setState({loading:!1}),!1;var p=n.indexOf("jpg")>=0||n.indexOf("jpeg")>=0||n.indexOf("png")>=0||n.indexOf("bmp")>=0;return p||(o.message.error("请上传"+m+"后缀格式的文件"),i[e+"loading"]=!1),t.setState(i),p},onChange:function(a){if("removed"===a.file.status)return void(a.fileList.length<1&&(window[i+"FilePathJson"]={}));if(a.file.response){var r={};"200"===a.file.response.code?(a.fileList.length>1&&a.fileList.shift(),r[e]=a.file.response.value.imgUrl,o.message.success(a.file.name+" 上传成功。"),t.props.form.setFieldsValue(r),t.setState(s({layerDisplay:"none"},n,"none"))):(a.fileList.pop(),o.message.error(a.file.response.message)),r[e+"loading"]=!1,window[i+"FilePathJson"]=r,t.setState(r)}}};return h},closeImg:function(e,t){var a={};a[e]=null,a[t+"layerDisplay"]="none",this.props.form.setFieldsValue(a);var i="iconImage";window[i+"FilePathJson"][e]=null,this.setState(a)},imgOver:function(e){var t={};t[e+"layerDisplay"]="",this.setState(t)},componentDidMount:function(){setTimeout(function(){for(var e=1;e<6;e++)!function(e){var t=new Image;t.onload=function(){},t.src=c.default.cdn+"/resources/push/images/push_icon"+e+".png"}(e)},1e3)},eventPre:function(e){e.stopPropagation()},imgOut:function(e){var t={};t[e+"layerDisplay"]="none",this.setState(t)},onChangeIcon:function(e){this.props.onChangeIcon(e)},changeRadio:function(e){var t=e.target.value;window._smallIconValue=t},render:function(){for(var e=this.props.form.getFieldProps,t=this.props.url,a=this.props.type,i=this.props.value,s="iconImage",l=[],p=1;p<6;p++)l.push("push_icon"+p);var u=l.map(function(e,t){return n.default.createElement(o.Radio,{key:t,name:"icon",value:e},n.default.createElement("img",{className:"cursor_p va_m",src:c.default.cdn+"/resources/push/images/"+e+".png"}))}),d=null;if(0===i)return d;if(1===i)return n.default.createElement(f,null,n.default.createElement("div",{className:"upload_area ta_l",style:{width:400}},n.default.createElement(m,e("icon",{initialValue:this.props.form.getFieldValue("icon")||window._smallIconValue,onChange:this.changeRadio}),u)));d={size:"small",height:70,uploadDom:n.default.createElement("div",{className:"upload_area"},n.default.createElement(o.Upload,this.uploadParam(t),n.default.createElement(o.Button,{type:"primary",size:"large"},"上传图标",this.state[t+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("p",{className:"tips"},"尺寸24*24，10KB以内",n.default.createElement("span",{style:{display:this.props.iconImageDisplay},className:"pl10 color_error"},"请上传图片")))};var h=this.props.form.getFieldValue(a)===i?n.default.createElement("div",null,n.default.createElement(f,null,n.default.createElement("div",{className:"upload_img"},n.default.createElement("div",{className:""},window[s+"FilePathJson"][t]||this.props.form.getFieldValue(t)?n.default.createElement("div",{className:d.size+"_img"},n.default.createElement("div",{style:{width:300,height:d.height,textAlign:"center",lineHeight:d.height+"px"},onMouseOver:this.imgOver.bind(this,d.size)},n.default.createElement("img",{width:"24",height:"24",src:window[s+"FilePathJson"][t]||this.props.form.getFieldValue(t)})),n.default.createElement("div",{onMouseOver:this.eventPre,onMouseOut:this.imgOut.bind(this,d.size),style:{display:this.state[d.size+"layerDisplay"]},className:"close_img"},n.default.createElement(o.Upload,r({className:d.size+"_img_btn"},this.uploadParam(t)),n.default.createElement(o.Button,{onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,d.size),type:"primary",size:"large"},"更换图标",this.state[t+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("div",{className:"close_icon",onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,d.size)},n.default.createElement(o.Icon,{onClick:this.closeImg.bind(this,t,d.size),type:"cross-circle"})))):d.uploadDom)))):null;return h}});h=o.Form.create()(h),e.exports=h},911:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(783),n=a(777),o=i(n),p=a(912),u=i(p),d=a(913),c=i(d),m=r.default.createClass({displayName:"Distinct",getInitialState:function(){return{}},componentDidMount:function(){},render:function(){var e=o.default.queryString("pushType",window.location.href);return"desktop"===e?r.default.createElement("div",{className:"example_push",style:{padding:"51px 0 0 8px"}},r.default.createElement("div",{className:"desktop"}),r.default.createElement("div",{style:{background:"#fff",textAlign:"center",position:"absolute",width:70,color:"#999",fontSize:"16px",left:190,top:550}},"预览")):r.default.createElement("div",{className:"example_push"},0===this.props.noticeBarType||2===this.props.noticeBarType?r.default.createElement("div",{className:"con bdr_bottom"},r.default.createElement("div",{className:"pt10 bdr_top "},r.default.createElement(l.Row,{style:{zIndex:2}},r.default.createElement(l.Col,{className:"ta_r",span:"4"},r.default.createElement("img",{width:"26",height:"26",src:this.props.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl")||o.default.cdn+"/resources/push/images/default_icon.png"})),r.default.createElement(l.Col,{span:"20",className:"notice_text pl10"},r.default.createElement("div",{className:"notice_title"},this.props.form.getFieldValue("title")||"此处显示标题文字"),this.props.noticeExpandContent?r.default.createElement("div",{className:"notice_content notice_expand_content"},this.props.form.getFieldValue("noticeExpandContent")||window._noticeExpandContent||"此处为内容说明文字显示一行文字说明"):r.default.createElement("div",{className:"notice_content"},this.props.form.getFieldValue("content")||"此处为内容说明文字显示一行文字说明"))),2===this.props.noticeExpandType?r.default.createElement("div",{style:{position:"relative",top:-43,zIndex:1}},this.props.showBigImg?r.default.createElement("div",{style:{background:"#000",opacity:.5,position:"absolute",top:0,height:40,zIndex:11,width:"100%"}}):null,r.default.createElement(u.default,{noticeExpandImgUrl:this.props.noticeExpandImgUrl,showBigImg:this.props.showBigImg,form:this.props.form})):null)):null,1===this.props.noticeBarType?r.default.createElement("div",{className:"con bdr_bottom"},r.default.createElement("div",{className:"pt10 bdr_top "},2===this.props.noticeExpandType?r.default.createElement("div",null,this.props.toggleStatus?r.default.createElement(u.default,{noticeExpandImgUrl:this.props.noticeExpandImgUrl,showBigImg:this.props.showBigImg,form:this.props.form}):r.default.createElement(c.default,{form:this.props.form})):r.default.createElement(l.Row,null,r.default.createElement(l.Col,{span:"24"},r.default.createElement(c.default,{form:this.props.form}))))):null)}});e.exports=m},912:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(783),n=r.default.createClass({displayName:"BigimgArea",render:function(){var e=this.props.form.getFieldValue("noticeExpandImgUrl");return r.default.createElement(l.Row,null,r.default.createElement(l.Col,null,this.props.showBigImg?r.default.createElement("div",null,e?r.default.createElement("div",{className:"example_default_image example_big_image"},r.default.createElement("img",{width:"225",height:"144",src:e})):r.default.createElement("div",{className:"example_default_image example_big_image"},r.default.createElement("div",{className:"bg"}),r.default.createElement("div",{className:"text"},"此处为图片展示区域"))):null))}});e.exports=n},913:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(783),n=r.default.createClass({displayName:"BigimgArea",render:function(){return r.default.createElement(l.Row,null,r.default.createElement(l.Col,null,r.default.createElement("div",null,this.props.form.getFieldValue("noticeBarImgUrl")?r.default.createElement("div",{className:"example_default_image"},r.default.createElement("img",{width:"225",height:"44",src:this.props.form.getFieldValue("noticeBarImgUrl")})):r.default.createElement("div",{className:"example_default_image"},r.default.createElement("div",{className:"bg"}),r.default.createElement("div",{className:"text"},"此处为图片展示区域")))))}});e.exports=n},914:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=a(600),n=i(l),o=a(783),p=a(799),u=i(p),d=a(898),c=i(d),m=a(776),f=i(m),h=a(785),g=i(h),y=a(777),v=i(y),I=a(899),T=i(I),b=a(900),E=i(b),w=a(902),k=i(w),S=a(903),x=i(S),P=a(904),N=i(P),F=a(907),D=i(F),C=a(906),V=i(C),R=a(800),U=i(R),B=o.Form.Item,_=null,A=null,G=U.default.createActions(["message"]),O=U.default.createStore({listenables:[G],jsonData:null}),q={labelCol:{span:4},wrapperCol:{span:20}},L=n.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{offLine:1,cronWeek:[1],distinctId:[],displayDistinct:"none",displayBlackList:"none",noticeBarType:0,noticeExpandType:0,clickType:0,userType:2,scope:0,visible:!1,pushReviewNumber:"...",distinct:0,blackList:[],fixSpeed:0,netType:0,fixDisplay:0,pushTimeType:0,distinctTitle:[]}},delParams:function(e,t){for(var a in t)delete e[a]},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,_=null,A=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},changeRadio:function(e,t){var a={};"userGroupAuth"===t&&(a.permission=e.target.permission),"black"===t&&(a.displayBlackList="");var i=e.target.name,s=e.target.value;a[i]=s,"userGroupId"===i&&(a.userGroupName=e.target.label,a.userGroupDesc=e.target.expression,_=e.target.label,A=e.target.expression),"distinct"==i&&0==s&&(a.distinctTitle=[],a.distinctId=[]),this.setState(a),this.props.form.setFieldsValue(a)},getAppName:function(e){var t="全部应用",a=u.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=v.default.queryString("appId",window.location.href);this.state.appId&&e!==this.state.appId&&(this.getAppName(e),this.setState({pushReviewNumber:"...",appId:e}),this.getAppInfo(),this.getBlackList())},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeBlack:function(e){var t={blackList:e},a=e.filter(function(e){return e.choose});a.length?t.displayBlackList="none":t.displayBlackList="",this.setState(t)},handleOk:function(){var e=this,t=window.location.href,a=t.split("#"),i=v.default.queryString("pushType",a[1]),s=v.default.queryString("appId",window.location.href),r={appId:s,json:JSON.stringify(this.state.requestData)},l=this.state.pushReviewNumber;if("0"===l)return void o.message.error("预计推送人数为0，不可以创建推送任务");if(!this.state.submiting){this.setState({submiting:!0});var n=f.default.addNews,p="/data/push/record?appId="+s;"timing"===i&&(n=f.default.cronTaskAddNews,p="/data/push/timing?appId="+s),g.default.post(n,r,function(){o.message.success("提交成功"),window.location.hash=p},function(){e.setState({submiting:!1})})}},selectCronWeek:function(e){this.setState({cronWeek:e})},handleSubmit:function(e,a,i){var s=this,l=this;"deal"===a&&this.setState({jumpUserGroup:!0});var n=window.location.href,p=n.split("#"),u=v.default.queryString("pushType",p[1]);return this.state.permission===!1&&"deal"!==a&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId")?void o.message.error("用户群标签没权限"):void this.props.form.validateFields(function(e,n){var o=n.userType;if("deal"===a)return n.showAdvanceStatus=l.state.showAdvanceStatus,O.jsonData=n,n.distinctId=l.state.distinctId,n.distinctTitle=l.state.distinctTitle,void(t.jsonData=n);var p=l.state.distinctId;if(n.distinct&&0===p.length)return void l.setState({displayDistinct:""});for(var d in n)d.indexOf("distinctId")>-1&&delete n[d];if(p&&(n.distinctId=p.join(",")),!n.distinct||p){var c=[];for(var m in n)if(m.indexOf("blackId")>-1&&n[m]){var h=m.split("blackId")[1];c.push(h),delete n[m]}if(n.blackId=c.join(","),(5!==n.userType||n.tagIds)&&(1!==o||n.userGroupId&&"null"!==n.userGroupId)){if(n.target=n["target"+o],n.userFilePath=n["userFilePath"+o],delete n["userFilePath"+o],""===n.target&&delete n.target,n.userFilePath&&delete n.target,e)return void console.log("Errors in form!!!");if(n.content=n.content,n.pushTimeInfo={pushTimeType:n.pushTimeType,startTime:n.startTime&&v.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.startTime),offLine:n.offLine,validTime:n.validTime},l.delParams(n,n.pushTimeInfo),n.groupPushScope=n.scope,n.userGroupName=l.state.userGroupName,n.userTypeInfo={userType:n.userType,userGroupId:n.userGroupId,target:n.target,tagIds:n.tagIds,scope:n.scope,userFilePath:n.userFilePath},l.delParams(n,n.userTypeInfo),"timing"===u){var y=n.cronTime;"object"===("undefined"==typeof y?"undefined":r(y))&&(y=v.default.dateFormat("hh:mm:ss",y));var I=s.state.cronWeek;n.cronTimeInfo={time:y,week:I.join(",")},delete n.cronTime,l.delParams(n,n.cronTimeInfo)}if(n.advanceInfo={distinct:n.distinct,distinctId:n.distinctId,fixSpeed:n.fixSpeed,blackId:n.blackId,black:n.black,fixSpeedRate:n.fixSpeedRate},l.delParams(n,n.advanceInfo),n.advanceInfo.black&&""===n.advanceInfo.blackId)return void l.setState({showAdvanceStatus:!0});var T="notice"===l.props.pushType?0:1,b=v.default.queryString("appId",window.location.href);n.appId=b,l.setState({requestData:n,visible:"group"!==a});var E={appId:b,userTypeInfo:n.userTypeInfo},w=f.default.getPushCount;w=v.default.makeUrl(w,{appId:b,pushType:T,json:JSON.stringify(E)}),l.setState({pushReviewNumber:"..."}),"group"!==a&&g.default.get(w,function(e){l.setState({pushReviewNumber:e.value})},null,{timeout:3e5}),i&&"function"==typeof i&&i(n)}}})},handleCancel:function(){this.setState({visible:!1,submiting:!1})},componentWillMount:function(){var e=this,t=v.default.queryString("appId",window.location.href),a=v.default.queryString("deal",window.location.href),i=v.default.queryString("id",window.location.href),s=v.default.queryString("groupId",window.location.href);(a||s)&&this.setState({userType:1,userGroupId:i}),t&&e.props.form.setFieldsValue({appId:t})},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},validateRemark:function(e){var t=this.props.form.getFieldProps,a=100;return t(e,{validate:[{rules:[{required:!1},{max:a,message:"任务备注不能超过"+a+"个字"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},validateTitle:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"请输入标题"},{max:32,message:"标题内容不能超过32个字"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}]})},validateContent:function(e){var t=this.props.form.getFieldProps,a=2e3;return t(e,{validate:[{rules:[{required:!0,message:"请输入消息内容"},{max:a,message:"消息内容不能超过"+a+"个字"},{validator:function(e,t,i){if(t&&t.length<=a){try{JSON.parse(t)}catch(e){i(new Error("请输入JSON格式"))}Number(t)==t&&"number"==typeof Number(t)&&i(new Error("请输入JSON格式"))}t&&t.length<=a&&t.match(/^\s/)&&i(new Error("行首不能输入空格")),i()}}],trigger:["onBlur","onChange"]}]})},selectType:function(e,t){this.setState({appName:t,appId:e}),this.props.form.setFieldsValue({appId:String(e)});var a=window.location.hash,i=v.default.getQueryObj(a);i.appId=e;var s=a.split("?")[0],r=v.default.makeUrl(s,i);window.location.href=window.location.pathname+r},getAppInfo:function(){var e=this,t=v.default.queryString("appId",window.location.href);g.default.get(f.default.getAppInfo+"?appId="+t,function(t){e.props.form.setFieldsValue({noticeImgUrl:t.value.appIconUrl,appName:t.value.appName}),e.setState({loadAppInfo:!0,flymeAuth:t.value.flymeAuth,appName:t.value.appName,limitRate:t.value.limitRate})})},setUserTypeGroup:function(e){e=e.items;for(var t=e.length,a=v.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&(this.setState({userGroupName:e[i].name}),_=e[i].name,A=e[i].userGroupDesc)},getBlackList:function(){var e=this,t=v.default.queryString("appId",window.location.href),a=v.default.queryString("taskId",window.location.href),i=f.default.pushTaskListBlack,s={appId:t};a&&(s.copyTaskId=a),g.default.post(i,s,function(t){var a=t.value,i={blackList:a};a.length?i.black=1:i.black=0,e.setState(i)})},componentDidMount:function(){var e=this,t=v.default.queryString("appId",window.location.href);this.setState({appId:t}),this.getBlackList();var a=v.default.queryString("deal",window.location.href),i=v.default.queryString("id",window.location.href),s=v.default.queryString("groupId",window.location.href);if(a&&O.jsonData&&!this.props.addPush?(this.setState({userType:1,userGroupId:i}),O.jsonData.userType=1,O.jsonData.userGroupId=i,e.setState(O.jsonData),e.props.form.setFieldsValue(O.jsonData)):e.props.form.setFieldsValue(this.state),s){var r={userType:1,userGroupId:s};this.setState(r),e.props.form.setFieldsValue(r)}this.getAppInfo();var l=v.default.queryString("taskId",window.location.href);if(l){var n=f.default.pushTaskCopy;n=v.default.makeUrl(n,{taskId:l,appId:t}),g.default.get(n,function(t){e.fillFormData(t)})}var o=this.props.tableDataIndex;o&&this.fillFormData({value:o})},fillFormData:function(e){var t=v.default.queryString("copyTaskId",window.location.href),a=e.value,i={title:a.title,remark:a.remark,content:a.content,fixSpeed:a.advanceInfo.fixSpeed?1:0,fixSpeedRate:a.advanceInfo.fixSpeedRate,black:a.advanceInfo.black?1:0,validTime:a.pushTimeInfo&&a.pushTimeInfo.validTime,offLine:a.pushTimeInfo&&a.pushTimeInfo.offLine?1:0,distinct:t?1:a.advanceInfo.distinct?1:0},s=this.props.tableDataIndex;if(s&&a.userTypeInfo){var r=a.userTypeInfo.userType;i.userType=r,i.userGroupId=a.userTypeInfo.userGroupId,i["target"+r]=a.userTypeInfo.target||a.userFileName,i.tagIds=a.userTypeInfo.tagIds,i.scope=a.userTypeInfo.scope,i["userFilePath"+r]=a.userTypeInfo.userFilePath}this.props.form.setFieldsValue(i),this.setState({offLine:a.pushTimeInfo&&a.pushTimeInfo.offLine?1:0}),this.showAdvance()},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({startTime:e,fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},render:function(){var e=this.props.form.getFieldProps,t=v.default.queryString("pushType",window.location.href),a=v.default.queryString("copyTaskId",window.location.href);return n.default.createElement(o.Form,{horizontal:!0,id:"detailTable"},n.default.createElement(o.Row,null,n.default.createElement(o.Col,{span:this.props.groupPush?24:15,className:"col_left"},"desktop"!==t&&n.default.createElement(B,s({},q,{label:n.default.createElement(c.default,{text:"任务备注　"})}),n.default.createElement(o.Input,s({rows:"3",type:"textarea",placeholder:"请输入任务备注",style:{width:400}},this.validateRemark("remark")))),n.default.createElement(B,s({},q,{label:"标题    "}),n.default.createElement(o.Input,s({style:{width:400},placeholder:"用于后续查找识别"},this.validateTitle("title")))),n.default.createElement(B,s({},q,{label:"消息内容    "}),n.default.createElement(o.Input,s({rows:"9",style:{width:400},placeholder:"请输入透传消息的JSON格式命令代码",type:"textarea"},this.validateContent("content")))),this.props.groupPush?null:n.default.createElement("div",null,n.default.createElement(E.default,{formItemLayout:q,getFieldProps:e,jumpUserGroup:this.state.jumpUserGroup,selectCronWeek:this.selectCronWeek,form:this.props.form,onChangePushTime:this.onChangePushTime,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),n.default.createElement(T.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:q,getFieldProps:e})),(this.props.groupType||!this.props.groupPush)&&this.state.loadAppInfo?n.default.createElement(k.default,{form:this.props.form,formItemLayout:q,getFieldProps:e,scope:this.state.scope,tableDataIndex:this.props.tableDataIndex,groupPush:!!this.props.groupType,clearUserGroup:this.clearUserGroup,setUserTypeGroup:this.setUserTypeGroup,handleSubmit:this.handleSubmit,flymeAuth:this.state.flymeAuth,appId:v.default.queryString("appId",window.location.href),userType:this.props.form.getFieldValue("userType"),userGroupId:this.state.userGroupId,type:this.props.pushType,changeRadio:this.changeRadio}):null,this.props.groupPush||"timing"===t?null:n.default.createElement(D.default,{form:this.props.form,formItemLayout:q,appId:v.default.queryString("appId",window.location.href),getFieldProps:e,copyTaskId:a,displayDistinct:this.state.displayDistinct,changeCheckbox:this.changeCheckbox,distinct:this.props.form.getFieldValue("distinct"),pushType:this.props.pushType,changeRadio:this.changeRadio}),n.default.createElement(x.default,{form:this.props.form,formItemLayout:q,showAdvanceStatus:this.state.showAdvanceStatus,showAdvance:this.showAdvance,getFieldProps:e,limitRate:this.state.limitRate,blackList:this.state.blackList,black:this.state.black,tableDataIndex:this.props.tableDataIndex,changeBlack:this.changeBlack,displayBlackList:this.state.displayBlackList,userType:this.state.userType,fixSpeed:this.state.fixSpeed,fixDisplay:this.state.fixDisplay,netType:this.state.netType,noticeImgUrl:this.state.noticeImgUrl,changeRadio:this.changeRadio,type:this.props.pushType}))),n.default.createElement(o.Row,{className:"push_btn"},n.default.createElement(o.Col,{span:"14"},this.props.groupPush?null:n.default.createElement(B,{label:""},n.default.createElement(o.Button,{type:"primary",onClick:this.handleSubmit,size:"large"},"推送")))),this.props.groupPush?n.default.createElement(o.Row,null,n.default.createElement(o.Col,null,n.default.createElement(V.default,{submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.pushType,groupPush:this.props.groupPush,form:this.props.form,setTableData:this.props.setTableData,handleSubmit:this.handleSubmit,addPushData:this.props.addPushData,requestData:this.state.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.state.pushReviewNumber,popoverVisible:this.state.popoverVisible}))):null,n.default.createElement(N.default,{form:this.props.form,requestData:this.state.requestData,visible:this.state.visible,cronWeek:this.state.cronWeek,appName:this.state.appName,userGroupName:_||this.state.userGroupName,userGroupDesc:A||this.state.userGroupDesc,handleOk:this.handleOk,type:this.props.pushType,blackList:this.state.blackList,submiting:this.state.submiting,distinctTitle:this.state.distinctTitle,handleCancel:this.handleCancel,pushReviewNumber:this.state.pushReviewNumber}))}});L=o.Form.create()(L),e.exports=L},915:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(600),o=i(n),p=a(783),u=a(799),d=i(u),c=a(776),m=i(c),f=a(785),h=i(f),g=a(777),y=i(g),v=a(899),I=i(v),T=a(900),b=i(T),E=a(902),w=i(E),k=a(916),S=i(k),x=a(907),P=i(x),N=a(906),F=i(N),D=a(800),C=i(D),V=p.Radio.Group,R=p.Form.Item,U=null;window.vedioFilePathJson={};var B={},_=C.default.createActions(["notice"]),A=C.default.createStore({listenables:[_],jsonData:null}),G={labelCol:{span:3},wrapperCol:{span:21}},O=o.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{batchData:[],tableData:[],dataSource:[],requestData:[],pushType:0,groupType:0,offLine:1,onlyWifi:1,distinctId:[],clickTypeParamsApp:[1],clickTypeParamsAppPage:[1],displayDistinct:"none",smallImageDisplay:"none",vedioDisplay:"none",bigImageDisplay:"none",noticeBarType:0,noticeExpandType:0,clickType:0,scope:0,userType:2,distinct:0,fixSpeed:0,msgCache:0,netType:0,fixDisplay:0,suspend:1,startTimeStatus:"success",endTimeStatus:"success",pushTimeStatus:"success",popoverVisible:!1,clearNoticeBar:1,smalllayerDisplay:"none",biglayerDisplay:"none",visible:!1,userTypeStatus:!0,clearTableVisible:!1,addPushVisible:!1,pushReviewNumber:"...",toggleStatus:!1,showAdvanceStatus:!1,pushTimeType:0,distinctTitle:[]}},setTableData:function(e){var t=this.state.tableDataIndex||A.jsonData&&A.jsonData.tableDataIndex,a=this.state.tableDataNum||A.jsonData&&A.jsonData.tableDataNum,i={},s=this.props.form.getFieldValue("userType"),r={userTypeInfo:s},l=this.props.form,n=l.getFieldValue("pushType"),o=l.getFieldValue("groupType");if(0===n?(i.noticeBarInfo=e.noticeBarInfo,i.noticeExpandInfo=e.noticeExpandInfo,i.advanceInfo=e.advanceInfo,i.remark=e.remark,i.clickTypeInfo=e.clickTypeInfo,r.title=e.noticeBarInfo.title,r.content=e.noticeBarInfo.content):(i.title=e.title,i.remark=e.remark,i.advanceInfo=e.advanceInfo,i.clickTypeInfo=e.clickTypeInfo,i.content=e.content,r.title=e.title,r.content=e.content),1===o&&(i.userTypeInfo=e.userTypeInfo,i.userFileName=e["target"+e.userTypeInfo.userType],r.userTypeInfo=e.userTypeInfo.userType,r.userFileName=e["target"+e.userTypeInfo.userType],r.userGroupName=e.userGroupName,r.tagIdsName=e.tagIdsName,r.groupPushScope=e.groupPushScope),t&&t.id)i.id=parseInt(t.id),r.id=parseInt(t.id);else{var p=1e6*Math.random();i.id=parseInt(p),r.id=parseInt(p)}var u={addPushVisible:!1,userTypeInfo:s},d=this.state.tableData,c=this.state.dataSource;t?(d[a]=i,c[a]=r,o&&(u.pushReviewNumber="..."),i.groupPushAmount=t.groupPushAmount):(i.groupPushAmount="...",r.groupPushAmount="...",d.push(i),c.push(r),u.pushReviewNumber="..."),u.tableData=d;var m=[],f=this.state.addPushData,h=y.default.queryString("appId",window.location.href);if(0===o){var g={pushTimeInfo:f.pushTimeInfo,userTypeInfo:f.userTypeInfo,appId:h};d.map(function(e){Object.assign(e,g),m.push(e)})}u.dataSource=c,u.requestData=m,u.uploadXlsError=!1,this.setState(u),B.tableData=d,B.dataSource=c,o&&this.getUserNumber(o,t?a:a||d.length-1)},delParams:function(e,t){for(var a in t)t.hasOwnProperty(a)&&delete e[a]},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},setUserNumber:function(e,t,a){var i=this,s=this.state.groupType,r=i.state.dataSource,l=i.state.tableData,n={searching:!1,totalReviewNumber:e};if(s);else{var o=l.length,p=e;p=p.split(",");var u=p.join("");if(t){if(1===o)return;u-=t,p=u/(o-1)}else p=u/o;for(var d=[],c=0,m=0;m<o&&m!==a;m++){var f=Math.floor(p);d.push(f),m<o-1&&(c+=f)}for(var h=0;h<o&&h!==a;h++){var g=h===o-1?u-c:d.length?d[h]:0;g=String(g),l[h].groupPushAmount=g,r[h].groupPushAmount=g,n["pushReviewNumber"+h]=g}}n.tableData=l,n.dataSource=r,B.tableData=l,B.dataSource=r,i.setState(n)},getUserNumberByGroupType:function(e){var t=this,a=this.state.dataSource,i=this.state.tableData,r={callback:function(){var e=t.state.clickGetUserNumberStatus;e||(t.setState({clickGetUserNumberStatus:!0}),t.setState({searching:!0}))},userNuberCallback:function(r){var l,n=r.value;n=n.split(","),n=n.join(""),i[e].groupPushAmount=n,a[e].groupPushAmount=r.value,t.setState((l={searching:!1},s(l,"pushReviewNumber"+e,n),s(l,"initPushReviewNumber"+e,n),s(l,"tableData",i),s(l,"dataSource",a),l)),B.tableData=i,B.dataSource=a,t.remodify()},key:e};t.handleSubmit(null,"getUserNumber",r)},remodify:function(){var e=this.checkNotSave();e&&this.setState({clickGetUserNumberStatus:!1})},getUserNumber:function(e,t){var a=this,i=this.checkNotSave("getPush");if(i&&!this.state.searching){if(this.props.form.getFieldValue("groupType"))return void this.getUserNumberByGroupType(t);var s={callback:function(){var e=a.state.clickGetUserNumberStatus;e||(a.state.groupType||a.setState({clickGetUserNumberStatus:!0}),a.setState({searching:!0}))},userNuberCallback:function(e){a.setUserNumber(e.value)}};this.handleSubmit(null,"getUserNumber",s)}},addPush:function(e){var t=this;if(this.state.permission===!1&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId"))return void p.message.error("用户群标签没权限");var a=this.state.tableData;return 20===a.length?void p.message.error("最大分组数量为20条"):void this.handleSubmit(null,"deal",function(a){t.setState({addPush:!0,tableDataIndex:null,addPushData:a,tableDataNum:0,addPushVisible:!0}),"function"==typeof e&&e()})},getContent:function(e,t,a){var i=this.delPush.bind(this,e,t,a);return"visiblePush"===e&&(i=this.createGroupPush.bind(this,e)),o.default.createElement("div",null,o.default.createElement(p.Button,{type:"primary",className:"color_bg mr10",onClick:this.togglePopover.bind(this,e)},"取消"),o.default.createElement(p.Button,{onClick:i},"确定"))},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,a.pushReviewNumber="...",U=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},togglePopover:function(e){this.setState(s({},e,!this.state[e]))},createGroupPush:function(e){var t=this;if(!this.state.pushStatus){var a=this.checkNotSave("getPush");if(a){for(var i=y.default.queryString("appId",window.location.href),r=m.default.addTaskGroup,l=this.state.tableData,n=this.state.totalReviewNumber,o=0,u=0;u<l.length;u++)o+=Number(l[u].groupPushAmount);if(!this.state.groupType&&n){var d=n.split(",");if(d=d.join(""),d=Number(d),o>d)return p.message.error("目标用户量相加不能超过"+n),void this.setState(s({pushStatus:!1},e,!1))}this.handleSubmit(null,"createPush",function(a){t.setState({pushStatus:!0}),t.props.form.getFieldValue("pushType")?a.newsTasks=l:a.noticeTasks=l;var n={appId:a.appId,groupJson:JSON.stringify(a)};h.default.post(r,n,function(){p.message.success("提交成功"),window.location.hash="/data/push/group/push?appId="+i},function(){t.setState(s({pushStatus:!1},e,!1))})})}}},handleSubmit:function(e,a,i){var s,r=this;if(i&&"function"==typeof i&&(s=i),i&&"object"===("undefined"==typeof i?"undefined":l(i))){s=i.callback;var n=i.userNuberCallback,o=i.key}this.props.form.validateFields(function(e,i){var l=i.userType;if(!(+new Date(i.fixStartDisplayTime)>+new Date(i.fixEndDisplayTime))){"deal"===a&&(i.noticeBarImgUrl||(i.noticeBarImgUrl=r.state.noticeBarImgUrl),i.noticeExpandImgUrl||(i.noticeExpandImgUrl=r.state.noticeExpandImgUrl),i.showAdvanceStatus=r.state.showAdvanceStatus,A.jsonData=i,t.jsonData=i);var p=r.state.distinctId;if(i.distinct&&0===p.length)return void r.setState({displayDistinct:""});for(var u in i)u.indexOf("distinctId")>-1&&delete i[u];if(p&&(i.distinctId=p.join(",")),(5!==l||i.tagIds)&&(1!==l||i.userGroupId&&"null"!==i.userGroupId)){if(i.target=i["target"+l],delete i["target"+l],i.userFilePath=i["userFilePath"+l],delete i["userFilePath"+l],""===i.target&&delete i.target,i.userFilePath&&delete i.target,e)return console.log(e),void console.log("Errors in form!!!");i.pushTimeInfo={pushTimeType:i.pushTimeType,startTime:i.startTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",i.startTime),offLine:i.offLine,validTime:i.validTime},r.delParams(i,i.pushTimeInfo),delete i.tagIdsName,
0===i.groupType&&(i.userTypeInfo={userType:l,userGroupId:i.userGroupId,target:i.target,tagIds:i.tagIds,scope:i.scope,userFilePath:i.userFilePath},r.delParams(i,i.userTypeInfo));var d=r.props.form.getFieldValue("pushType"),c=y.default.queryString("appId",window.location.href);i.appId=c,r.setState({visible:!0,requestDataValue:i});var f=r.state.tableData;f[o]&&f[o].userTypeInfo&&(i.userTypeInfo=f[o].userTypeInfo);var g={appId:c,userTypeInfo:i.userTypeInfo},v=m.default.getPushCount;v=y.default.makeUrl(v,{appId:c,pushType:d,json:JSON.stringify(g)}),s&&"function"==typeof s&&s(i),"getUserNumber"===a&&h.default.get(v,function(e){r.setState({pushReviewNumber:e.value}),n&&n(e,i)},function(){r.setState({searching:!1,apiError:!0})},{timeout:3e5})}}})},validateTitle:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,message:"请输入分组标题"},{max:32,message:"标题不能超过32个字"},{validator:function(e,t,a){t&&t.length<=32&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},validateContent:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,message:"请输入内容"},{max:100,message:"内容不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},queryMobileValidImei:function(){var e=this.props.form.getFieldValue("checkImeiPath"),t=this.props.form.getFieldValue("versionNum"),a="?checkImeiPath="+e+"&versionNum="+t;h.default.get(m.default.queryMobileValidImei+a,function(e){var t=e.value;p.message.success("有效IMEI数"+t)})},componentWillMount:function(){var e=this,t=y.default.queryString("appId",window.location.href),a=y.default.queryString("deal",window.location.href);t&&(e.props.form.setFieldsValue({appId:t}),a&&A.jsonData||(B={}))},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},restoreStatus:function(e,t){if("noticeBarType"===e&&1===t&&(1===this.props.form.getFieldValue("noticeExpandType")||3===this.props.form.getFieldValue("noticeExpandType"))){var a={noticeExpandType:0,smalllayerDisplay:"none"};this.setState(a),this.props.form.setFieldsValue(a)}},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeRadio:function(e,t){var a=this,i={};"userGroupAuth"===t&&(i.permission=e.target.permission),this.setState(i);var s=e.target.name;if("upload"===s||"remove"===s||"changeTarget"===s||"tags"===s)return void this.setState({pushReviewNumber:"..."});var r=e.target.value;if(i[s]=r,i.userGroupId=this.props.form.getFieldValue("userGroupId")||this.state.userGroupId,!("noticeBarType"===s&&this.props.form.getFieldValue("noticeBarType")===r||"noticeExpandType"===s&&this.props.form.getFieldValue("noticeExpandType")===r)){if("userGroupId"===s&&(i.userGroupName=e.target.label,i.userGroupDesc=e.target.expression,U=e.target.label),"distinct"==s&&0==r&&(i.distinctTitle=[],i.distinctId=[]),"userType"!==s&&"userGroupId"!==s||this.props.form.getFieldValue(s)===r||(i.totalReviewNumber=!1,i.pushReviewNumber="...",i.clickRefresh=!this.state.clickRefresh),"groupType"===s&&this.props.form.getFieldValue(s)!==r){this.state.tableData.length?(i.clearTableVisible=!0,i.userTypeStatus=this.state.userTypeStatus):(i.userTypeStatus=!this.state.userTypeStatus,i.clearUserFile=!0);var l=r?0:1;return i.clearTableName=s,i.clearTableValue=l,i.currentClickRadio=s,void a.setState(i)}if("pushType"===s&&this.props.form.getFieldValue(s)!==r){this.state.tableData.length&&(i.clearTableVisible=!0);var n=r?0:1;return i.clearTableName=s,i.clearTableValue=n,i.currentClickRadio=s,void a.setState(i)}"scope"===s&&this.props.form.getFieldValue(s)!==r&&(i.pushReviewNumber="..."),this.setState(i),this.props.form.setFieldsValue(i),this.restoreStatus(s,r),this.showButton(s,r)}},clearTabelOk:function(){var e={clearTableVisible:!1};"groupType"===this.state.currentClickRadio&&(e.totalReviewNumber=!1,e.pushReviewNumber="...",e.clearUserFile=!0,e.userTypeStatus=!this.state.userTypeStatus),this.setState(e);for(var t=this.state.dataSource,a={dataSource:[],tableData:[]},i=0;i<t.length;i++)a["pushReviewNumber"+i]="...";this.setState(a),B={}},clearTabelCancel:function(){var e={clearTableVisible:!1};this.props.form.setFieldsValue(s({},this.state.clearTableName,this.state.clearTableValue)),"groupType"===this.state.currentClickRadio&&(e.groupType=this.state.groupType?0:1),this.setState(e)},showButton:function(e,t){"noticeExpandType"===e&&2===t&&this.setState({toggleStatus:!0,showBigImg:!0,biglayerDisplay:"none"}),"noticeExpandType"===e&&1===t&&this.setState({toggleStatus:!1,biglayerDisplay:"none"})},handleCancel:function(){this.setState({visible:!1,addPushVisible:!1,submiting:!1})},getAppName:function(e){var t="全部应用",a=d.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=y.default.queryString("appId",window.location.href);if(this.state.appId&&e!==this.state.appId){this.getAppName(e);var t={appId:e};this.state.groupType||(t.pushReviewNumber="..."),this.setState(t),this.getAppInfo()}},getAppInfo:function(e){var t=this,a=y.default.queryString("appId",window.location.href);h.default.get(m.default.getAppInfo+"?appId="+a,function(a){var i=a.value.appIconUrl;e&&e(i),e||(t.setState({noticeImgUrl:""===i?null:i}),t.props.form.setFieldsValue({noticeImgUrl:""===i?null:i})),t.setState({loadAppInfo:!0,flymeAuth:a.value.flymeAuth,appName:a.value.appName,limitRate:a.value.limitRatem,msgCacheStatus:a.value.msgCache})})},setUserTypeGroup:function(e){e=e.items;var t=e.length;U=null;for(var a=y.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&this.setState({userGroupName:e[i].name})},componentDidMount:function(){var e=this,t=y.default.queryString("appId",window.location.href),a={appId:t};B.tableData&&(a.tableData=B.tableData,a.dataSource=B.dataSource,a.requestData=B.requestData),this.setState(a);var i=y.default.queryString("deal",window.location.href),r=y.default.queryString("id",window.location.href);if(i&&A.jsonData){var l={groupType:A.jsonData.groupType,userType:1,userGroupId:r},n=B&&B.tableData;if(n&&n.length)for(var o=0;o<n.length;o++)"..."===n[o].groupPushAmount&&(l.pushReviewNumber="..."),l["pushReviewNumber"+o]=n[o].groupPushAmount;var p=A.jsonData.pushTimeInfo;1===A.jsonData.groupType&&(l.userTypeStatus=!1,l.addPushVisible=!0,p&&(l.startTime=p.startTime)),this.setState(l),A.jsonData.userType=1,A.jsonData.userGroupId=r,p&&1===p.pushTimeType&&(A.jsonData.startTime=new Date(p.startTime)),p&&(A.jsonData.offLine=p.offLine,A.jsonData.pushTimeType=p.pushTimeType,A.jsonData.validTime=p.validTime),e.setState(A.jsonData),e.props.form.setFieldsValue(A.jsonData)}else B={},window.vedioFilePathJson={},e.props.form.setFieldsValue(this.state);this.getAppInfo(function(a){e.props.form.setFieldsValue({noticeImgUrl:a});var i=y.default.queryString("taskId",window.location.href);if(i){var r=m.default.pushTaskCopy;r=y.default.makeUrl(r,{taskId:i,appId:t}),h.default.get(r,function(t){var a,i=t.value,r=i.clickTypeInfo.parameters,l=i.clickTypeInfo.clickType,n="App";1===l&&(n="AppPage");var o=[],p=(a={noticeBarType:i.noticeBarInfo.noticeBarType,noticeBarImgUrl:i.noticeBarInfo.noticeBarImgUrl,title:i.noticeBarInfo.title,content:i.noticeBarInfo.content,noticeExpandContent:i.noticeExpandInfo.noticeExpandContent,noticeExpandImgUrl:i.noticeExpandInfo.noticeExpandImgUrl,noticeExpandType:i.noticeExpandInfo.noticeExpandType,vedioUrl:i.noticeExpandInfo.actSetting&&i.noticeExpandInfo.actSetting.noticeExpandVedioUrl,onlyWifi:i.noticeExpandInfo.actSetting&&(i.noticeExpandInfo.actSetting.onlyWifi?1:0),activity:i.clickTypeInfo.activity},s(a,"parameters"+n,i.clickTypeInfo.parameters),s(a,"clickType",i.clickTypeInfo.clickType),s(a,"url",i.clickTypeInfo.url),s(a,"customAttribute",i.clickTypeInfo.customAttribute),s(a,"msgCache",i.advanceInfo.msgCache?1:0),s(a,"suspend",i.advanceInfo.suspend?1:0),s(a,"clearNoticeBar",i.advanceInfo.clearNoticeBar?1:0),s(a,"fixSpeed",i.advanceInfo.fixSpeed?1:0),s(a,"fixSpeedRate",i.advanceInfo.fixSpeedRate),s(a,"distinct",i.advanceInfo.distinct?1:0),s(a,"noticeImgUrl",i.advanceInfo.noticeImgUrl),s(a,"vibrate",i.advanceInfo.notificationType.vibrate?1:0),s(a,"lights",i.advanceInfo.notificationType.lights?1:0),s(a,"sound",i.advanceInfo.notificationType.sound?1:0),s(a,"offLine",i.pushTimeInfo.offLine?1:0),s(a,"validTime",i.pushTimeInfo.validTime),a);window.vedioFilePathJson.vedioUrl=i.noticeExpandInfo.actSetting&&i.noticeExpandInfo.actSetting.noticeExpandVedioUrl;for(var u in r)o.push({key:u,value:r[u]});for(var d=0;d<o.length;d++)p["key"+n+(d+1)]=o[d].key,p["value"+n+(d+1)]=o[d].value,window.parametersJson["key"+n+(d+1)]=o[d].key,window.parametersJson["value"+n+(d+1)]=o[d].value;e.props.form.setFieldsValue(p),e.setState({noticeBarType:i.noticeBarInfo.noticeBarType,msgCacheStatus:i.advanceInfo.msgCacheStatus,offLine:i.pushTimeInfo.offLine?1:0}),e.showAdvance()})}})},clickHide:function(e){1===e&&this.setState({noticeExpandContent:!1,toggleStatus:!1}),2===e&&this.setState({noticeExpandImgUrl:!1,showBigImg:!1,toggleStatus:!1})},clickShow:function(e){if(1===e){var t=this.props.form.getFieldValue("noticeExpandContent");if(!t)return void p.message.error("请输入展开文本");this.setState({noticeExpandContent:!0,toggleStatus:!0})}if(2===e){var a=this.props.form.getFieldValue("noticeExpandImgUrl");this.setState({noticeExpandImgUrl:a,showBigImg:!0,toggleStatus:!0})}},changeIcon:function(e){this.setState({noticeImgUrl:null}),this.props.form.setFieldsValue({noticeImgUrl:e})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},checkNotSave:function(){for(var e=!0,t=this.state.tableData,a=t.length,i=[],s=0;s<a;s++)i.push("pushReviewNumber"+s+"Status");for(var r=0;r<i.length;r++)this.state[i[r]]&&(p.message.error("你有未保存的选项"),e=!1);return e},modify:function(e){var t={},a=this.checkNotSave();a&&(t[e.target.className]=!0,t.clickGetUserNumberStatus=!0,this.setState(t))},save:function(e,t){var a=this.state.totalReviewNumber;a=String(a).split(","),a=a.join("");var i=this.state.tableData;e=String(e[0]);var s=e.split("pushReviewNumber");s=Number(s[1]),t.stopPropagation();var r=this,l={},n=r.state[e];if(i[s].groupPushAmount=n,l[e]=n,l[e+"Status"]=!1,this.state.groupType){var o=this.state["initPushReviewNumber"+s];if(Number(n)>Number(o))return void p.message.error("目标用户数量最大为："+o)}else if(Number(n)>Number(a))return void p.message.error("目标用户数量最大为："+a);l.clickGetUserNumberStatus=!1,r.setState(l)},keyup:function(e){var t={},a=e.target.value;a=a?a:"0",t[e.target.name]=a,this.setState(t)},batchError:function(e){var t=e.value,a={};for(var i in t)a["pushreview"+i]=t[i];this.setState(a)},delPush:function(e,t,a){var i=this.state.tableData,s=this.state.dataSource,r=this.state.requestData;i.splice(a,1),s.splice(a,1),r.splice(a,1);for(var l={},n=0;n<i.length;n++)l["pushReviewNumber"+n]=i[n].groupPushAmount,l["initPushReviewNumber"+n]=i[n].groupPushAmount;l[e]=!this.state[e],l.tableData=i,l.dataSource=s,l.requestData=r,this.state.groupType||(l.pushReviewNumber="..."),l["checked_"+a]=!1,l.groups=[],this.setState(l),B.tableData=i,B.dataSource=s},modifyPush:function(e,t){var a=this,i=this.state.tableData;this.handleSubmit(null,null,function(e){a.setState({tableDataIndex:i[t],tableDataNum:t,addPushData:e,addPushVisible:!0});var s=A.jsonData;s||(A.jsonData={}),A.jsonData.tableDataIndex=i[t],A.jsonData.tableDataNum=t})},getTooltipContainer:function(){return document.getElementById("groupTable")},getInfo:function(){return o.default.createElement("span",null,o.default.createElement(p.Tooltip,{getTooltipContainer:this.getTooltipContainer,title:"目标用户量获取后可点击修改"},o.default.createElement("i",{className:"fs14 color999 fw_n cursor_p anticon anticon-info-circle-o"})),"目标用户量")},clickInputFile:function(){this.handleSubmit(null,"upload",function(){var e=document.querySelectorAll("input[type=file]"),t=e.length;e[t-1].click()})},getBatchData:function(e){var t=this.state.requestDataValue,a=e.result,i=y.default.queryString("appId",window.location.href),s=this.props.form.getFieldValue("userType"),r=this.state.tableData,l=this.state.dataSource,n=[];a.map(function(e){var a={appId:i},o={userTypeInfo:s};a.noticeBarInfo={title:e.title,content:e.content,noticeBarType:2},a.noticeExpandInfo={noticeExpandType:e.noticeExpandType,noticeExpandContent:e.noticeExpandContent},a.advanceInfo={msgCache:0,distinctId:"",fixSpeed:e.fixSpeed||0,fixSpeedRate:e.fixSpeedRate,blackId:e.blackId||"",black:e.black||0,fixDisplay:e.fixDisplay?1:0,fixStartDisplayTime:e.fixDisplayStartTime,fixEndDisplayTime:e.fixDisplayEndTime,suspend:e.suspend,clearNoticeBar:e.clearNoticeBar,notificationType:{vibrate:e.vibrate,lights:e.lights,sound:e.sound}},a.clickTypeInfo={clickType:e.clickType,activity:e.activity,url:e.url,customAttribute:e.customAttribute,parameters:e.parameters&&JSON.parse(e.parameters)};var p=1e6*Math.random();a.id=parseInt(p),o.id=parseInt(p),o.title=e.title,o.content=e.content,r.push(a),l.push(o);var u={pushTimeInfo:t.pushTimeInfo,userTypeInfo:t.userTypeInfo};Object.assign(u,a),n.push(u)}),this.setState({batchData:r,tableData:r,requestData:n,dataSource:l}),B.tableData=r,B.dataSource=l,B.requestData=n},selectAll:function(e,t){var a={},i=e.target.checked;t.map(function(e){a["checked_"+e.id]=i}),this.setState(a)},selectChecked:function(e,t){this.setState(s({},"checked_"+t,e.target.checked))},render:function(){var e=this,t=this,a=this.state,i=[];for(var l in a)if(l.indexOf("checked_")>-1&&a[l]){var n=l.split("checked_")[1];i.push(n)}var u=this.props.form.getFieldProps,d=o.default.createElement("div",{style:{display:t.state.clickGetUserNumberStatus?"":"none",position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"#ccc",opacity:.5,zIndex:999}}),c=B.dataSource||this.state.dataSource,f=[{title:"标题/备注",key:"1",dataIndex:"title",render:function(e){return e.length>9?o.default.createElement(p.Tooltip,{title:e},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:200}},e)):e},width:200},{title:"内容",key:"2",dataIndex:"content",render:function(e){return e.length>9?o.default.createElement(p.Tooltip,{title:e},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:200}},e)):e},width:200},{title:"目标用户",key:"3",dataIndex:"userTypeInfo",render:function(e,a){var i="",s="",r="";switch(t.state.groupType?(i=a.userFileName,i=i&&(i.indexOf(".")>-1?i:null),s=a.userGroupName,r=(a.groupPushScope?"交集：":"并集：")+a.tagIdsName):(e=t.props.form.getFieldValue("userType")||t.state.userType,i=t.props.form.getFieldValue("target"+e),i=i&&(i.indexOf(".")>-1?i:null),s=U||t.state.userGroupName,r=(t.state.scope?"交集：":"并集：")+(t.props.form.getFieldValue("tagIdsName")||"")),e){case 1:e="用户群"+(s?"("+s+")":"");break;case 2:e="PushId"+(i?"("+i+")":"");break;case 6:e="IMEI"+(i?"("+i+")":"");break;case 3:e="Flyme账户"+(i?"("+i+")":"");break;case 4:e="别名"+(i?"("+i+")":"");break;case 5:e="标签("+r+")"}return e.length>9?o.default.createElement(p.Tooltip,{title:e},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:180}},e)):e},width:180},{title:this.getInfo(),className:"td_appname",key:"4",dataIndex:"groupPushAmount",render:function(e,a,i){var s=["pushReviewNumber"+i],r=["pushReviewNumber"+i+"Status"],l=t.state["pushReviewNumber"+i];if(l&&"..."!==l&&l.indexOf(",")<0){l=String(l),l=l.split("");for(var n=l.length,u=n-1;u>=0;u--)n-1-u&&(n-1-u)%3===0&&n-1!==u&&(l[u]+=",")}"..."===a.groupPushAmount&&(l=!1);var d=o.default.createElement(R,{style:{marginBottom:0},label:""},t.state[r]?o.default.createElement("span",null,o.default.createElement(p.Input,{min:"1",type:"number",className:"Modify",defaultValue:t.state[s],name:s,onChange:t.keyup,style:{width:100}}),o.default.createElement(p.Button,{onClick:t.save.bind(t,s),size:"large",className:"btn_normal_show ml10 w_60 ",type:"ghost"},o.default.createElement("span",{className:"Modify"},"保存"))):o.default.createElement("span",null,l?o.default.createElement("span",{className:r,onClick:t.modify},l):"..."));return d},width:150},{title:"操作",key:"5",render:function(e,a,i){var s="visibleDel"+i;return o.default.createElement("div",{style:{position:"relative"}},d,o.default.createElement("i",{onClick:t.modifyPush.bind(t,a,i),className:"i_edit"}),o.default.createElement(p.Popover,{placement:"bottom",visible:t.state[s],content:t.getContent(s,a,i),title:"确定删除?",onVisibleChange:t.togglePopover.bind(t,s),trigger:"click"},o.default.createElement("i",{className:"i_del"})))},width:90}];this.state.groupType||this.state.pushType||(f=f.concat([{title:o.default.createElement(p.Checkbox,{onChange:function(t){return e.selectAll(t,c)}}),key:"6",render:function(e,a){return o.default.createElement(p.Checkbox,{checked:t.state["checked_"+a.id],onChange:function(e){return t.selectChecked(e,a.id)}})},width:90},{title:"预推结果",key:"7",render:function(e,a){var i=t.state["pushreview"+a.id],s="";i&&(s="200"===i?"成功":"失败");var r="200"===i?s&&o.default.createElement(p.Button,null,s):s&&o.default.createElement(p.Tooltip,{title:i},o.default.createElement(p.Button,null,s));return r},width:90}]));var h=y.default.queryString("copyTaskId",window.location.href),g=m.default.uploadPushContent,v=y.default.queryString("appId",window.location.href);g=y.default.makeUrl(g,{appId:v});var T=100,E={name:"multipartFile",data:{},accept:".xls,.xlsx",action:g,beforeUpload:function(e){if(t.setState({loading:!0,uploadXlsError:!1}),e.size>1048576*T)return p.message.error("文件大小不能超过"+T+"M"),t.setState({loading:!1}),!1},headers:{authorization:"authorization-text"},onChange:function(e){var a=t.props.userType;if("removed"===e.file.status){if(t.setState({loading:!1}),e.fileList.length<1){var i,r;t.setState((i={},s(i,"targetDisabled"+a,!1),s(i,"removed"+a,!0),s(i,"targetRequired"+a,!1),i)),t.props.form.setFieldsValue((r={},s(r,"userFilePath"+a,void 0),s(r,"target"+a,void 0),r))}return void t.props.changeRadio({target:{name:"remove"}})}if("error"===e.file.status&&t.setState({loading:!1}),"done"===e.file.status)if(t.setState({loading:!1}),200==e.file.response.code){if(e.fileList.length>1&&e.fileList.shift(),p.message.success(e.file.name+" 上传成功。"),e.file.response.value.wrong.length)return void t.setState({uploadXlsError:!0,multipartFileWrong:e.file.response.value.wrong});t.getBatchData(e.file.response.value)}else e.fileList.pop(),p.message.error(e.file.response.message),t.props.form.setFieldsValue({})}};return o.default.createElement(p.Form,{horizontal:!0,id:"detailTable"},o.default.createElement(p.Row,null,o.default.createElement(p.Col,{span:"24",className:"col_left"},o.default.createElement(R,r({},G,{label:"标题    "}),o.default.createElement(p.Input,r({placeholder:"请输入分组标题",style:{width:400}},this.validateTitle("groupName")))),o.default.createElement("div",{style:{position:"relative"}},d,o.default.createElement(R,r({},G,{label:"推送消息类型    "}),o.default.createElement(V,u("pushType",{initialValue:this.props.form.getFieldValue("pushType"),onChange:this.changeRadio}),o.default.createElement(p.Radio,{name:"pushType",value:0},"通知"),o.default.createElement(p.Radio,{name:"pushType",value:1},"透传消息"))),o.default.createElement(R,r({},G,{label:"目标用户类型    "}),o.default.createElement(V,u("groupType",{initialValue:this.props.form.getFieldValue("groupType"),onChange:this.changeRadio}),o.default.createElement(p.Radio,{name:"groupType",value:0},"相同用户群"),o.default.createElement(p.Radio,{name:"groupType",value:1},"不同用户群"))),this.state.userTypeStatus&&this.state.loadAppInfo?o.default.createElement(w.default,{form:this.props.form,formItemLayout:G,getFieldProps:u,scope:this.state.scope,clearUserGroup:this.clearUserGroup,userType:this.props.form.getFieldValue("userType")||2,handleSubmit:this.handleSubmit,groupPush:!0,clearUserFile:this.state.clearUserFile,userGroupId:this.state.userGroupId,type:this.props.pushType,setUserTypeGroup:this.setUserTypeGroup,flymeAuth:this.state.flymeAuth,appId:y.default.queryString("appId",window.location.href),changeRadio:this.changeRadio}):null,o.default.createElement(b.default,{formItemLayout:G,getFieldProps:u,form:this.props.form,onChangePushTime:this.onChangePushTime,pushTimeStatus:this.state.endTimeStatus,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),o.default.createElement(I.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:G,getFieldProps:u}),o.default.createElement(P.default,{form:this.props.form,formItemLayout:G,copyTaskId:h,jsonData:A.jsonData,appId:y.default.queryString("appId",window.location.href),getFieldProps:u,displayDistinct:this.state.displayDistinct,changeCheckbox:this.changeCheckbox,distinct:this.props.form.getFieldValue("distinct"),pushType:this.props.pushType,changeRadio:this.changeRadio}),o.default.createElement(R,r({className:"task_group_button"},G,{label:" "}),o.default.createElement(p.Button,{style:{marginBottom:10},onClick:this.addPush,type:"primary",size:"large"},"添加推送内容"),!this.state.groupType&&!this.state.pushType&&o.default.createElement("span",null,o.default.createElement("span",{style:{display:"none"}},o.default.createElement(p.Upload,r({},u("multipartFile"),{style:{width:200}},E),o.default.createElement(p.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"批量上传推送内容",this.state.loading?o.default.createElement(p.Icon,{type:"loading"}):o.default.createElement("span",null)))),o.default.createElement(p.Button,{onClick:this.clickInputFile,size:"large",className:"btn_normal_show ml10 va_t",type:"ghost"},"批量上传推送内容"),o.default.createElement("a",{className:"download",target:"_blank",href:m.default.taskGroupDownloadTemplate+"?appId="+v},"下载模板")))),c&&c.length?o.default.createElement("div",{id:"groupTable"},o.default.createElement(p.Table,{style:{marginBottom:20},pagination:!1,columns:f,dataSource:c})):null,this.state.uploadXlsError&&o.default.createElement("div",{style:{padding:"0 0 20px 145px"},className:" color_error"},this.state.multipartFileWrong.map(function(e,t){return o.default.createElement("p",{key:t},e)})),c&&c.length?o.default.createElement(R,r({},G,{label:" "}),(!this.props.form.getFieldValue("groupType")||this.state.clickGetUserNumberStatus)&&o.default.createElement(p.Button,{disabled:!!this.state.clickGetUserNumberStatus,type:"primary",onClick:this.getUserNumber,size:"large"},"获取目标用户"),this.state.clickGetUserNumberStatus?o.default.createElement(p.Button,{type:"primary",style:{marginLeft:20},onClick:this.remodify,size:"large"},"重新编辑"):null,this.state.searching?o.default.createElement("span",{style:{paddingLeft:20}},"正在查询用户数，请等待..."):o.default.createElement("span",null),!this.state.groupType&&!this.state.pushType&&o.default.createElement(F.default,{submiting:this.props.submiting,batchError:this.batchError,handleOk:this.props.handleOk,batch:!0,type:this.props.form.getFieldValue("pushType")?"message":"notice",groups:i,requestData:this.state.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.props.pushReviewNumber,popoverVisible:this.state.popoverVisible})):null,c&&c.length?o.default.createElement(R,r({},G,{label:" "}),o.default.createElement(p.Popover,{placement:"top",visible:t.state.visiblePush,content:t.getContent("visiblePush"),title:"确定推送?",onVisibleChange:this.togglePopover.bind(this,"visiblePush"),trigger:"click"},"..."!==this.state.pushReviewNumber?o.default.createElement("span",{style:{position:"relative"}},o.default.createElement(p.Button,{type:"primary",size:"large"},"推送"),this.state.pushStatus?o.default.createElement("div",{style:{position:"absolute",left:130,top:-5,width:120}},"推送中..."):o.default.createElement("span",null)):o.default.createElement("span",null))):null)),o.default.createElement(S.default,{handleCancel:this.handleCancel,form:this.props.form,totalReviewNumber:this.state.totalReviewNumber,addPushData:this.state.addPushData,tableDataIndex:this.state.tableDataIndex,addPush:this.state.addPush,setTableData:this.setTableData,smallImageDisplay:this.state.smallImageDisplay,flymeAuth:this.state.flymeAuth,pushType:this.props.form.getFieldValue("pushType")?"message":"notice",groupType:this.props.form.getFieldValue("groupType"),visible:this.state.addPushVisible}),o.default.createElement(p.Modal,{width:700,onCancel:this.clearTabelCancel,onOk:this.clearTabelOk,title:"系统提示",visible:this.state.clearTableVisible},o.default.createElement("div",{style:{margin:"20px 0 20px 30px"}},"切换","pushType"===this.state.clearTableName?"推送消息类型":"目标用户类型","将会清除本任务所有已编辑内容，请确定是否切换？")))}});O=p.Form.create()(O),e.exports=O},916:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(783),n=a(897),o=i(n),p=a(914),u=i(p);window.vedioFilePathJson={};var d=r.default.createClass({displayName:"AddPushModal",getInitialState:function(){return{popoverVisible:!1}},componentDidMount:function(){document.querySelector("#prepush")&&(document.querySelector("#prepush").classList="prepush_position")},render:function(){var e=this.props.pushType,t="notice"===e?"推送通知":"透传消息";return this.props.visible?r.default.createElement(l.Modal,{footer:null,width:"notice"===e?1240:800,onCancel:this.props.handleCancel,title:t,visible:this.props.visible},"notice"===e?r.default.createElement(o.default,{setTableData:this.props.setTableData,addPushData:this.props.addPushData,tableDataIndex:this.props.tableDataIndex,pushType:e,addPush:this.props.addPush,totalReviewNumber:this.props.totalReviewNumber,visible:this.props.visible,groupPush:!0,groupType:this.props.groupType}):r.default.createElement(u.default,{setTableData:this.props.setTableData,addPushData:this.props.addPushData,tableDataIndex:this.props.tableDataIndex,pushType:e,addPush:this.props.addPush,totalReviewNumber:this.props.totalReviewNumber,visible:this.props.visible,groupPush:!0,groupType:this.props.groupType})):null}});d=l.Form.create()(d),e.exports=d},917:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),r=i(s),l=a(897),n=i(l),o=a(914),p=i(o),u=a(777),d=i(u),c=a(783),m=c.Tabs.TabPane,f=r.default.createClass({displayName:"App",getInitialState:function(){return{}},onChange:function(e){var t=window.location.hash,a=d.default.getQueryObj(t);a.timingPushType=e;var i=d.default.makeUrl("#/create/push/",a);window.location.hash=i},render:function(){var e=window.location.hash,t=d.default.getQueryObj(e),a=t.timingPushType||"1";return r.default.createElement("div",null,r.default.createElement(c.Tabs,{onChange:this.onChange,defaultActiveKey:a},r.default.createElement(m,{tab:"定时通知",key:"1"},r.default.createElement(n.default,{pushType:"notice"})),r.default.createElement(m,{tab:"定时透传消息",key:"2"},r.default.createElement(p.default,{pushType:"message"})," ")))}});e.exports=f}});