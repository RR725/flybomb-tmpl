webpackJsonp([32],{922:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),i=l(r),s=a(783),o=a(777),d=l(o),u=a(923),c=l(u),m=s.DatePicker.MonthPicker,p=s.Form.Item,f=s.Radio.Button,h=s.Radio.Group,g=i.default.createClass({displayName:"PushTime",getInitialState:function(){var e=this.props.router,t=this.props.defaultDay,a=864e5,l=new Date,n="userdata"===e?6:0;n=t?t:n;var r=new Date(+new Date-n*a),i=d.default.dateFormat("yyyy-MM-dd",r),s=d.default.dateParse(i+" 00:00:00");return{startTimeStatus:"success",endTimeStatus:"success",startTime:s,endTime:l,display:"none",errorTips:"",pushTimeType:t||0}},changeRadio:function(e){var t=e.target.value,a=+new Date,l=864e5,n={pushTimeType:t};if(1===t?n.endTime=new Date(a-Number(t)*l):n.endTime=new Date,"number"==typeof t){n.startTime=new Date(a-Number(t)*l);var r=d.default.dateFormat("yyyy-MM-dd",n.startTime);n.startTime=d.default.dateParse(r+" 00:00:00"),1===t&&(n.endTime=d.default.dateParse(r+" 23:59:59")),n.display="none",n.startTimeStatus="success",n.endTimeStatus="success",n.errorTips=""}else n.startTime=new Date;this.setState(n),this.props.form.setFieldsValue(n)},componentDidMount:function(){"userdata"===this.props.router&&this.setState({pushTimeType:6})},onOpen:function(){this.setState({pushTimeType:"other"})},changeStartTime:function(e){var t=this.props.router,a=this.props.required,l=this.props.dateType,n="month"===l?"endTimeMonth":"endTime",r={router:t,required:a},i=this.props.form.getFieldValue(n),s=c.default.changeStartTime(e,i,r);this.setState(s)},changeEndTime:function(e){var t=e.getFullYear(),a=e.getMonth()+1,l=this.props.required,n=this.props.dateType,r="startTime";"month"===n&&(r="startTimeMonth",e=d.default.dateParse(t+"-"+a+"-31 23:59:59"));var i={required:l},s=this.props.form.getFieldValue(r),o=c.default.changeEndTime(e,s,i);this.setState(o)},render:function(){var e="",t=this.props.dateType,a=this.props.type,l=this.props.router,r=this.props.hiddenTitle;"second"===a&&(e=" H:mm:ss");var o="yyyy-MM-dd"+e;o="month"===t?"yyyy-MM":o;var d=this.props.form.getFieldProps,u=r?"":i.default.createElement("span",null,"时间");return i.default.createElement(p,{className:"radio_btn",labelCol:{span:2},wrapperCol:{span:22},label:u},"personal"===l?null:i.default.createElement(h,{onChange:this.changeRadio,value:this.state.pushTimeType,size:"large",style:{marginRight:10}},"userdata"===l||"averagePush"===l?null:i.default.createElement(f,{value:0},"今天"),"userdata"===l?null:i.default.createElement(f,{value:1},"昨天"),"averagePush"===l?i.default.createElement(f,{value:2},"前天"):null,"analyze"===l||"averagePush"===l?null:i.default.createElement(f,{value:6},"最近7天"),"analyze"===l||"averagePush"===l?null:i.default.createElement(f,{value:30},"最近30天"),i.default.createElement(f,{value:"other"},"选择日期")),i.default.createElement(p,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},"month"===t?i.default.createElement(m,d("startTimeMonth",{initialValue:this.state.startTime,onChange:this.changeStartTime})):i.default.createElement(s.DatePicker,n({},d("startTime",{initialValue:this.state.startTime,onChange:this.changeStartTime}),{toggleOpen:this.onOpen,showTime:!0,format:o}))),"analyze"===l||"averagePush"===l?null:i.default.createElement("span",{className:"pl10 pr10"},"至"),"analyze"===l||"averagePush"===l?null:i.default.createElement(p,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},"month"===t?i.default.createElement(m,d("endTimeMonth",{initialValue:this.state.endTime,onChange:this.changeEndTime})):i.default.createElement(s.DatePicker,n({},d("endTime",{initialValue:this.state.endTime,onChange:this.changeEndTime}),{toggleOpen:this.onOpen,showTime:!0,format:o}))),i.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips))}});e.exports=g},1582:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=a(600),r=l(n),i=a(1583),s=l(i),o=a(776),d=l(o),u=a(777),c=l(u),m=a(785),p=l(m),f=r.default.createClass({displayName:"App",getInitialState:function(){return{current:1,tableData:{loading:!0,data:[],pagination:null}}},setTableDataDisable:function(e){var t=this.state.tableData.data;t.map(function(t,a){var l=t.disable;a===e&&(t.disable=!l)}),this.setState({tableData:{data:t}})},tableData:function(e){var t=this,a=c.default.queryString("appId",window.location.href);this.setState({current:e.index,tableData:{loading:!0}});var l=d.default.materialList;l=c.default.makeUrl(l,e),p.default.get(l,function(l){var n=l.value.result;n.map(function(e,t){n[t].key=t}),t.setState({tableData:{data:n,loading:!1,pagination:{total:l.value.amount,current:e.index,pageSize:10,showSizeChanger:!1,onChange:function(l){var n={appId:a,index:l};e.startTime&&(n.startTime=e.startTime),e.endTime&&(n.endTime=e.endTime),e.title&&(n.title=e.title),t.setState({current:l}),t.tableData(n)}}}})},function(){t.setState({tableData:{loading:!1}})})},componentDidMount:function(){var e=c.default.queryString("appId",window.location.href);this.setState({appId:e})},render:function(){return r.default.createElement("div",null,r.default.createElement(s.default,{setTableDataDisable:this.setTableDataDisable,current:this.state.current,refresh:this.state.refresh,tableData:this.state.tableData,getTableData:this.tableData}))}});e.exports=f},1583:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),i=l(r),s=a(783),o=a(1584),d=l(o),u=a(777),c=l(u),m=a(1585),p=l(m),f=a(922),h=l(f),g=s.Form.Item,v={labelCol:{span:6},wrapperCol:{span:18}},y=i.default.createClass({displayName:"BlackToolbar",getInitialState:function(){return{data:null,value:"",searchStatus:!1}},componentDidMount:function(){this.onSearch()},onSearch:function(){var e=c.default.queryString("appId",window.location.href),t=this.props.form.getFieldValue("startTime"),a=this.props.form.getFieldValue("endTime"),l=this.props.form.getFieldValue("title"),n={appId:e,index:1};t&&(n.startTime=c.default.dateFormat("yyyy-MM-dd",t)),a&&(n.endTime=c.default.dateFormat("yyyy-MM-dd",a)),l&&(n.title=l),t&&a&&t>a||this.props.getTableData(n)},render:function(){var e=this.props.form.getFieldProps,t=this.props.form.getFieldValue("startTime"),a=this.props.form.getFieldValue("endTime"),l=this.props.form.getFieldValue("title");return t&&(t=c.default.dateFormat("yyyy-MM-dd",t)),a&&(a=c.default.dateFormat("yyyy-MM-dd",a)),i.default.createElement("div",null,i.default.createElement(p.default,{tableData:this.props.tableData,getTableData:this.onSearch}),i.default.createElement(s.Form,null,i.default.createElement("div",{className:"sub_toolbar config_toolbar"},i.default.createElement(s.Row,null,i.default.createElement(s.Col,{span:"4"},i.default.createElement("div",{className:"title"},i.default.createElement("span",{className:"border"}),"资源列表")))),i.default.createElement(s.Row,{className:"mt10"},i.default.createElement(s.Col,{span:"24"},i.default.createElement(h.default,{required:1,router:"personal",form:this.props.form}))),i.default.createElement(s.Row,{className:"mt10"},i.default.createElement(s.Col,{span:"8"},i.default.createElement(g,n({},v,{label:"备注"}),i.default.createElement(s.Input,n({placeholder:"备注"},e("title"))))),i.default.createElement(s.Col,{span:"6"},i.default.createElement(s.Button,{className:"ml10",type:"primary",onClick:this.onSearch,size:"large"},"查询"))),i.default.createElement(d.default,{title:l,startTime:t,endTime:a,current:this.props.current,tagName:this.state.tagName,getTableData:this.props.getTableData,refresh:this.props.refresh,tableData:this.props.tableData})))}});y=s.Form.create()(y),e.exports=y},1584:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=a(600),i=l(r),s=a(783),o=a(776),d=l(o),u=a(777),c=l(u),m=a(785),p=l(m),f=i.default.createClass({displayName:"ResourceLibTable",getInitialState:function(){return{uploadTime:"",title:"",total:""}},componentDidMount:function(){},getTable:function(e){var t=c.default.queryString("appId",window.location.href),a={index:e.index||1,materialId:e.id,appId:t};this.setState({current:e.index||1});var l=this;p.default.post(d.default.materialListDetail,a,function(t){l.setState({detailData:t.value.result,pagination:{total:t.value.amount,current:a.index,pageSize:10,showSizeChanger:!1,onChange:function(t){var a={id:e.id,index:t};l.setState({current:t}),l.getTable(a)}}})})},getDetail:function(e){this.setState({visible:!0,detailData:[],uploadTime:e.uploadTime,title:e.title,total:e.total}),this.getTable(e)},handleCancel:function(){this.setState({visible:!1})},detailColumns:function(){var e=this;return[{title:"序号",key:"0",dataIndex:"id",className:"ta_l"},{title:"上传时间",className:"ta_l",key:"1",dataIndex:"uploadTime"},{title:"内容ID",className:"ta_l",key:"2",dataIndex:"contentId"},{title:"通知栏标题",className:"ta_l ",width:340,key:"3",dataIndex:"title"},{title:"通知栏内容",className:"ta_l ",key:"4",width:340,dataIndex:"content"},{title:"操作",className:"ta_c ",key:"5",dataIndex:"",render:function(t,a){return i.default.createElement("div",null,i.default.createElement(s.Popover,{placement:"bottom",visible:e.state["content"+a.contentId],content:e.getContent(a,"content"),title:"确定删除资源?",onVisibleChange:function(){return e.togglePopover(a,"content")},trigger:"click"},i.default.createElement("a",{className:"pl10",href:"javascript:;"},"删除")))}}]},togglePopover:function(e,t){var a=e.id;"content"===t&&(a=e.contentId),this.setState(n({},t+a,!this.state[t+a]))},getContent:function(e,t){var a=this;return i.default.createElement("div",null,i.default.createElement(s.Button,{type:"primary",className:"color_bg mr10",onClick:function(){return a.togglePopover(e,t)}},"取消"),i.default.createElement(s.Button,{onClick:function(){a.delOk(e,t)}},"确定"))},delOk:function(e,t){var a=d.default.materialDelete,l=c.default.queryString("appId",window.location.href),n=this,r=this.props.tableData.pagination.total,i={appId:l};"content"===t?(a=d.default.materialDeleteDetail,i.contentId=e.contentId,r=this.state.pagination.total):i.materialId=e.id,p.default.post(a,i,function(){s.message.success("删除成功"),n.togglePopover(e,t);var a="content"===t?n.state.current:n.props.current;r%10===1&&a===Math.ceil(r/10)&&(a=parseInt(r/10)),"content"===t?(n.refreshContent(a,e),n.refreshMaterial(n.props.current)):n.refreshMaterial(a)})},refreshMaterial:function(e){var t=this.props.startTime,a=this.props.endTime,l=this.props.title,n=c.default.queryString("appId",window.location.href),r={index:e||this.props.current,appId:n};t&&(r.startTime=t),a&&(r.endTime=a),l&&(r.title=l),this.props.getTableData(r)},refreshContent:function(e,t){var a=c.default.queryString("appId",window.location.href),l={index:e||this.state.current,appId:a,id:t.materialId};this.getTable(l)},render:function(){var e=this,t=[{title:"序号",key:"0",dataIndex:"id",className:"ta_l"},{title:"上传时间",className:"ta_l",key:"1",dataIndex:"uploadTime"},{title:"备注",className:"ta_l td_appname",key:"2",dataIndex:"title"},{title:"内容数",className:"ta_r",key:"3",dataIndex:"total"},{title:"状态",className:"ta_r",key:"4",dataIndex:"statusDesc"},{title:"操作",className:"ta_c",key:"5",render:function(t,a){return i.default.createElement("div",null,i.default.createElement("a",{href:"javascript:;",onClick:function(){e.getDetail(a)}},"查看"),i.default.createElement(s.Popover,{placement:"bottom",visible:e.state["material"+a.id],content:e.getContent(a,"material"),title:"确定删除资源?",onVisibleChange:function(){return e.togglePopover(a,"material")},trigger:"click"},i.default.createElement("a",{className:"pl10",href:"javascript:;"},"删除")))},dataIndex:""}];return i.default.createElement("div",null,i.default.createElement(s.Table,{className:"home_table",columns:t,loading:this.props.tableData.loading,dataSource:this.props.tableData.data,pagination:this.props.tableData.pagination}),i.default.createElement(s.Modal,{width:1200,onCancel:this.handleCancel,onOk:this.handleCancel,okText:"确定",cancelText:"取消",title:"资源详情",visible:this.state.visible},i.default.createElement("div",{className:"fs14"},i.default.createElement("div",{className:"lh25"},i.default.createElement(s.Row,null,i.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"备注"),i.default.createElement(s.Col,{span:"21"},this.state.title)),i.default.createElement(s.Row,null,i.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"上传时间"),i.default.createElement(s.Col,{span:"21"},this.state.uploadTime)),i.default.createElement(s.Row,null,i.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"内容数"),i.default.createElement(s.Col,{span:"21"},this.state.pagination&&this.state.pagination.total))),i.default.createElement(s.Table,{pagination:this.state.pagination,columns:this.detailColumns(),dataSource:this.state.detailData}))))}});e.exports=f},1585:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),i=l(r),s=a(783),o=a(777),d=l(o),u=a(785),c=l(u),m=a(776),p=l(m),f=s.Form.Item,h={labelCol:{span:6},wrapperCol:{span:18}},g=i.default.createClass({displayName:"AddMaterial",getInitialState:function(){return{data:null,value:""}},add:function(){var e=d.default.queryString("appId",window.location.href),t=this;this.props.form.validateFields(function(a,l){if(a)return void console.log("Errors in form!!!");var n={title:l.title.trim(),appId:e,filePath:l.filePath};c.default.post(p.default.materialAdd,n,function(){s.message.success("新建成功");var a={appId:e,index:1};t.props.getTableData(a)})})},render:function(){var e=this,t=p.default.materialUpload,a=this.props.form.getFieldProps,l=d.default.queryString("appId",window.location.href);t=d.default.makeUrl(t,{appId:l});var r=10,o={name:"materialFile",data:{},accept:".xlsx,.xls",action:t,beforeUpload:function(t){e.setState({loading:!0});var a=t.type;if(t.size>1048576*r)return s.message.error("文件大小不能超过"+r+"M"),e.setState({loading:!1}),!1;var l=t.name,n=l.split("."),i=n.length,o=n[i-1],d="xlsx"===o||"xls"===o||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===a||"application/vnd.ms-excel"===a;return d||(s.message.error("请上传Excel文件"),e.setState({loading:!1})),d},headers:{authorization:"authorization-text"},onChange:function(t){if("removed"===t.file.status)return e.setState({loading:!1}),void(t.fileList.length<1&&e.props.form.setFieldsValue({filePath:void 0}));if("error"===t.file.status&&e.setState({loading:!1}),"done"===t.file.status)if(e.setState({loading:!1}),200==t.file.response.code){var a=t.file.response.value;t.fileList.length>1&&t.fileList.shift(),s.message.success(t.file.name+" 上传成功。"),e.props.form.setFieldsValue({filePath:a}),e.setState({blackNum:a.blackNum,appName:a.appName})}else t.fileList.pop(),s.message.error(t.file.response.message)}};return i.default.createElement(s.Form,{className:"add_black"},i.default.createElement("div",{className:"sub_toolbar config_toolbar"},i.default.createElement(s.Row,null,i.default.createElement(s.Col,{span:"14"},i.default.createElement("div",{className:"title"},i.default.createElement("span",{className:"border"}),"上传资源")))),i.default.createElement(s.Row,{className:"mt10"},i.default.createElement(s.Col,{span:"8"},i.default.createElement(f,n({},h,{label:"备注"}),i.default.createElement(s.Input,n({},a("title",{validate:[{rules:[{required:!0,message:"请填写备注"},{max:150,message:"备注不能超过150个字"}],trigger:["onBlur","onChange"]}]}),{placeholder:"备注"}))),i.default.createElement(f,n({className:"mt10"},h,{label:" "}),i.default.createElement(s.Upload,n({},a("filePath",{validate:[{rules:[{required:!0,message:"请上传文件"}],trigger:["onBlur","onChange"]}]}),{style:{width:200}},o),i.default.createElement(s.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"Excel文档批量导入",this.state.loading?i.default.createElement(s.Icon,{type:"loading"}):i.default.createElement("span",null))),i.default.createElement("span",{className:"upload_tips"},i.default.createElement("a",{download:!0,href:p.default.materialDownload+"?appId="+l},"下载模板"))),i.default.createElement(f,n({className:"mt10"},h,{label:" "}),i.default.createElement(s.Button,{size:"large",onClick:this.add,type:"primary"},"新增")))))}});g=s.Form.create()(g),e.exports=g}});